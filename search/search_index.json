{
    "docs": [
        {
            "location": "/", 
            "text": "TDD\u5f00\u53d1\u5bb9\u5668\u5316\u7684Python\u5fae\u670d\u52a1\u5e94\u7528\n\n\n\u672c\u6559\u7a0b\u662f\u4e00\u4e2a\u5173\u4e8ePython\u5fae\u670d\u52a1\u7684\u5b9e\u6218\u6559\u7a0b\uff0c\u6839\u636e\u6d4b\u8bd5\u9a71\u52a8\u5f00\u53d1(TDD)\u7684\u6307\u5bfc\u601d\u60f3\uff0c\u5f00\u53d1\u5bb9\u5668\u5316\u7684Python\u5fae\u670d\u52a1\u5e94\u7528\uff0c\u6d89\u53ca\nTDD\u3001Flask\u3001React\u3001Docker\u3001\u5fae\u670d\u52a1\n\u7b49\u77e5\u8bc6\u70b9\u3002\n\n\n\u5728\u8fd9\u4e2a\u8bfe\u7a0b\u4e2d\uff0c\u4f60\u5c06\u5b66\u4e60\u5982\u4f55\u4f7f\u7528\nDocker\n\u5feb\u901f\u521b\u5efa\u5f00\u53d1\u73af\u5883\u3001\u7ba1\u7406\u591a\u4e2a\u5fae\u670d\u52a1\uff0c\u5e94\u7528\u7a0b\u5e8f\u5728\u672c\u5730\u8fd0\u884c\u540e\uff0c\u60a8\u5c06\u5b66\u4e60\u600e\u6837\u5728\u751f\u4ea7\u73af\u5883\u90e8\u7f72\u5e94\u7528\u3002\u6211\u4eec\u4e5f\u4f1a\u7ec3\u4e60\nTDD\n(\u6d4b\u8bd5\u9a71\u52a8\u5f00\u53d1)\uff0c\u5728\u4f60\u7684\u9879\u76ee\u4e2d\u6d4b\u8bd5\u5148\u884c\uff0c\u6211\u4eec\u91cd\u70b9\u5c06\u653e\u5728\u670d\u52a1\u7aef\u7684\u5355\u5143\u6d4b\u8bd5\u3001\u529f\u80fd\u548c\u96c6\u6210\u6d4b\u8bd5\u4ee5\u53ca\u7aef\u5230\u7aef\u7684\u6d4b\u8bd5\u4e0a\u9762\uff0c\u4ee5\u786e\u4fdd\u6574\u4e2a\u7cfb\u7edf\u6309\u9884\u671f\u5de5\u4f5c\u3002\n\n\n\u626b\u63cf\u4e0b\u9762\u7684\u4e8c\u7ef4\u7801(\u6216\u5fae\u4fe1\u641c\u7d22\niEverything\n)\u6dfb\u52a0\u6211\u5fae\u4fe1\u597d\u53cb(\u6ce8\u660epython)\uff0c\u7136\u540e\u53ef\u4ee5\u52a0\u5165\u5230\u6211\u4eec\u7684\npython\n\u8ba8\u8bba\u7fa4\u91cc\u9762\u5171\u540c\u5b66\u4e60", 
            "title": "\u9996\u9875"
        }, 
        {
            "location": "/#tddpython", 
            "text": "\u672c\u6559\u7a0b\u662f\u4e00\u4e2a\u5173\u4e8ePython\u5fae\u670d\u52a1\u7684\u5b9e\u6218\u6559\u7a0b\uff0c\u6839\u636e\u6d4b\u8bd5\u9a71\u52a8\u5f00\u53d1(TDD)\u7684\u6307\u5bfc\u601d\u60f3\uff0c\u5f00\u53d1\u5bb9\u5668\u5316\u7684Python\u5fae\u670d\u52a1\u5e94\u7528\uff0c\u6d89\u53ca TDD\u3001Flask\u3001React\u3001Docker\u3001\u5fae\u670d\u52a1 \u7b49\u77e5\u8bc6\u70b9\u3002  \u5728\u8fd9\u4e2a\u8bfe\u7a0b\u4e2d\uff0c\u4f60\u5c06\u5b66\u4e60\u5982\u4f55\u4f7f\u7528 Docker \u5feb\u901f\u521b\u5efa\u5f00\u53d1\u73af\u5883\u3001\u7ba1\u7406\u591a\u4e2a\u5fae\u670d\u52a1\uff0c\u5e94\u7528\u7a0b\u5e8f\u5728\u672c\u5730\u8fd0\u884c\u540e\uff0c\u60a8\u5c06\u5b66\u4e60\u600e\u6837\u5728\u751f\u4ea7\u73af\u5883\u90e8\u7f72\u5e94\u7528\u3002\u6211\u4eec\u4e5f\u4f1a\u7ec3\u4e60 TDD (\u6d4b\u8bd5\u9a71\u52a8\u5f00\u53d1)\uff0c\u5728\u4f60\u7684\u9879\u76ee\u4e2d\u6d4b\u8bd5\u5148\u884c\uff0c\u6211\u4eec\u91cd\u70b9\u5c06\u653e\u5728\u670d\u52a1\u7aef\u7684\u5355\u5143\u6d4b\u8bd5\u3001\u529f\u80fd\u548c\u96c6\u6210\u6d4b\u8bd5\u4ee5\u53ca\u7aef\u5230\u7aef\u7684\u6d4b\u8bd5\u4e0a\u9762\uff0c\u4ee5\u786e\u4fdd\u6574\u4e2a\u7cfb\u7edf\u6309\u9884\u671f\u5de5\u4f5c\u3002  \u626b\u63cf\u4e0b\u9762\u7684\u4e8c\u7ef4\u7801(\u6216\u5fae\u4fe1\u641c\u7d22 iEverything )\u6dfb\u52a0\u6211\u5fae\u4fe1\u597d\u53cb(\u6ce8\u660epython)\uff0c\u7136\u540e\u53ef\u4ee5\u52a0\u5165\u5230\u6211\u4eec\u7684 python \u8ba8\u8bba\u7fa4\u91cc\u9762\u5171\u540c\u5b66\u4e60", 
            "title": "TDD\u5f00\u53d1\u5bb9\u5668\u5316\u7684Python\u5fae\u670d\u52a1\u5e94\u7528"
        }, 
        {
            "location": "/part1/introduction/", 
            "text": "\u9879\u76ee\u4e2d\u63d0\u5230\u7684\u4ee3\u7801\u90fd\u5df2\u7ecf\u5f52\u6863\u5230\ngithub\n\u4e0a\u4e86\uff0c\u6839\u636e\u8bfe\u7a0b\u7ae0\u8282\u6253\u4e0a\u4e86\ntag\n\u3002\u672c\u8bfe\u7a0b\u662f\u6839\u636e\nRealPython\u7684\u8bfe\u7a0b\n\u8fdb\u884c\u6539\u7f16\u7684\uff0c\u5e0c\u671b\u770b\u539f\u7248\u7684\u5c31\u4e0d\u8981\u5446\u5728\u8fd9\u91cc\u9a82\u6211\u4e86\uff0c\u4e0d\u9001\u3002\n\n\n\u5728\u7b2c\u4e00\u90e8\u5206\uff0c\u4f60\u5c06\u80fd\u591f\u5b66\u4e60\u4f7f\u7528\nDocker\n\u3001 \nFlask\n\u3001\nMySQL\n\u6765\u521b\u5efa\nRESTful\n API\u670d\u52a1\u3002\n\n\n\n\n\u6211\u4eec\u5c06\u91c7\u53d6\u4e00\u79cd\u5b9e\u7528\u7684\u65b9\u6cd5\u6765\u8fdb\u884c\u6d4b\u8bd5\u9a71\u52a8\u5f00\u53d1(TDD)\n\n\n\n\n\u8bfe\u7a0b\u5f00\u59cb\u4e4b\u524d\uff0c\u4f60\u5e94\u8be5\u8981\u719f\u6089\u4e0b\u9762\u7684\u8fd9\u4e9b\u4e3b\u9898\uff1a\n\n\n\n\nDocker - \nGet started with Docker\n\n\nDocker Compose - \nGet started with Docker Compose\n\n\nFlask - \nFlaskr TDD\n\n\n\n\n\u8be5\u90e8\u5206\u8bfe\u7a0b\u4f7f\u7528\u5230\u7684\u5de5\u5177\u5e93\uff1a\n\n\n\n\nPython v3.6.4\n\n\nFlask v0.12.2\n\n\nFlask-Script v2.0.6\n\n\nFlask-SQLAlchemy v2.3.2\n\n\nFlask-Testing v0.7.1\n\n\nPyMySQL v0.8.0\n\n\nGunicorn v19.7.1\n\n\nNginx v1.13.0\n\n\nDocker v17.11.0-ce\n\n\nDocker Compose v1.14.0\n\n\n\n\n\u672c\u8282\u8bfe\u7a0b\u7ed3\u675f\uff0c\u4f60\u80fd\u5b66\u5230\u4e0b\u9762\u7684\u77e5\u8bc6\u70b9\uff1a\n\n\n\n\n\u7528\nFlask\n\u5f00\u53d1\u4e00\u4e2a\nRESTful\n API \u670d\u52a1\n\n\n\u5b9e\u8df5\u6d4b\u8bd5\u9a71\u52a8\u5f00\u53d1(TDD)\n\n\n\u5728\u672c\u5730\u7528\nDocker\n\u548c\nDocker Compose\n\u914d\u7f6e\u548c\u8fd0\u884c\u670d\u52a1\n\n\n\u5c06\u4ee3\u7801\u6302\u8f7d\u5230\u4e00\u4e2a\u5bb9\u5668\u4e2d\u53bb\n\n\n\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\u548c\u96c6\u6210\u6d4b\u8bd5\n\n\n\u4e0d\u540c\u5bb9\u5668\u7684\u670d\u52a1\u95f4\u7684\u4ea4\u4e92\n\n\n\u5728\nDocker\n\u5bb9\u5668\u4e2d\u8fd0\u884c\nPython\n\u548c\nFlask\n\u5e94\u7528\n\n\n\u5b89\u88c5\nFlask\n\u3001\nNginx\n\u548c\nGunicorn", 
            "title": "\u4ecb\u7ecd"
        }, 
        {
            "location": "/part1/start/", 
            "text": "\u672c\u8282\u8bfe\u7a0b\u6211\u4eec\u5c06\u521d\u59cb\u5316\u9879\u76ee\u6846\u67b6\u3001\u5b9a\u4e49\u7b2c\u4e00\u4e2a\u670d\u52a1\u3002\n\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u9879\u76ee\u3001\u5b89\u88c5\nFlask\n\uff1a\n\n\n$ mkdir flask-microservices-users \n \ncd\n flask-microservices-users\n$ mkdir project\n$ pyenv virtualenv \n3\n.6.4 tdd3\n$ pyenv \nlocal\n tdd3\n\n(\ntdd3\n)\n$ pip install \nFlask\n==\n0\n.12.2\n\n\n\n\n\n\u5728project \u76ee\u5f55\u4e0b\u9762\u6dfb\u52a0\n__init__.py\n\u6587\u4ef6\uff0c\u914d\u7f6e\u7b2c\u4e00\u4e2a\u8def\u7531\uff1a\n\n\n# project/__init__.py\n\n\nfrom\n \nflask\n \nimport\n \nFlask\n,\n \njsonify\n\n\n\n# \u521d\u59cb\u5316app\n\n\napp\n \n=\n \nFlask\n(\n__name__\n)\n\n\n\n\n@app.route\n(\n/ping\n,\n \nmethods\n=\n[\nGET\n])\n\n\ndef\n \nping_pong\n():\n\n    \nreturn\n \njsonify\n({\n\n        \nstatus\n:\n \nsuccess\n,\n\n        \nmessage\n:\n \npong!\n\n    \n})\n\n\n\n\n\n\n\u7136\u540e\uff0c\u6dfb\u52a0\nFlask-Script\n\uff0c\u8be5\u4f9d\u8d56\u5305\u53ef\u4ee5\u7528\u6765\u5728\u547d\u4ee4\u884c\u7ba1\u7406\nFlask\n app:\n\n\n(\ntdd3\n)\n$ pip install Flask-Script\n==\n2\n.0.6\n\n\n\n\n\n\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u9762\u6dfb\u52a0\u4e00\u4e2a\nmanage.py\n\u7684\u6587\u4ef6\uff1a\n\n\n# manage.py\n\n\nfrom\n \nflask_script\n \nimport\n \nManager\n\n\nfrom\n \nproject\n \nimport\n \napp\n\n\n\nmanager\n \n=\n \nManager\n(\napp\n)\n\n\n\nif\n \n__name__\n \n==\n \n__main__\n:\n\n    \nmanager\n.\nrun\n()\n\n\n\n\n\n\n\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684\nManager\n\u5b9e\u4f8b\uff0c\u6765\u5904\u7406\u6240\u6709\u7684\u4ece\u547d\u4ee4\u884c\u8f93\u5165\u7684\u547d\u4ee4\u3002\u8fd0\u884c\u7a0b\u5e8f\uff1a\n\n\n(\ntdd3\n)\n$ python manage.py runserver\n\n\n\n\n\n\u8fd0\u884c\u6210\u529f\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\u9875\u9762\nhttp://localhost:5000/ping\n\uff0c\u4f60\u80fd\u770b\u5230\u5982\u4e0b\u7684json \u4fe1\u606f\u8f93\u51fa\u5230\u9875\u9762\uff1a\n\n\n{\n\n  \nmessage\n:\n \npong!\n,\n\n  \nstatus\n:\n \nsuccess\n\n\n}\n\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u5173\u6389\u670d\u52a1(Ctrl+C)\uff0c\u5728\nproject\n\u76ee\u5f55\u4e0b\u9762\u65b0\u589e\u4e00\u4e2a\nconfig.py\n\u7684\u6587\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a\n\n\n \n#project/config.py\n\n\nclass\n \nBaseConfig\n:\n\n    \n\u57fa\u7840\u914d\u7f6e\n\n    \nDEBUG\n \n=\n \nFalse\n\n    \nTESTING\n \n=\n \nFalse\n\n\n\nclass\n \nDevelopmentConfig\n(\nBaseConfig\n):\n\n    \n\u5f00\u53d1\u73af\u5883\u914d\u7f6e\n\n    \nDEBUG\n \n=\n \nTrue\n\n\n\nclass\n \nTestingConfig\n(\nBaseConfig\n):\n\n    \n\u6d4b\u8bd5\u73af\u5883\u914d\u7f6e\n\n    \nDEBUG\n \n=\n \nTrue\n\n    \nTESTING\n \n=\n \nTrue\n\n\n\nclass\n \nProductionConfig\n(\nBaseConfig\n):\n\n    \n\u751f\u4ea7\u73af\u5883\u914d\u7f6e\n\n    \nDEBUG\n \n=\n \nFalse\n\n\n\n\n\n\n\u7136\u540e\u66f4\u65b0\n__init__.py\n\u6587\u4ef6\uff0c\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u914d\u7f6e\u5f00\u53d1\u73af\u5883\uff1a\n\n\nfrom\n \nflask\n \nimport\n \nFlask\n,\n \njsonify\n\n\n\n# \u521d\u59cb\u5316app\n\n\napp\n \n=\n \nFlask\n(\n__name__\n)\n\n\n# \u73af\u5883\u914d\u7f6e\n\n\napp\n.\nconfig\n.\nfrom_object\n(\nproject.config.DevelopmentConfig\n)\n\n\n\n@app.route\n(\n/ping\n,\n \nmethods\n=\n[\nGET\n])\n\n\ndef\n \nping_pong\n():\n\n    \nreturn\n \njsonify\n({\n\n        \nstatus\n:\n \nsuccess\n,\n\n        \nmessage\n:\n \npong!\n\n    \n})\n\n\n\n\n\n\n\u7136\u540e\u91cd\u65b0\u8fd0\u884c\u7a0b\u5e8f\uff0c\u6211\u4eec\u80fd\u5728\u7ec8\u7aef\u4e2d\u770b\u5230\ndebug\n\u6a21\u5f0f\u7684\u63d0\u793a\u4fe1\u606f\uff1a\n\n\n(\ntdd3\n)\n$ python manage.py runserver\n    * Running on http://127.0.0.1:5000/ \n(\nPress CTRL+C to quit\n)\n\n    * Restarting with stat\n    * Debugger is active!\n    * Debugger PIN: \n770\n-657-842\n\n\n\n\n\n\u73b0\u5728\u5f53\u4f60\u7684\u4ee3\u7801\u6709\u4efb\u4f55\u6539\u52a8\u7684\u65f6\u5019\uff0c\u5e94\u7528\u90fd\u4f1a\u81ea\u52a8\u52a0\u8f7d\uff0c\u4e0d\u9700\u8981\u624b\u52a8\u91cd\u542f\u4e86\u3002\u4e3a\u4e86\u4fdd\u8bc1\u6211\u4eec\u7684\u9879\u76ee\u4f9d\u8d56\u80fd\u5b9e\u65f6\u540c\u6b65\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06\u4f9d\u8d56\u5305\u6dfb\u52a0\u5230\u4e00\u4e2a\nrequirements.txt\n\u7684\u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5229\u7528\npip\n\u7684\nfreeze\n\u547d\u4ee4\u5c31\u53ef\u4ee5\u8f7b\u677e\u62ff\u5230\u6211\u4eec\u9879\u76ee\u7684\u4f9d\u8d56\u5217\u8868\u4e86\uff1a\n\n\n(\ntdd3\n)\n$ pip freeze \n requirements.txt\n\n\n\n\n\n\u7136\u540e\u770b\u770b\nrequirements.txt\n\u7684\u5185\u5bb9\u5427:\n\n\nFlask==0.12.2\nFlask-Script==2.0.6\n\n\n\n\n\n\u6700\u540e\uff0c\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u9762\u6dfb\u52a0\u4e00\u4e2a\n.gitignore\n\u7684\u6587\u4ef6\uff1a\n\n\n__pycache__\nenv\n\n\n\n\n\n\u521d\u59cb\u5316git \u4ed3\u5e93\uff0c\u7136\u540e\u63d0\u4ea4\u4ee3\u7801\u5427~", 
            "title": "\u5f00\u59cb"
        }, 
        {
            "location": "/part1/docker/", 
            "text": "\u8fd9\u8282\u8bfe\u8ba9\u6211\u4eec\u6765\u5bb9\u5668\u5316\nFlask\n\u5e94\u7528\u5427......\n\u9996\u5148\u4f60\u9700\u8981\u786e\u4fdd\u4f60\u7684\u73af\u5883\u4e2d\u5df2\u7ecf\u5b89\u88c5\u4e86\nDocker\n\u548c\nDocker Compose\n\uff1a\n\n\n$ docker -v\nDocker version \n17\n.05.0-ce, build 89658be\n$ docker-compose -v\ndocker-compose version \n1\n.14.0, build unknown\n\n\n\n\n\n\u5728\u9879\u76ee\u7684\u6839\u76ee\u5f55\u4e0b\u9762\u521b\u5efa\u4e00\u4e2a\nDockerfile\n\u7684\u6587\u4ef6\uff1a\n\n\nFROM python:3.6.4\n\n# \u8bbe\u7f6e\u5de5\u4f5c\u76ee\u5f55\nRUN mkdir -p /usr/src/app\nWORKDIR /usr/src/app\n\n# \u6dfb\u52a0\u4f9d\u8d56\uff08\u5229\u7528Docker \u7684\u7f13\u5b58\uff09\nADD ./requirements.txt /usr/src/app/requirements.txt\n\n# \u5b89\u88c5\u4f9d\u8d56\nRUN pip install -r requirements.txt\n\n# \u6dfb\u52a0\u5e94\u7528\nADD . /usr/src/app\n\n# \u8fd0\u884c\u670d\u52a1\nCMD python manage.py runserver -h 0.0.0.0\n\n\n\n\n\n\u7136\u540e\u540c\u6837\u7684\u5728\u6839\u76ee\u5f55\u4e0b\u9762\u521b\u5efa\u4e00\u4e2a\ndocker-compose.yml\n\u7684\u6587\u4ef6\uff1a\n\n\nversion: \n2.1\n\n\nservices:\n  users-service:\n    container_name: users-service\n    build: .\n    volumes:\n      - \n.:/usr/src/app\n\n    ports:\n      - 5001:5000  # \u7aef\u53e3\u66b4\u9732\uff08\u4e3b\u673a\u7aef\u53e3:\u5bb9\u5668\u7aef\u53e3\uff09\n\n\n\n\n\n\u6267\u884c\u4e0a\u9762\u7684\u914d\u7f6e\u6587\u4ef6\u5c06\u6839\u636e\nDockerfile\n\u521b\u5efa\u4e00\u4e2a\u53eb\nusers-service\n\u7684\u5bb9\u5668\u3002\n\n\n\n\ndocker-compose.yml\n\u6587\u4ef6\u4e2d\u7684\u76ee\u5f55\u662f\u76f8\u5bf9\u8def\u5f84\n\n\n\n\nvolumes\n\u662f\u7528\u6765\u5c06\u4ee3\u7801\u6302\u8f7d\u8fdb\u5bb9\u5668\u5185\u90e8\u7684\uff0c\u5bf9\u4e8e\u5f00\u53d1\u73af\u5883\u4f60\u6700\u597d\u8fd9\u4e48\u505a\uff0c\u4e0d\u7136\u4f60\u6bcf\u6b21\u66f4\u65b0\u4ee3\u7801\u540e\u90fd\u9700\u8981\u91cd\u65b0\u6784\u5efa\u5bb9\u5668\u624d\u4f1a\u751f\u6548\uff0c\u663e\u7136\u8fd9\u662f\u975e\u5e38\u5f71\u54cd\u6548\u7387\u7684\u3002\n\n\n\u6ce8\u610f\nDocker compose \u7684\u6587\u4ef6\u7248\u672c\n\uff0c\u6211\u4eec\u8fd9\u91cc\u7528\u7684\n2.1\n\uff0c\u8fd9\u5176\u5b9e\u4e0e\u4f60\u5b89\u88c5\u7684\ndocker-compose\n\u7248\u672c\u6ca1\u6709\u4efb\u4f55\u5173\u7cfb\u7684\uff0c\u53ea\u4e0e\nDocker\n\u7248\u672c\u6709\u5173\u7cfb\uff08\u901a\u8fc7\u4e0a\u9762\u7684\u8fde\u63a5\u53ef\u4ee5\u9009\u62e9\u5408\u9002\u7684\u6587\u4ef6\u7248\u672c\uff09\uff0c\u4f46\u662f\u6587\u4ef6\u7248\u672c\n3.x\n\u548c\n2.x\n\u8fd8\u662f\u6709\u5f88\u591a\u4e0d\u540c\u7684\u5730\u65b9\uff0c\u6ce8\u610f\u67e5\u770b\u6587\u6863\u3002\n\n\n\u7136\u540e\u6211\u4eec\u6765\u6784\u5efa\u955c\u50cf\uff1a\n\n\n$ docker-compose build\n\n\n\n\n\n\u5728\u7b2c\u4e00\u6b21\u6784\u5efa\u7684\u65f6\u5019\u4f1a\u82b1\u8d39\u4e00\u70b9\u65f6\u95f4\uff0c\u4e0d\u8fc7\u522b\u62c5\u5fc3\uff0c\u7531\u4e8e\nDocker\n\u4f1a\u7f13\u5b58\u7b2c\u4e00\u6b21\u7684\u6784\u5efa\u7ed3\u679c\uff0c\u540e\u7eed\u7684\u6784\u5efa\u90fd\u4f1a\u5feb\u5f97\u591a\uff0c\u6784\u5efa\u5b8c\u6210\u540e\uff0c\u542f\u52a8\u5bb9\u5668\uff1a\n\n\n$ docker-compose up -d\n\n\n\n\n\n\n\n-d\n\u6807\u8bb0\u662f\u7528\u6765\u8ba9\u5bb9\u5668\u5728\u540e\u53f0\u6267\u884c\u7684\n\n\n\n\n\u7136\u540e\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\nhttp://127.0.0.1:5001/ping\n\uff0c\u786e\u4fdd\u4f60\u80fd\u770b\u5230\u548c\u4e0a\u9762\u770b\u5230\u7684JSON \u6587\u4ef6\u4fe1\u606f\u3002\n\u63a5\u4e0b\u6765\u5728\ndocker-compose.yml\n\u6587\u4ef6\u4e2d\u589e\u52a0\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u7528\u6765\u52a0\u8f7d\u5f00\u53d1\u73af\u5883\u7684\u914d\u7f6e\u4fe1\u606f\uff1a\n\n\nversion: \n2.1\n\n\nservices:\n  users-service:\n    container_name: users-service\n    build: .\n    volumes:\n    - \n.:/usr/src/app\n\n    ports:\n    - 5001:5000 # \u7aef\u53e3\u66b4\u9732\uff08\u4e3b\u673a\u7aef\u53e3:\u5bb9\u5668\u7aef\u53e3\uff09\n    environment:\n    - APP_SETTINGS=project.config.DevelopmentConfig\n\n\n\n\n\n\u7136\u540e\u66f4\u65b0\nproejct/__init__.py\n\u6587\u4ef6\uff0c\u4ece\u73af\u5883\u53d8\u91cf\u83b7\u53d6\u5e94\u7528\u7684\u914d\u7f6e\u4fe1\u606f\uff1a\n\n\nimport\n \nos\n\n\nfrom\n \nflask\n \nimport\n \nFlask\n,\n \njsonify\n\n\n\n# \u521d\u59cb\u5316app\n\n\napp\n \n=\n \nFlask\n(\n__name__\n)\n\n\n# \u73af\u5883\u914d\u7f6e\n\n\napp_settings\n \n=\n \nos\n.\ngetenv\n(\nAPP_SETTINGS\n)\n\n\napp\n.\nconfig\n.\nfrom_object\n(\napp_settings\n)\n\n\n\n@app.route\n(\n/ping\n,\n \nmethods\n=\n[\nGET\n])\n\n\ndef\n \nping_pong\n():\n\n    \nreturn\n \njsonify\n({\n\n        \nstatus\n:\n \nsuccess\n,\n\n        \nmessage\n:\n \npong!\n\n    \n})\n\n\n\n\n\n\n\u7136\u540e\u66f4\u65b0\u5bb9\u5668\uff1a\n\n\n$ docker-compose up -d\n\n\n\n\n\n\u600e\u4e48\u77e5\u9053\u6211\u4eec\u4e0a\u9762\u7684\u8fd9\u79cd\u65b9\u6cd5\u5c31\u914d\u7f6e\u6210\u529f\u4e86\u5462\uff1f\u6211\u4eec\u5728\nproject/__init__.py\n\u6587\u4ef6\u4e0b\u9762\u6253\u5370\u4e0b\u914d\u7f6e\u4fe1\u606f\uff1a\n\n\nimport\n \nsys\n\n\nprint\n(\napp\n.\nconfig\n,\n \nfile\n=\nsys\n.\nstderr\n)\n\n\n\n\n\n\n\u56e0\u4e3a\u6211\u4eec\u5c06\u4ee3\u7801\u6302\u8f7d\u5230\u5bb9\u5668\u91cc\u9762\u7684\uff0c\u6240\u4ee5\u76f4\u63a5\u4fdd\u5b58\u5c31\u4f1a\u81ea\u52a8\u52a0\u8f7d\uff0c\u7136\u540e\u67e5\u770b\u65e5\u5fd7\uff1a\n\n\n$ docker-compose logs -f users-service\n\n\n\n\n\n\n\u4ece\u65e5\u5fd7\u4e2d\u53ef\u4ee5\u770b\u51fa\nDEBUG=True\uff0cTESTING=False\n\uff0c\u8bc1\u660e\u662f\u751f\u6548\u7684\uff08\u8bb0\u5f97\u5220\u9664\u65e5\u5fd7\u4ee3\u7801\u54e6~~~\uff09", 
            "title": "Docker \u914d\u7f6e"
        }, 
        {
            "location": "/part1/database/", 
            "text": "\u8fd9\u8282\u8bfe\u6211\u4eec\u5c06\u6765\u914d\u7f6e\nMySQL\n\u6570\u636e\u5e93\uff0c\u542f\u52a8\u8fd0\u884c\u5728\u53e6\u5916\u4e00\u4e2a\u5bb9\u5668\u4e2d\uff0c\u7136\u540e\u628a\u5b83\nlink\n\u5230\nusers-service\n\u5bb9\u5668\u4e2d......\n\n\n\u589e\u52a0\nFlask-SQLAlchemy\n\u548c\nPyMySQL\n\u5230\nrequirementx.txt\n\u6587\u4ef6\u4e2d\uff1a\n\n\nFlask-SQLAlchemy==2.3.2\nPyMySQL==0.8.0\n\n\n\n\n\n\u5f53\u7136\u8981\u8bb0\u5f97\u5b89\u88c5\u8fd9\u4e9b\u4f9d\u8d56\u5305\uff1a\n\n\n(\ntdd3\n)\n$ pip install -r requirements.txt\n\n\n\n\n\n\u7136\u540e\u66f4\u65b0\nconfig.py\n\u6587\u4ef6\uff0c\u6dfb\u52a0\nSQLAlchemy\n\u6570\u636e\u5e93\u58f0\u660e\uff1a\n\n\n# project/config.py\n\n\nimport\n \nos\n\n\n\nclass\n \nBaseConfig\n:\n\n    \n\u57fa\u7840\u914d\u7f6e\n\n    \nDEBUG\n \n=\n \nFalse\n\n    \nTESTING\n \n=\n \nFalse\n\n    \nSQLALCHEMY_TRACK_MODIFICATIONS\n \n=\n \nFalse\n\n\n\nclass\n \nDevelopmentConfig\n(\nBaseConfig\n):\n\n    \n\u5f00\u53d1\u73af\u5883\u914d\u7f6e\n\n    \nDEBUG\n \n=\n \nTrue\n\n    \nSQLALCHEMY_DATABASE_URI\n \n=\n \nos\n.\nenviron\n.\nget\n(\nDATABASE_URL\n)\n\n\n\nclass\n \nTestingConfig\n(\nBaseConfig\n):\n\n    \n\u6d4b\u8bd5\u73af\u5883\u914d\u7f6e\n\n    \nDEBUG\n \n=\n \nTrue\n\n    \nTESTING\n \n=\n \nTrue\n\n    \nSQLALCHEMY_DATABASE_URI\n \n=\n \nos\n.\nenviron\n.\nget\n(\nDATABASE_TEST_URL\n)\n\n\n\nclass\n \nProductionConfig\n(\nBaseConfig\n):\n\n    \n\u751f\u4ea7\u73af\u5883\u914d\u7f6e\n\n    \nDEBUG\n \n=\n \nFalse\n\n    \nSQLALCHEMY_DATABASE_URI\n \n=\n \nos\n.\nenviron\n.\nget\n(\nDATABASE_URL\n)\n\n\n\n\n\n\n\u63a5\u4e0b\u6765\u66f4\u65b0\n__init__.py\n\u6587\u4ef6\uff0c\u521b\u5efa\u4e00\u4e2a\nSQLAlchemy\n\u5b9e\u4f8b\u7136\u540e\u5b9a\u4e49\u6570\u636e\u6a21\u578b\uff1a\n\n\n# project/__init__.py\n\n\nimport\n \nos\n\n\nimport\n \ndatetime\n\n\nfrom\n \nflask\n \nimport\n \nFlask\n,\n \njsonify\n\n\nfrom\n \nflask_sqlalchemy\n \nimport\n \nSQLAlchemy\n\n\n\n# \u521d\u59cb\u5316app\n\n\napp\n \n=\n \nFlask\n(\n__name__\n)\n\n\n# \u73af\u5883\u914d\u7f6e\n\n\napp_settings\n \n=\n \nos\n.\ngetenv\n(\nAPP_SETTINGS\n)\n\n\napp\n.\nconfig\n.\nfrom_object\n(\napp_settings\n)\n\n\n\n# \u521d\u59cb\u5316\u6570\u636e\u5e93\n\n\ndb\n \n=\n \nSQLAlchemy\n(\napp\n)\n\n\n\nclass\n \nUser\n(\ndb\n.\nModel\n):\n\n    \n__tablename__\n \n=\n \nusers\n\n    \nid\n \n=\n \ndb\n.\nColumn\n(\ndb\n.\nInteger\n,\n \nprimary_key\n=\nTrue\n,\n \nautoincrement\n=\nTrue\n)\n\n    \nusername\n \n=\n \ndb\n.\nColumn\n(\ndb\n.\nString\n(\n128\n),\n \nnullable\n=\nFalse\n)\n\n    \nemail\n \n=\n \ndb\n.\nColumn\n(\ndb\n.\nString\n(\n128\n),\n \nnullable\n=\nFalse\n)\n\n    \nactive\n \n=\n \ndb\n.\nColumn\n(\ndb\n.\nBoolean\n(),\n \ndefault\n=\nFalse\n,\n \nnullable\n=\nFalse\n)\n\n    \ncreated_at\n \n=\n \ndb\n.\nColumn\n(\ndb\n.\nDateTime\n,\n \nnullable\n=\nFalse\n)\n\n\n    \ndef\n \n__init__\n(\nself\n,\n \nusername\n,\n \nemail\n):\n\n        \nself\n.\nusername\n \n=\n \nusername\n\n        \nself\n.\nemail\n \n=\n \nemail\n\n        \nself\n.\ncreated_at\n \n=\n \ndatetime\n.\ndatetime\n.\nutcnow\n()\n\n\n\n@app.route\n(\n/ping\n,\n \nmethods\n=\n[\nGET\n])\n\n\ndef\n \nping_pong\n():\n\n    \nreturn\n \njsonify\n({\n\n        \nstatus\n:\n \nsuccess\n,\n\n        \nmessage\n:\n \npong!\n\n    \n})\n\n\n\n\n\n\n\u5728\nproject\n\u76ee\u5f55\u4e0b\u589e\u52a0\u4e00\u4e2a\ndb\n\u7684\u6587\u4ef6\u5939\uff0c\u5728\u4e0b\u9762\u65b0\u5efa\u4e00\u4e2a\ncreate.sql\n\u7684\u6587\u4ef6\uff1a\n\n\nCREATE\n \nDATABASE\n \nusers_prod\n;\n\n\nCREATE\n \nDATABASE\n \nusers_dev\n;\n\n\nCREATE\n \nDATABASE\n \nusers_test\n;\n\n\n\n\n\n\n\u7136\u540e\u5728\ndb\n\u76ee\u5f55\u4e0b\u9762\u6dfb\u52a0\u6587\u4ef6\nDockerfile\n:\n\n\nFROM\n mysql:5.6\n\n\n\n# \u521d\u59cb\u5316\u7684\u65f6\u5019\u8fd0\u884ccreate.sql\u811a\u672c\n\n\nADD\n create.sql /docker-entrypoint-initdb.d\n\n\n\n\n\n\n\u8fd9\u91cc\u6211\u4eec\u7ee7\u627f\u5b98\u65b9\u7684\nmysql\n\u955c\u50cf\uff0c\u5728\ndocker-entrypoint-initdb.d\n\u76ee\u5f55\u4e0b\u9762\u589e\u52a0\u4e00\u4e2a\nSQL\n\u6587\u4ef6\uff0c\u5bb9\u5668\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u5c31\u4f1a\u6267\u884c\u8fd9\u4e2asql\u6587\u4ef6\u3002\n\n\n\u66f4\u65b0\ndocker-compose.yml\n\uff1a\n\n\nversion\n:\n \n2.1\n\n\n\nservices\n:\n\n  \nusers-db\n:\n\n    \ncontainer_name\n:\n \nusers-db\n\n    \nbuild\n:\n \n./project/db\n\n    \nports\n:\n\n      \n-\n \n3307:3306\n\n    \nenvironment\n:\n\n      \n-\n \nMYSQL_ROOT_PASSWORD=root321\n\n    \nhealthcheck\n:\n\n      \ntest\n:\n \nexit 0\n\n\n  \nusers-service\n:\n\n    \ncontainer_name\n:\n \nusers-service\n\n    \nbuild\n:\n \n./\n\n    \nvolumes\n:\n\n      \n-\n \n.:/usr/src/app\n\n    \nports\n:\n\n      \n-\n \n5001:5000\n \n# \u66b4\u9732\u7aef\u53e3 - \u4e3b\u673a:\u5bb9\u5668\n\n    \nenvironment\n:\n\n      \n-\n \nAPP_SETTINGS=project.config.DevelopmentConfig\n\n      \n-\n \nDATABASE_URL=mysql+pymysql://root:root321@users-db:3306/users_dev\n\n      \n-\n \nDATABASE_TEST_URL=mysql+pymysql://root:root321@users-db:3306/users_test\n\n    \ndepends_on\n:\n\n      \nusers-db\n:\n\n        \ncondition\n:\n \nservice_healthy\n\n    \nlinks\n:\n\n      \n-\n \nusers-db\n\n\n\n\n\n\n\u542f\u52a8\u540e\u6ce8\u5165\u73af\u5883\u53d8\u91cf\nexit code\n\u88ab\u53d1\u9001\u540e\u5bb9\u5668\u6210\u529f\u8fd0\u884c\u8d77\u6765\uff0c\nMySQL\n\u5c06\u88ab\u7ed1\u5b9a\u5728\u5bbf\u4e3b\u673a\u76843307\u548c\u5bb9\u5668\u76843306\u7aef\u53e3\u4e0a\u3002\u6ce8\u610f\nDATABASE_URL\n\u8def\u5f84\u4e2d\u4f7f\u7528\u7684\nmysql+pymysql\n\uff0c\u56e0\u4e3a\u6211\u4eec\u4f7f\u7528\u7684\u662f\npython3.6.x\n\u7248\u672c\u548c\npymysql\n\u9a71\u52a8\u3002\n\u68c0\u6d4b\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose up -d --build\n\n\n\n\n\n\u7136\u540e\u66f4\u65b0\nmanage.py\n\uff0c\u589e\u52a0\u521b\u5efa\u6570\u636e\u5e93\u7684\u547d\u4ee4\uff1a\n\n\nfrom\n \nflask_script\n \nimport\n \nManager\n\n\nfrom\n \nproject\n \nimport\n \napp\n,\n \ndb\n\n\n\nmanager\n \n=\n \nManager\n(\napp\n)\n\n\n\n@manager.command\n\n\ndef\n \nrecreate_db\n():\n\n    \n\u91cd\u65b0\u521b\u5efa\u6570\u636e\u8868.\n\n    \ndb\n.\ndrop_all\n()\n\n    \ndb\n.\ncreate_all\n()\n\n    \ndb\n.\nsession\n.\ncommit\n()\n\n\n\nif\n \n__name__\n \n==\n \n__main__\n:\n\n    \nmanager\n.\nrun\n()\n\n\n\n\n\n\n\u65b0\u6dfb\u52a0\u4e86\u4e00\u4e2a\nrecrete_db\n\u7684\u547d\u4ee4\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u4e2d\u6267\u884c\u8be5\u547d\u4ee4\u6765\u5c06\nmodel\n\u6620\u5c04\u5230\u6570\u636e\u4e2d\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose run users-service python manage.py recreate_db\n\n\n\n\n\n\u5982\u679c\u4e00\u5207\u6b63\u5e38\u7684\u8bdd\uff0c\u4e0a\u9762\u7684\u547d\u4ee4\u80fd\u591f\u6267\u884c\u6210\u529f\uff0c\u7136\u540e\u6211\u4eec\u6765\u9a8c\u8bc1\u4e0b\u6570\u636e\u5e93\u4e2d\u662f\u5426\u6709\u5bf9\u5e94\u7684\u6570\u636e\u8868\u4e86\uff1a\n\n\n(\ntdd3\n)\n$ docker \nexec\n -it users-db mysql -uroot -p\nEnter password:\n\n\n\n\n\n\u7136\u540e\u8f93\u5165\u4e0a\u9762\u6211\u4eec\u73af\u5883\u53d8\u91cf\u4e2d\u8bbe\u7f6e\u7684\nroot321\n\u5c31\u767b\u5f55\u5230\nMySQL\n\u6570\u636e\u5e93\u4e2d\u4e86\u3002\u7136\u540e\u6267\u884c\u4e0b\u9762\u7684\u7cfb\u5217\u547d\u4ee4\u67e5\u770b\u6570\u636e\u5e93\u3001\u67e5\u770b\u6570\u636e\u8868\u7ed3\u6784\uff1a\n\n\nmysql\n show databases\n;\n\n+--------------------+\n\n|\n Database           \n|\n\n+--------------------+\n\n|\n information_schema \n|\n\n\n|\n mysql              \n|\n\n\n|\n performance_schema \n|\n\n\n|\n users_dev          \n|\n\n\n|\n users_prod         \n|\n\n\n|\n users_test         \n|\n\n+--------------------+\n\n6\n rows in \nset\n \n(\n0\n.00 sec\n)\n\n\nmysql\n use users_dev\n;\n\nReading table information \nfor\n completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql\n show tables\n;\n\n+---------------------+\n\n|\n Tables_in_users_dev \n|\n\n+---------------------+\n\n|\n users               \n|\n\n+---------------------+\n\n1\n row in \nset\n \n(\n0\n.00 sec\n)\n\n\nmysql\n desc users\n;\n\n+------------+--------------+------+-----+---------+----------------+\n\n|\n Field      \n|\n Type         \n|\n Null \n|\n Key \n|\n Default \n|\n Extra          \n|\n\n+------------+--------------+------+-----+---------+----------------+\n\n|\n id         \n|\n int\n(\n11\n)\n      \n|\n NO   \n|\n PRI \n|\n NULL    \n|\n auto_increment \n|\n\n\n|\n username   \n|\n varchar\n(\n128\n)\n \n|\n NO   \n|\n     \n|\n NULL    \n|\n                \n|\n\n\n|\n email      \n|\n varchar\n(\n128\n)\n \n|\n NO   \n|\n     \n|\n NULL    \n|\n                \n|\n\n\n|\n active     \n|\n tinyint\n(\n1\n)\n   \n|\n NO   \n|\n     \n|\n NULL    \n|\n                \n|\n\n\n|\n created_at \n|\n datetime     \n|\n NO   \n|\n     \n|\n NULL    \n|\n                \n|\n\n+------------+--------------+------+-----+---------+----------------+\n\n5\n rows in \nset\n \n(\n0\n.00 sec\n)\n\n\n\n\n\n\n\u4ece\u4e0a\u9762\u7684\u547d\u4ee4\u6211\u4eec\u53ef\u4ee5\u770b\u5230\nmodel\n\u548c\u6211\u4eec\u7684\u6570\u636e\u8868\u5df2\u7ecf\u6620\u5c04\u6210\u529f\u4e86\u3002", 
            "title": "\u6570\u636e\u5e93\u5b89\u88c5\u914d\u7f6e"
        }, 
        {
            "location": "/part1/test/", 
            "text": "\u6309\u7167\u6211\u4eec\u5e73\u65f6\u7684\u5f00\u53d1\u4e60\u60ef\uff0c\u662f\u4e0d\u662f\u63a5\u4e0b\u6765\u5c31\u5e94\u8be5\u5f00\u53d1\u4e1a\u52a1\u4ee3\u7801\u4e86\uff1f\u5f53\u7136\u8fd9\u6837\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u6211\u4eec\u8fd9\u91cc\u4e0d\u8fd9\u6837\u505a\uff0c\u6211\u4eec\u8ba9\u6d4b\u8bd5\u5148\u884c\uff0c\u8ba9\u6d4b\u8bd5\u6765\u9a71\u52a8\u5f00\u53d1\uff0c\u8fd9\u6837\u6709\u4ec0\u4e48\u597d\u5904\u5462\uff1f\nTDD\n\u6700\u91cd\u8981\u7684\u529f\u80fd\u5c31\u662f\u4fdd\u969c\u4ee3\u7801\u7684\u6b63\u786e\u6027\uff0c\u80fd\u591f\u8fc5\u901f\u53d1\u73b0\u3001\u5b9a\u4f4d\nbug\n\u3002\u5173\u4e8e\nTDD\n\u66f4\u591a\u7684\u77e5\u8bc6\u53ef\u4ee5\u81ea\u884c\nGoogle\n\u3002\u63d0\u4f9b\u4e00\u4e2a\u7bc7\nIBM\n\u5173\u4e8e\nTDD\n\u4ecb\u7ecd\u7684\u6587\u7ae0\uff1a\n\u6d45\u8c08\u6d4b\u8bd5\u9a71\u52a8\u5f00\u53d1\uff08TDD\uff09\n\n\n\u9996\u5148\u65b0\u589e\u6d4b\u8bd5\u7528\u7684\u4f9d\u8d56\u5305\uff1a\nFlask-Testing\n\u5230\nrequirements.txt\n\u6587\u4ef6\u4e0b\u9762\uff08\u8bb0\u5f97\u7528\npip\n\u547d\u4ee4\u5b89\u88c5\u54e6~\uff09\uff1a\n\n\nFlask-Testing==0.7.1\n\n\n\n\n\n\u5728\nproject\n\u76ee\u5f55\u4e0b\u9762\u65b0\u5efa\u4e00\u4e2a\ntests\n\u7684\u76ee\u5f55\uff0c\u7136\u540e\u5728\u8be5\u76ee\u5f55\u4f7f\u7528\u4e0b\u9762\u65b0\u589e\u51e0\u4e2a\u6587\u4ef6\uff1a\n\n\n(\ntdd3\n)\n$ touch __init__.py base.py test_config.py test_users.py\n\n\n\n\n\n\u5982\u679c\u4f60\u5bf9\nFlask-Testing\n\u8fd8\u4e0d\u592a\u719f\u6089\uff0c\u5728\u7f16\u5199\u6d4b\u8bd5\u6587\u4ef6\u4e4b\u524d\uff0c\u53ef\u4ee5\u5148\u7b80\u5355\u67e5\n\u770b\u4e0b\u6587\u6863\n\u3002\n\n\n\u66f4\u65b0\nbase.py\n\u6587\u4ef6\uff1a\n\n\n# project/tests/base.py\n\n\nfrom\n \nflask_testing\n \nimport\n \nTestCase\n\n\nfrom\n \nproject\n \nimport\n \napp\n,\n \ndb\n\n\n\nclass\n \nBaseTestCase\n(\nTestCase\n):\n\n    \ndef\n \ncreate_app\n(\nself\n):\n\n        \napp\n.\nconfig\n.\nfrom_object\n(\nproject.config.TestingConfig\n)\n\n        \nreturn\n \napp\n\n\n    \ndef\n \nsetUp\n(\nself\n):\n\n        \ndb\n.\ncreate_all\n()\n\n        \ndb\n.\nsession\n.\ncommit\n()\n\n\n    \ndef\n \ntearDown\n(\nself\n):\n\n        \ndb\n.\nsession\n.\nremove\n()\n\n        \ndb\n.\ndrop_all\n()\n\n\n\n\n\n\n\u9996\u5148\uff0c\u6211\u4eec\u786e\u4fdd\u6d4b\u8bd5\u4f7f\u7528\u7684\u6570\u636e\u5e93\nURI\n\u4e0d\u662f\u751f\u4ea7\u73af\u5883\u7684\uff0c\u907f\u514d\u5bf9\u7ebf\u4e0a\u73af\u5883\u4ea7\u751f\u4efb\u4f55\u5f71\u54cd\u3002\u6bcf\u6b21\u6d4b\u8bd5\u7684\u65f6\u5019\u521b\u5efa\u6570\u636e\u8868\u3001\u5b8c\u6210\u540e\u5220\u9664\u8868\uff0c\u786e\u4fdd\u80fd\u591f\u6e05\u7406\u6d4b\u8bd5\u6570\u636e\u3002\n\n\n\n\n\u5fc5\u987b\u6307\u5b9a\u4e00\u4e2acreate_app \u65b9\u6cd5\uff0c\u5e76\u4e14\u8fd4\u56deflask app \u5b9e\u4f8b\uff0c\u5982\u679c\u6ca1\u6709\u5b9a\u4e49\u5c06\u4f1a\u629b\u51fa\nNotImplementedError\n\u5f02\u5e38\u3002\n\n\n\n\n\u53e6\u5916\u5728\ntearDown\n\u65b9\u6cd5\u4e2d\u589e\u52a0\ndb.session.remove()\n\u65b9\u6cd5\uff0c\u8fd9\u6837\u80fd\u591f\u786e\u4fdd\u6bcf\u6b21\u6d4b\u8bd5\u5b8c\u6210\u7684\u65f6\u5019\u80fd\u591f\u5c06\nSQLAlchemy\n\u7684\nsession\n\u5c5e\u6027\u79fb\u9664\u6389\uff0c\u5728\u4e0b\u4e00\u6b21\u6d4b\u8bd5\u7684\u65f6\u5019\u59cb\u7ec8\u662f\u4e00\u4e2a\u65b0\u7684\nsession\n\u3002\n\n\n\u66f4\u65b0\ntest_config.py\n\u6587\u4ef6\uff1a\n\n\nfrom\n \nflask\n \nimport\n \ncurrent_app\n\n\nfrom\n \nflask_testing\n \nimport\n \nTestCase\n\n\nfrom\n \nproject\n \nimport\n \napp\n\n\n\nclass\n \nTestDevelopmentConfig\n(\nTestCase\n):\n\n    \ndef\n \ncreate_app\n(\nself\n):\n\n        \napp\n.\nconfig\n.\nfrom_object\n(\nproject.config.DevelopmentConfig\n)\n\n        \nreturn\n \napp\n\n\n    \ndef\n \ntest_app_is_development\n(\nself\n):\n\n        \nself\n.\nassertTrue\n(\napp\n.\nconfig\n[\nSECRET_KEY\n]\n \n==\n \nsecret\n)\n\n        \nself\n.\nassertTrue\n(\napp\n.\nconfig\n[\nDEBUG\n]\n \nis\n \nTrue\n)\n\n        \nself\n.\nassertFalse\n(\ncurrent_app\n \nis\n \nNone\n)\n\n        \nself\n.\nassertTrue\n(\n\n            \napp\n.\nconfig\n[\nSQLALCHEMY_DATABASE_URI\n]\n \n==\n\n            \nmysql+pymysql://root:root321@users-db:3306/users_dev\n\n        \n)\n\n\n\nclass\n \nTestTestingConfig\n(\nTestCase\n):\n\n    \ndef\n \ncreate_app\n(\nself\n):\n\n        \napp\n.\nconfig\n.\nfrom_object\n(\nproject.config.TestingConfig\n)\n\n        \nreturn\n \napp\n\n\n    \ndef\n \ntest_app_is_testing\n(\nself\n):\n\n        \nself\n.\nassertTrue\n(\napp\n.\nconfig\n[\nSECRET_KEY\n]\n \n==\n \nsecret\n)\n\n        \nself\n.\nassertTrue\n(\napp\n.\nconfig\n[\nDEBUG\n])\n\n        \nself\n.\nassertTrue\n(\napp\n.\nconfig\n[\nTESTING\n])\n\n        \nself\n.\nassertFalse\n(\napp\n.\nconfig\n[\nPRESERVE_CONTEXT_ON_EXCEPTION\n])\n\n        \nself\n.\nassertTrue\n(\n\n            \napp\n.\nconfig\n[\nSQLALCHEMY_DATABASE_URI\n]\n \n==\n\n            \nmysql+pymysql://root:root321@users-db:3306/users_test\n\n        \n)\n\n\n\nclass\n \nTestProductionConfig\n(\nTestCase\n):\n\n    \ndef\n \ncreate_app\n(\nself\n):\n\n        \napp\n.\nconfig\n.\nfrom_object\n(\nproject.config.ProductionConfig\n)\n\n        \nreturn\n \napp\n\n\n    \ndef\n \ntest_app_is_production\n(\nself\n):\n\n        \nself\n.\nassertTrue\n(\napp\n.\nconfig\n[\nSECRET_KEY\n]\n \n==\n \nsecret\n)\n\n        \nself\n.\nassertFalse\n(\napp\n.\nconfig\n[\nDEBUG\n])\n\n        \nself\n.\nassertFalse\n(\napp\n.\nconfig\n[\nTESTING\n])\n\n\n\n\n\n\n\u66f4\u65b0\ntest_users.py\n\u6587\u4ef6\uff1a\n\n\nimport\n \njson\n\n\nfrom\n \nproject.tests.base\n \nimport\n \nBaseTestCase\n\n\n\nclass\n \nTestUserService\n(\nBaseTestCase\n):\n\n    \ndef\n \ntest_users\n(\nself\n):\n\n        \n\u786e\u4fddping\u7684\u670d\u52a1\u6b63\u5e38.\n\n        \nresponse\n \n=\n \nself\n.\nclient\n.\nget\n(\n/ping\n)\n\n        \ndata\n \n=\n \njson\n.\nloads\n(\nresponse\n.\ndata\n.\ndecode\n())\n\n        \nself\n.\nassertEqual\n(\nresponse\n.\nstatus_code\n,\n \n200\n)\n\n        \nself\n.\nassertIn\n(\npong\n,\n \ndata\n[\nmessage\n])\n\n        \nself\n.\nassertIn\n(\nsuccess\n,\n \ndata\n[\nstatus\n])\n\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u5728\nmanage.py\n\u4e2d\u65b0\u589e\u4e00\u4e2a\u6d4b\u8bd5\u7684\u547d\u4ee4\u884c\u652f\u6301\uff1a\n\n\nimport\n \nunittest\n\n\nfrom\n \nflask_script\n \nimport\n \nManager\n\n\nfrom\n \nproject\n \nimport\n \napp\n,\n \ndb\n\n\n\nmanager\n \n=\n \nManager\n(\napp\n)\n\n\n\n@manager.command\n\n\ndef\n \nrecreate_db\n():\n\n    \n\u91cd\u65b0\u521b\u5efa\u6570\u636e\u8868.\n\n    \ndb\n.\ndrop_all\n()\n\n    \ndb\n.\ncreate_all\n()\n\n    \ndb\n.\nsession\n.\ncommit\n()\n\n\n\n@manager.command\n\n\ndef\n \ntest\n():\n\n    \n\u8fd0\u884c\u6d4b\u8bd5.\n\n    \ntests\n \n=\n \nunittest\n.\nTestLoader\n()\n.\ndiscover\n(\nproject/tests\n,\n \npattern\n=\ntest_*.py\n)\n\n    \nresult\n \n=\n \nunittest\n.\nTextTestRunner\n(\nverbosity\n=\n2\n)\n.\nrun\n(\ntests\n)\n\n    \nif\n \nresult\n.\nwasSuccessful\n():\n\n        \nreturn\n \n0\n\n    \nreturn\n \n1\n\n\n\nif\n \n__name__\n \n==\n \n__main__\n:\n\n    \nmanager\n.\nrun\n()\n\n\n\n\n\n\nunittest\n\u652f\u6301\u975e\u5e38\u7b80\u5355\u7684\u6d4b\u8bd5\u53d1\u73b0\uff0c\u4e3a\u4e86\u517c\u5bb9\u6d4b\u8bd5\u53d1\u73b0\uff0c\u6240\u6709\u7684\u6d4b\u8bd5\u6587\u4ef6(test_xxx.py)\u5fc5\u987b\u662f\u53ef\u4ee5\u4ece\u9879\u76ee\u7684\u9876\u7ea7\u76ee\u5f55\u5bfc\u5165\u7684\u5305\u6216\u8005\u6a21\u5757\uff0c\u6211\u4eec\u8fd9\u91cc\u5c31\u662f\u5229\u7528\nTestLoader.discover()\n\u65b9\u6cd5\u53bb\u53d1\u73b0\nproject/tests\n\u5305\u4e0b\u9762\u7684\u6240\u6709\u7684\ntest_xxx.py\n\u6d4b\u8bd5\u6587\u4ef6\u3002\u7136\u540e\u4f7f\u7528\nTextTestRunner\n\u7528\u6765\u6267\u884c\u6d4b\u8bd5\u7528\u4f8b\uff0c\u5bf9\u6d4b\u8bd5\u8fdb\u884c\u7f16\u6392\u5e76\u628a\u7ed3\u679c\u8fd4\u56de\u7ed9\u7528\u6237\u3002\n\n\n\u5982\u679c\u662f\u5355\u4e2a\u7684\u6d4b\u8bd5\u6587\u4ef6\uff0c\u63a8\u8350\u4f60\u5c06\u6240\u6709\u7684\u6d4b\u8bd5\u65b9\u6cd5\u653e\u5728\u540c\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u8fd9\u6837\u80fd\u591f\u65b9\u4fbf\u7684\u4f7f\u7528\nunittest.main()\n\u65b9\u6cd5\u6267\u884c\uff1a\n\n\nimport\n \nunittest\n\n\nimport\n \nflask_testing\n\n\n\n# TODO your test cases\n\n\n\nif\n \n__name__\n \n==\n \n__main__\n:\n\n    \nunittest\n.\nmain\n()\n\n\n\n\n\n\n\u7136\u540e\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\npython test_xxx.py\n\u8fdb\u884c\u6d4b\u8bd5\u3002\n\n\n\u7531\u4e8e\u6211\u4eec\u8fd9\u91cc\u6709\ntest_config.py\n\u548c\ntest_users.py\n\u4e24\u4e2a\u4e1a\u52a1\u4e0d\u4e00\u6837\u7684\u6d4b\u8bd5\u7528\u4f8b\uff0c\u6240\u4ee5\u6211\u4eec\u4f7f\u7528\ntest runner\n\u6765\u6536\u96c6\u6240\u6709\u7684\u6d4b\u8bd5\u7ed3\u679c\u5e76\u751f\u6210\u6700\u540e\u7684\u6d4b\u8bd5\u62a5\u544a\u3002\n\n\n\u7531\u4e8e\u6211\u4eec\u66f4\u65b0\u4e86\u4f9d\u8d56\u5305\uff0c\u6240\u4ee5\u9700\u8981\u91cd\u65b0\u6784\u5efa\u955c\u50cf\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose up -d --build\n\n\n\n\n\n\u7136\u540e\u8fd0\u884c\u6d4b\u8bd5\u547d\u4ee4\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose run users-service python manage.py \ntest\n\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u7684\u6d4b\u8bd5\u6ca1\u6709\u901a\u8fc7\u7684\u63d0\u793a\u4fe1\u606f\uff1a\n\n\n======================================================================\n\nFAIL: test_app_is_development \n(\ntest_config.TestDevelopmentConfig\n)\n\n----------------------------------------------------------------------\nTraceback \n(\nmost recent call last\n)\n:\n  File \n/usr/src/app/project/tests/test_config.py\n, line \n13\n, in test_app_is_development\n    self.assertTrue\n(\napp.config\n[\nSECRET_KEY\n]\n \n==\n \nsecret\n)\n\nAssertionError: False is not \ntrue\n\n\n\n\n\n\n\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u7684\napp.config\n\u4e2d\u8fd8\u6ca1\u6709\nSECRET_KEY\n\u8fd9\u4e2akey\uff0c\u6240\u4ee5\nassertTrue\n\u80af\u5b9a\u662f\u4e0d\u4f1a\u901a\u8fc7\u7684\uff0c\u7136\u540e\u6211\u4eec\u5728\nconfig.py\n\u7684\nBaseConfig\n\u7c7b\u4e2d\u65b0\u589e\nSECRET_KEY\n\u5c5e\u6027\uff1a\n\n\nclass\n \nBaseConfig\n:\n\n    \n\u57fa\u7840\u914d\u7f6e\n\n    \nDEBUG\n \n=\n \nFalse\n\n    \nTESTING\n \n=\n \nFalse\n\n    \nSQLALCHEMY_TRACK_MODIFICATIONS\n \n=\n \nFalse\n\n    \nSECRET_KEY\n \n=\n \nsecret\n\n\n\n\n\n\n\u91cd\u65b0\u6267\u884c\u6d4b\u8bd5\u547d\u4ee4\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose run users-service python manage.py \ntest\n\nStarting users-db ... \ndone\n\ntest_app_is_development \n(\ntest_config.TestDevelopmentConfig\n)\n ... ok\ntest_app_is_production \n(\ntest_config.TestProductionConfig\n)\n ... ok\ntest_app_is_testing \n(\ntest_config.TestTestingConfig\n)\n ... ok\ntest_users \n(\ntest_users.TestUserService\n)\n\n\u786e\u4fddping\u7684\u670d\u52a1\u6b63\u5e38. ... ok\n\n----------------------------------------------------------------------\nRan \n4\n tests in \n0\n.124s\n\nOK\n\n\n\n\n\n\u6d4b\u8bd5\u901a\u8fc7~~~", 
            "title": "\u6d4b\u8bd5"
        }, 
        {
            "location": "/part1/flask-blueprint/", 
            "text": "\u4e0a\u8282\u8bfe\u5b8c\u6210\u4e86\u6211\u4eec\u7684\u57fa\u672c\u6d4b\u8bd5\uff0c\u8fd9\u8282\u8bfe\u6211\u4eec\u6765\u7528\nBlueprint\n(\u84dd\u56fe)\u6765\u5bf9\u9879\u76ee\u8fdb\u884c\u91cd\u6784\u3002\n\n\n\n\n\u8fd8\u4e0d\u4e86\u89e3\nBlueprint\n\uff1f\u53ef\u4ee5\u5148\u67e5\u770b\nflask blueprint \u6587\u6863\n\u3002\u7b80\u5355\u6765\u8bf4\uff0c\nFlask Blueprint\n\u63d0\u4f9b\u4e86\u6a21\u5757\u5316\u7ba1\u7406\u7a0b\u5e8f\u8def\u7531\u7684\u529f\u80fd\uff0c\u4f7f\u7a0b\u5e8f\u7ed3\u6784\u6e05\u6670\u3001\u7b80\u5355\u6613\u61c2\u3002\u8fd8\u662f\u4e0d\u592a\u660e\u767d\uff1f\u6ca1\u5173\u7cfb\uff0c\u8fd9\u8282\u8bfe\u5b8c\u6210\u540e\u6211\u76f8\u4fe1\u4f60\u4e00\u5b9a\u4f1a\u660e\u767d\u7684~\n\n\n\n\n\u5728\nproject\n\u76ee\u5f55\u4e0b\u9762\u65b0\u589e\napi\n\u7684\u76ee\u5f55\uff0c\u7136\u540e\u540c\u6837\u7684\u9700\u8981\u5728\u8be5\u76ee\u5f55\u4e0b\u9762\u65b0\u5efa\u51e0\u4e2a\u6587\u4ef6\uff1a\n\n\n(\ntdd3\n)\n$ touch __init__.py models.py views.py\n\n\n\n\n\n\u7136\u540e\u66f4\u65b0\nviews.py\n\u6587\u4ef6\uff1a\n\n\n# project/api/views.py\n\n\nfrom\n \nflask\n \nimport\n \nBlueprint\n,\n \njsonify\n\n\n\nusers_blueprint\n \n=\n \nBlueprint\n(\nusers\n,\n \n__name__\n)\n\n\n\n@users_blueprint.route\n(\n/ping\n,\n \nmethods\n=\n[\nGET\n])\n\n\ndef\n \nping_pong\n():\n\n    \nreturn\n \njsonify\n({\n\n        \nstatus\n:\n \nsuccess\n,\n\n        \nmessage\n:\n \npong!\n\n    \n})\n\n\n\n\n\n\n\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\nusers_blueprint\n\u7684\nBlueprint\n\u5b9e\u4f8b\uff0c\u7136\u540e\u5c06\u8be5\u5b9e\u4f8b\u7ed1\u5b9a\u5230\u4e86\nping_pong()\n\u65b9\u6cd5\u4e0a\uff0c\u8fd9\u6709\u4ec0\u4e48\u7528\uff1f\u7ee7\u7eed\u5f80\u4e0b\u770b......\n\n\n\u7136\u540e\u66f4\u65b0\nmodels.py\n\u6587\u4ef6\uff1a\n\n\n# project/api/models.py\n\n\nimport\n \ndatetime\n\n\nfrom\n \nproject\n \nimport\n \ndb\n\n\n\nclass\n \nUser\n(\ndb\n.\nModel\n):\n\n    \n__tablename__\n \n=\n \nusers\n\n    \nid\n \n=\n \ndb\n.\nColumn\n(\ndb\n.\nInteger\n,\n \nprimary_key\n=\nTrue\n,\n \nautoincrement\n=\nTrue\n)\n\n    \nusername\n \n=\n \ndb\n.\nColumn\n(\ndb\n.\nString\n(\n128\n),\n \nnullable\n=\nFalse\n)\n\n    \nemail\n \n=\n \ndb\n.\nColumn\n(\ndb\n.\nString\n(\n128\n),\n \nnullable\n=\nFalse\n)\n\n    \nactive\n \n=\n \ndb\n.\nColumn\n(\ndb\n.\nBoolean\n(),\n \ndefault\n=\nFalse\n,\n \nnullable\n=\nFalse\n)\n\n    \ncreated_at\n \n=\n \ndb\n.\nColumn\n(\ndb\n.\nDateTime\n,\n \nnullable\n=\nFalse\n)\n\n\n    \ndef\n \n__init__\n(\nself\n,\n \nusername\n,\n \nemail\n):\n\n        \nself\n.\nusername\n \n=\n \nusername\n\n        \nself\n.\nemail\n \n=\n \nemail\n\n        \nself\n.\ncreated_at\n \n=\n \ndatetime\n.\ndatetime\n.\nutcnow\n()\n\n\n\n\n\n\n\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e0a\u9762\u7684\u5185\u5bb9\u548c\nproject/__init__.py\n\u6587\u4ef6\u4e2d\u7684\nUser\n\u7c7b\u662f\u4e00\u6a21\u4e00\u6837\u7684\uff0c\u6ca1\u9519\uff0c\u6211\u4eec\u53ea\u662f\u5c06\u8fd9\u4e2a\u5730\u65b9\u4ee3\u7801\u5206\u62c6\u4e86\u800c\u5df2\uff0c\u4e0b\u9762\u7ee7\u7eed\u66f4\u65b0\nproject/__init__.py\n\u6587\u4ef6\uff1a\n\n\n# project/__init__.py\n\n\nimport\n \nos\n\n\nfrom\n \nflask\n \nimport\n \nFlask\n,\n \njsonify\n\n\nfrom\n \nflask_sqlalchemy\n \nimport\n \nSQLAlchemy\n\n\n\n# \u521d\u59cb\u5316\u6570\u636e\u5e93\n\n\ndb\n \n=\n \nSQLAlchemy\n()\n\n\n\ndef\n \ncreate_app\n():\n\n    \n# \u521d\u59cb\u5316\u5e94\u7528\n\n    \napp\n \n=\n \nFlask\n(\n__name__\n)\n\n    \n# \u73af\u5883\u914d\u7f6e\n\n    \napp_settings\n \n=\n \nos\n.\ngetenv\n(\nAPP_SETTINGS\n)\n\n    \napp\n.\nconfig\n.\nfrom_object\n(\napp_settings\n)\n\n    \n# \u5b89\u88c5\u6269\u5c55\n\n    \ndb\n.\ninit_app\n(\napp\n)\n\n    \n# \u6ce8\u518cblueprint\n\n    \nfrom\n \nproject.api.views\n \nimport\n \nusers_blueprint\n\n    \napp\n.\nregister_blueprint\n(\nusers_blueprint\n)\n\n    \nreturn\n \napp\n\n\n\n\n\n\n\u6ce8\u610f\u8fd9\u91cc\u6211\u4eec\u5c06\u5b9e\u4f8b\u5316app\u7684\u5de5\u4f5c\u63d0\u53d6\u5230\u4e86\ncreate_app\n\u7684\u65b9\u6cd5\u91cc\u9762\u53bb\uff0c\u8fd9\u662f\u56e0\u4e3a\nusers_blueprint\n\u91cc\u9762\u9700\u8981\u5f15\u7528\u5230\u5f53\u524d\u6587\u4ef6\u4e0b\u9762\u7684\ndb\n\u5b9e\u4f8b\uff0c\u5982\u679c\u4e0d\u628aapp\u653e\u7f6e\u5230\u65b9\u6cd5\u4e2d\u53bb\u7684\u8bdd\u5c31\u4f1a\u9020\u6210\n\u5faa\u73af\u5f15\u7528\n\uff0c\u4ec0\u4e48\u610f\u601d\uff1f\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u4f60\u4e2d\u6709\u6211\uff0c\u6211\u4e2d\u6709\u4f60\uff0c\u8fd9\u5bf9\u4e8e\u7a0b\u5e8f\u6765\u8bf4\u662f\u65e0\u6cd5\u505a\u51fa\u5224\u65ad\u7684~\n\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u9700\u8981\u628a\u6240\u6709\u5176\u4ed6\u6587\u4ef6\u5f15\u7528\nproject\n\u4e0b\u9762\u7684app \u7684\u5b9e\u4f8b\u7684\u90fd\u8981\u66ff\u6362\u6389(\u5305\u62ec\u6d4b\u8bd5\u6587\u4ef6)\uff1a\n\n\nfrom\n \nproject\n \nimport\n \ncreate_app\n\n\n\napp\n \n=\n \ncreate_app\n()\n\n\n\n\n\n\n\u66f4\u6539\u5b8c\u6210\u4ee5\u540e\u6211\u4eec\u91cd\u65b0\u6784\u5efa\u955c\u50cf\u3001\u521b\u5efa\u6570\u636e\u5e93\uff0c\u6700\u91cd\u8981\u7684\u662f\u4ec0\u4e48\uff1f\n\u6d4b\u8bd5\n\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose up -d\nusers-db is up-to-date\nStarting users-service ...\nStarting users-service ... \ndone\n\n\n(\ntdd3\n)\n$ docker-compose run users-service python manage.py recreate_db\nStarting users-db ... \ndone\n\n\n(\ntdd3\n)\n$ docker-compose run users-service python manage.py \ntest\n\nStarting users-db ... \ndone\n\ntest_app_is_development \n(\ntest_config.TestDevelopmentConfig\n)\n ... ok\ntest_app_is_production \n(\ntest_config.TestProductionConfig\n)\n ... ok\ntest_app_is_testing \n(\ntest_config.TestTestingConfig\n)\n ... ok\ntest_users \n(\ntest_users.TestUserService\n)\n\n\u786e\u4fddping\u7684\u670d\u52a1\u6b63\u5e38. ... ok\n\n----------------------------------------------------------------------\nRan \n4\n tests in \n0\n.086s\n\nOK\n\n\n\n\n\n\u4e00\u5207\u6b63\u5e38~~~\n\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u6839\u636e\nRESTful\n\u7684\u6700\u4f73\u5b9e\u8df5\u5229\u7528\nTDD\n\u589e\u52a03\u4e2a\u8def\u7531\uff1a\n\n\n\n\n\n\n\n\nEndpoint\n\n\nHTTP Method\n\n\nCRUD Method\n\n\nResult\n\n\n\n\n\n\n\n\n\n\n/users\n\n\nGET\n\n\n\u67e5\u8be2\n\n\n\u83b7\u53d6\u6240\u6709\u7528\u6237\n\n\n\n\n\n\n/users/:id\n\n\nGET\n\n\n\u67e5\u8be2\n\n\n\u83b7\u53d6\u5355\u4e2a\u7528\u6237\n\n\n\n\n\n\n/users\n\n\nPOST\n\n\n\u65b0\u589e\n\n\n\u65b0\u589e\u7528\u6237\n\n\n\n\n\n\n\n\n\u9996\u5148\uff0c\u5728\nproject/tests/test_users.py\n\u6587\u4ef6\u7684\nTestUserService\n\u7c7b\u4e2d\u65b0\u589e\u4e00\u4e2a\u6d4b\u8bd5\u65b0\u589e\u7528\u6237\u7684\u65b9\u6cd5\uff1a\n\n\ndef\n \ntest_add_user\n(\nself\n):\n\n    \n\u786e\u4fdd\u80fd\u591f\u6b63\u786e\u6dfb\u52a0\u4e00\u4e2a\u7528\u6237\u7684\u7528\u6237\u5230\u6570\u636e\u5e93\u4e2d\n\n    \nwith\n \nself\n.\nclient\n:\n\n        \nresponse\n \n=\n \nself\n.\nclient\n.\npost\n(\n\n            \n/users\n,\n\n            \ndata\n=\njson\n.\ndumps\n(\ndict\n(\nusername\n=\ncnych\n,\n \nemail\n=\nqikqiak@gmail.com\n)),\n\n            \ncontent_type\n=\napplication/json\n,\n\n        \n)\n\n        \ndata\n \n=\n \njson\n.\nloads\n(\nresponse\n.\ndata\n.\ndecode\n())\n\n        \nself\n.\nassertEqual\n(\nresponse\n.\nstatus_code\n,\n \n201\n)\n\n        \nself\n.\nassertIn\n(\nqikqiak@gmail.com was added\n,\n \ndata\n[\nmessage\n])\n\n        \nself\n.\nassertEqual\n(\nsuccess\n,\n \ndata\n[\nstatus\n])\n\n\n\n\n\n\n\u6211\u4eec\u73b0\u5728\u6765\u6267\u884c\u6d4b\u8bd5\u80af\u5b9a\u662f\u4e0d\u4f1a\u901a\u8fc7\u7684\uff0c\u56e0\u4e3a\u8def\u7531\n/users\n\u8fd8\u6ca1\u5b9e\u73b0\u7684\uff0c\u6240\u4ee5\u63a5\u7740\u6211\u4eec\u5728\nproject/api/views.py\n\u4e2d\u65b0\u589e\u4e00\u4e2a\n/users\n\u7684\u5904\u7406\u65b9\u6cd5\uff1a\n\n\n# \u6ce8\u610f\u8981\u5bfc\u5165request\n\n\nfrom\n \nflask\n \nimport\n \nBlueprint\n,\n \njsonify\n,\n \nrequest\n,\n \nrender_template\n\n\nfrom\n \nproject\n \nimport\n \ndb\n\n\nfrom\n \nproject.api.models\n \nimport\n \nUser\n\n\n\n@users_blueprint.route\n(\n/users\n,\n \nmethods\n=\n[\nPOST\n])\n\n\ndef\n \nadd_user\n():\n\n    \n# \u83b7\u53d6POST\u7684\u6570\u636e\n\n    \npost_data\n \n=\n \nrequest\n.\nget_json\n()\n\n    \nemail\n \n=\n \npost_data\n.\nget\n(\nemail\n)\n\n    \nuser\n \n=\n \nUser\n(\nusername\n=\npost_data\n.\nget\n(\nusername\n),\n \nemail\n=\nemail\n)\n\n    \ndb\n.\nsession\n.\nadd\n(\nuser\n)\n\n    \ndb\n.\nsession\n.\ncommit\n()\n\n    \nresponse_data\n \n=\n \n{\n\n        \nstatus\n:\n \nsuccess\n,\n\n        \nmessage\n:\n \n%s\n was added!\n \n%\n \nemail\n\n    \n}\n\n    \nreturn\n \njsonify\n(\nresponse_data\n),\n \n201\n\n\n\n\n\n\n\n\n\u6ce8\u610f\u4e0a\u9762\u6211\u4eec\nadd_user\n\u65b9\u6cd5\u6700\u7ec8\u8fd4\u56de\u7684\u6570\u636e\uff0c\u662f\u4ece\u6211\u4eec\u4e0a\u9762\u8bbe\u8ba1\u7684\u6d4b\u8bd5\u4ee3\u7801\u4e2d\u6765\u7684\uff0c\u8fd9\u5c31\u662f\u6240\u8c13\u7684\n\u6d4b\u8bd5\u9a71\u52a8\n\u6211\u4eec\u7684\u5f00\u53d1~\n\n\n\n\n\u7136\u540e\u6267\u884c\u6d4b\u8bd5\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose run users-service python manage.py \ntest\n\nStarting users-db ... \ndone\n\ntest_app_is_development \n(\ntest_config.TestDevelopmentConfig\n)\n ... ok\ntest_app_is_production \n(\ntest_config.TestProductionConfig\n)\n ... ok\ntest_app_is_testing \n(\ntest_config.TestTestingConfig\n)\n ... ok\ntest_add_user \n(\ntest_users.TestUserService\n)\n\n\u786e\u4fdd\u80fd\u591f\u6b63\u786e\u6dfb\u52a0\u4e00\u4e2a\u7528\u6237\u7684\u7528\u6237\u5230\u6570\u636e\u5e93\u4e2d ... ok\ntest_users \n(\ntest_users.TestUserService\n)\n\n\u786e\u4fddping\u7684\u670d\u52a1\u6b63\u5e38. ... ok\n\n----------------------------------------------------------------------\nRan \n5\n tests in \n0\n.157s\n\nOK\n\n\n\n\n\n\u6d4b\u8bd5\u901a\u8fc7~~~\n\n\n\u4f46\u662f\u8fd8\u6ca1\u5b8c\u5462\uff1f\u73b0\u5728\u6211\u4eec\u7684\u4ee3\u7801\u8fd8\u4e0d\u591f\u5065\u58ee\uff0c\u5982\u679c\u7a0b\u5e8f\u4e2d\u51fa\u73b0\u4e86\u9519\u8bef\u6216\u8005\u5f02\u5e38\u8be5\u600e\u4e48\u529e\u5462\uff1f\u6bd4\u5982\uff1a\n\n\n\n\nPOST \u7684\u6570\u636e\u4e3a\u7a7a\n\n\nPOST \u7684\u6570\u636e\u65e0\u6548 - \u6bd4\u5982JSON \u5bf9\u8c61\u662f\u7a7a\u7684\u6216\u8005\u5305\u542b\u4e00\u4e2a\u9519\u8bef\u7684key\n\n\n\u5982\u679c\u6dfb\u52a0\u7684\u7528\u6237\u5728\u6570\u636e\u4e2d\u5df2\u7ecf\u5b58\u5728\uff1f\n\n\n\n\n\u6765\u5bf9\u8fd9\u4e9b\u7528\u4f8b\u6dfb\u52a0\u4e00\u4e9b\u6d4b\u8bd5\u4ee3\u7801\uff1a\n\n\ndef\n \ntest_add_user_invalid_json\n(\nself\n):\n\n    \n\u5982\u679cJSON\u5bf9\u8c61\u4e3a\u7a7a\uff0c\u786e\u4fdd\u629b\u51fa\u4e00\u4e2a\u9519\u8bef\u3002\n\n    \nwith\n \nself\n.\nclient\n:\n\n        \nresponse\n \n=\n \nself\n.\nclient\n.\npost\n(\n\n            \n/users\n,\n\n            \ndata\n=\njson\n.\ndumps\n(\ndict\n()),\n\n            \ncontent_type\n=\napplication/json\n\n        \n)\n\n        \ndata\n \n=\n \njson\n.\nloads\n(\nresponse\n.\ndata\n.\ndecode\n())\n\n        \nself\n.\nassertEqual\n(\nresponse\n.\nstatus_code\n,\n \n400\n)\n\n        \nself\n.\nassertIn\n(\nInvalid payload\n,\n \ndata\n[\nmessage\n])\n\n        \nself\n.\nassertEqual\n(\nfail\n,\n \ndata\n[\nstatus\n])\n\n\n\ndef\n \ntest_add_user_invalid_json_keys\n(\nself\n):\n\n    \n\u5982\u679cJSON\u5bf9\u8c61\u4e2d\u6ca1\u6709username\u6216email\uff0c\u786e\u4fdd\u629b\u51fa\u4e00\u4e2a\u9519\u8bef\u3002\n\n    \nwith\n \nself\n.\nclient\n:\n\n        \nresponse\n \n=\n \nself\n.\nclient\n.\npost\n(\n\n            \n/users\n,\n\n            \ndata\n=\njson\n.\ndumps\n(\ndict\n(\nemail\n=\nqikqiak@gmail.com\n)),\n\n            \ncontent_type\n=\napplication/json\n\n        \n)\n\n        \ndata\n \n=\n \njson\n.\nloads\n(\nresponse\n.\ndata\n.\ndecode\n())\n\n        \nself\n.\nassertEqual\n(\nresponse\n.\nstatus_code\n,\n \n400\n)\n\n        \nself\n.\nassertIn\n(\nInvalid payload\n,\n \ndata\n[\nmessage\n])\n\n        \nself\n.\nassertEqual\n(\nfail\n,\n \ndata\n[\nstatus\n])\n\n\n    \nwith\n \nself\n.\nclient\n:\n\n        \nresponse\n \n=\n \nself\n.\nclient\n.\npost\n(\n\n            \n/users\n,\n\n            \ndata\n=\njson\n.\ndumps\n(\ndict\n(\nusername\n=\ncnych\n)),\n\n            \ncontent_type\n=\napplication/json\n\n        \n)\n\n        \ndata\n \n=\n \njson\n.\nloads\n(\nresponse\n.\ndata\n.\ndecode\n())\n\n        \nself\n.\nassertEqual\n(\nresponse\n.\nstatus_code\n,\n \n400\n)\n\n        \nself\n.\nassertIn\n(\nInvalid payload\n,\n \ndata\n[\nmessage\n])\n\n        \nself\n.\nassertEqual\n(\nfail\n,\n \ndata\n[\nstatus\n])\n\n\n\ndef\n \ntest_add_user_duplicate_user\n(\nself\n):\n\n    \n\u5982\u679c\u90ae\u4ef6\u5df2\u7ecf\u5b58\u5728\u786e\u4fdd\u629b\u51fa\u4e00\u4e2a\u9519\u8bef\u3002\n\n    \nwith\n \nself\n.\nclient\n:\n\n        \nself\n.\nclient\n.\npost\n(\n\n            \n/users\n,\n\n            \ndata\n=\njson\n.\ndumps\n(\ndict\n(\n\n                \nusername\n=\ncnych\n,\n\n                \nemail\n=\nqikqiak@gmail.com\n\n            \n)),\n\n            \ncontent_type\n=\napplication/json\n\n        \n)\n\n        \nresponse\n \n=\n \nself\n.\nclient\n.\npost\n(\n\n            \n/users\n,\n\n            \ndata\n=\njson\n.\ndumps\n(\ndict\n(\n\n                \nusername\n=\ncnych\n,\n\n                \nemail\n=\nqikqiak@gmail.com\n\n            \n)),\n\n            \ncontent_type\n=\napplication/json\n\n        \n)\n\n        \ndata\n \n=\n \njson\n.\nloads\n(\nresponse\n.\ndata\n.\ndecode\n())\n\n        \nself\n.\nassertEqual\n(\nresponse\n.\nstatus_code\n,\n \n400\n)\n\n        \nself\n.\nassertIn\n(\nSorry. That email already exists.\n,\n \ndata\n[\nmessage\n])\n\n        \nself\n.\nassertEqual\n(\nfail\n,\n \ndata\n[\nstatus\n])\n\n\n\n\n\n\n\u73b0\u5728\u6211\u4eec\u652f\u6301\u6d4b\u8bd5\u547d\u4ee4\uff0c\u80af\u5b9a\u662f\u4e0d\u4f1a\u901a\u8fc7\u7684\uff0c\u56e0\u4e3a\u8fd8\u6ca1\u66f4\u65b0handler \u5462\uff1a\n\n\nfrom\n \nflask\n \nimport\n \nBlueprint\n,\n \njsonify\n,\n \nrequest\n,\n \nrender_template\n\n\nfrom\n \nsqlalchemy\n \nimport\n \nexc\n\n\nfrom\n \nproject\n \nimport\n \ndb\n\n\nfrom\n \nproject.api.models\n \nimport\n \nUser\n\n\n\n@users_blueprint.route\n(\n/users\n,\n \nmethods\n=\n[\nPOST\n])\n\n\ndef\n \nadd_user\n():\n\n    \n# \u83b7\u53d6POST\u7684\u6570\u636e\n\n    \npost_data\n \n=\n \nrequest\n.\nget_json\n()\n\n    \nif\n \nnot\n \npost_data\n:\n\n        \nresponse_data\n \n=\n \n{\n\n            \nstatus\n:\n \nfail\n,\n\n            \nmessage\n:\n \nInvalid payload.\n\n        \n}\n\n        \nreturn\n \njsonify\n(\nresponse_data\n),\n \n400\n\n    \nemail\n \n=\n \npost_data\n.\nget\n(\nemail\n)\n\n    \nusername\n \n=\n \npost_data\n.\nget\n(\nusername\n)\n\n    \ntry\n:\n\n        \nuser\n \n=\n \nUser\n.\nquery\n.\nfilter_by\n(\nemail\n=\nemail\n)\n.\nfirst\n()\n\n        \nif\n \nnot\n \nuser\n:\n\n            \n# \u8bc1\u660e\u6570\u636e\u5e93\u4e2d\u4e0d\u5b58\u5728\u8be5email\u7684\u7528\u6237\uff0c\u53ef\u4ee5\u6dfb\u52a0\n\n            \ndb\n.\nsession\n.\nadd\n(\nUser\n(\nusername\n=\nusername\n,\n \nemail\n=\nemail\n))\n\n            \ndb\n.\nsession\n.\ncommit\n()\n\n            \nresponse_data\n \n=\n \n{\n\n                \nstatus\n:\n \nsuccess\n,\n\n                \nmessage\n:\n \n%s\n was added!\n \n%\n \nemail\n\n            \n}\n\n            \nreturn\n \njsonify\n(\nresponse_data\n),\n \n201\n\n        \n# \u8bc1\u660e\u8be5email\u5df2\u7ecf\u5b58\u5728\n\n        \nresponse_data\n \n=\n \n{\n\n            \nstatus\n:\n \nfail\n,\n\n            \nmessage\n:\n \nSorry. That email already exists.\n\n        \n}\n\n        \nreturn\n \njsonify\n(\nresponse_data\n),\n \n400\n\n    \nexcept\n \nexc\n.\nIntegrityError\n \nas\n \ne\n:\n\n        \ndb\n.\nsession\n.\nrollback\n()\n  \n# \u51fa\u73b0\u5f02\u5e38\u4e86\uff0c\u56de\u6eda\n\n        \nresponse_data\n \n=\n \n{\n\n            \nstatus\n:\n \nfail\n,\n\n            \nmessage\n:\n \nInvalid payload.\n\n        \n}\n\n        \nreturn\n \njsonify\n(\nresponse_data\n),\n \n400\n\n\n\n\n\n\n\u7136\u540e\u6267\u884c\u6211\u4eec\u7684\u6d4b\u8bd5\u547d\u4ee4\uff0c\u73b0\u5728\u5c31\u80fd\u591f\u6d4b\u8bd5\u901a\u8fc7\u4e86\uff0c\u5982\u679c\u51fa\u73b0\u4e86\u95ee\u9898\u90a3\u4e48\u4f60\u5e94\u8be5\u4ed4\u7ec6\u770b\u770b\u4f60\u7684\u4ee3\u7801\u4e86~\n\n\n\u63a5\u4e0b\u6765\u5904\u7406\u53e6\u5916\u4e24\u4e2a\u8bf7\u6c42\u3002\n\n\n\u83b7\u53d6\u5355\u4e2a\u7528\u6237\u4fe1\u606f\uff0c\u8fd8\u662f\u5148\u8fdb\u884c\u6d4b\u8bd5\uff1a\n\n\nfrom\n \nproject.api.models\n \nimport\n \nUser\n\n\nfrom\n \nproject\n \nimport\n \ndb\n\n\n\ndef\n \ntest_get_user\n(\nself\n):\n\n    \nuser\n \n=\n \nUser\n(\nusername\n=\ncnych\n,\n \nemail\n=\nqikqiak@gmail.com\n)\n\n    \ndb\n.\nsession\n.\nadd\n(\nuser\n)\n\n    \ndb\n.\nsession\n.\ncommit\n()\n\n    \nwith\n \nself\n.\nclient\n:\n\n        \nresponse\n \n=\n \nself\n.\nclient\n.\nget\n(\n/users/\n%d\n \n%\n \nuser\n.\nid\n)\n\n        \ndata\n \n=\n \njson\n.\nloads\n(\nresponse\n.\ndata\n.\ndecode\n())\n\n        \nself\n.\nassertEqual\n(\nresponse\n.\nstatus_code\n,\n \n200\n)\n\n        \nself\n.\nassertTrue\n(\ncreated_at\n \nin\n \ndata\n[\ndata\n])\n\n        \nself\n.\nassertEqual\n(\ncnych\n,\n \ndata\n[\ndata\n][\nusername\n])\n\n        \nself\n.\nassertEqual\n(\nqikqiak@gmail.com\n,\n \ndata\n[\ndata\n][\nemail\n])\n\n        \nself\n.\nassertEqual\n(\nsuccess\n,\n \ndata\n[\nstatus\n])\n\n\n\n\n\n\n\u7136\u540e\u6765\u7f16\u5199\u83b7\u53d6\u5355\u4e2a\u7528\u6237\u8bf7\u6c42\u7684\u5904\u7406\u51fd\u6570\uff0c\u66f4\u65b0\nproject/api/views.py\n\u6587\u4ef6\uff1a\n\n\n@users_blueprint.route\n(\n/users/\nuser_id\n,\n \nmethods\n=\n[\nGET\n])\n\n\ndef\n \nget_user\n(\nuser_id\n):\n\n    \n\u83b7\u53d6\u67d0\u7528\u6237\u7684\u8be6\u7ec6\u4fe1\u606f\n\n    \nuser\n \n=\n \nUser\n.\nquery\n.\nfilter_by\n(\nid\n=\nuser_id\n)\n.\nfirst\n()\n\n    \nresponse_object\n \n=\n \n{\n\n        \nstatus\n:\n \nsuccess\n,\n\n        \ndata\n:\n \n{\n\n            \nusername\n:\n \nuser\n.\nusername\n,\n\n            \nemail\n:\n \nuser\n.\nemail\n,\n\n            \ncreated_at\n:\n \nuser\n.\ncreated_at\n\n        \n}\n\n    \n}\n\n    \nreturn\n \njsonify\n(\nresponse_object\n),\n \n200\n\n\n\n\n\n\n\u73b0\u5728\u6267\u884c\u6d4b\u8bd5\u547d\u4ee4\uff0c\u6d4b\u8bd5\u80fd\u591f\u901a\u8fc7\u4e86\uff0c\u90a3\u5e94\u8be5\u6709\u54ea\u4e00\u4e9b\u9519\u8bef\u5904\u7406\u7684\u573a\u666f\u5462\uff1a\n\n\n\n\n\u6ca1\u6709\u63d0\u4f9bid\n\n\nid\u4e0d\u5b58\u5728\n\n\n\n\n\u7136\u540e\u6211\u4eec\u6765\u9488\u5bf9\u4e0a\u9762\u4e24\u79cd\u573a\u666f\u6dfb\u52a0\u6d4b\u8bd5\u4ee3\u7801\uff1a\n\n\ndef\n \ntest_get_user_no_id\n(\nself\n):\n\n    \n\u5982\u679c\u6ca1\u6709id\u7684\u65f6\u5019\u629b\u51fa\u5f02\u5e38\u3002\n\n    \nwith\n \nself\n.\nclient\n:\n\n        \nresponse\n \n=\n \nself\n.\nclient\n.\nget\n(\n/users/xxx\n)\n\n        \ndata\n \n=\n \njson\n.\nloads\n(\nresponse\n.\ndata\n.\ndecode\n())\n\n        \nself\n.\nassertEqual\n(\nresponse\n.\nstatus_code\n,\n \n400\n)\n\n        \nself\n.\nassertIn\n(\nParam id error\n,\n \ndata\n[\nmessage\n])\n\n        \nself\n.\nassertEqual\n(\nfail\n,\n \ndata\n[\nstatus\n])\n\n\n\ndef\n \ntest_get_user_incorrect_id\n(\nself\n):\n\n    \n\u5982\u679cID\u4e0d\u5b58\u5728\u5219\u8981\u629b\u51fa\u5f02\u5e38\n\n    \nwith\n \nself\n.\nclient\n:\n\n        \nresponse\n \n=\n \nself\n.\nclient\n.\nget\n(\n/users/-1\n)\n\n        \ndata\n \n=\n \njson\n.\nloads\n(\nresponse\n.\ndata\n.\ndecode\n())\n\n        \nself\n.\nassertEqual\n(\nresponse\n.\nstatus_code\n,\n \n404\n)\n\n        \nself\n.\nassertIn\n(\nUser does not exist\n,\n \ndata\n[\nmessage\n])\n\n        \nself\n.\nassertEqual\n(\nfail\n,\n \ndata\n[\nstatus\n])\n\n\n\n\n\n\n\u7136\u540e\u6839\u636e\u4e0a\u9762\u6211\u4eec\u7684\u6d4b\u8bd5\u4ee3\u7801\u6765\u66f4\u65b0\nget_user\n\u51fd\u6570\uff1a\n\n\n@users_blueprint.route\n(\n/users/\nuser_id\n,\n \nmethods\n=\n[\nGET\n])\n\n\ndef\n \nget_user\n(\nuser_id\n):\n\n    \n\u83b7\u53d6\u67d0\u7528\u6237\u7684\u8be6\u7ec6\u4fe1\u606f\n\n    \nresponse_object\n \n=\n \n{\n\n        \nstatus\n:\n \nfail\n,\n\n        \nmessage\n:\n \nUser does not exist\n\n    \n}\n\n    \ncode\n \n=\n \n404\n\n    \ntry\n:\n\n        \nuser\n \n=\n \nUser\n.\nquery\n.\nfilter_by\n(\nid\n=\nint\n(\nuser_id\n))\n.\nfirst\n()\n\n        \nif\n \nuser\n:\n\n            \nresponse_object\n \n=\n \n{\n\n                \nstatus\n:\n \nsuccess\n,\n\n                \ndata\n:\n \n{\n\n                    \nusername\n:\n \nuser\n.\nusername\n,\n\n                    \nemail\n:\n \nuser\n.\nemail\n,\n\n                    \ncreated_at\n:\n \nuser\n.\ncreated_at\n\n                \n}\n\n            \n}\n\n            \ncode\n \n=\n \n200\n\n    \nexcept\n \nValueError\n:\n\n        \nresponse_object\n \n=\n \n{\n\n            \nstatus\n:\n \nfail\n,\n\n            \nmessage\n:\n \nParam id error\n\n        \n}\n\n        \ncode\n \n=\n \n400\n\n    \nfinally\n:\n\n        \nreturn\n \njsonify\n(\nresponse_object\n),\n \ncode\n\n\n\n\n\n\n\u7136\u540e\u7ee7\u7eed\u6267\u884c\u6211\u4eec\u7684\u6d4b\u8bd5\u547d\u4ee4\uff0c\u901a\u8fc7~~~\n\n\n\u7136\u540e\u662f\u83b7\u53d6\u6240\u6709\u7684\u7528\u6237\u5217\u8868\u7684\u8bf7\u6c42\uff0c\u8fd9\u8282\u5c31\u8ba9\u6211\u4eec\u7684\u8bfb\u8005\u670b\u53cb\u81ea\u5df1\u6765\u52a8\u624b\u5b9e\u8df5\u5427\uff0c\u6700\u7ec8\u4ee3\u7801\u6211\u4eec\u4f1a\u540c\u6b65\u5230\ngithub\n\u4e0a\u53bb\u7684\uff0c\u8bb0\u4f4f\u8981\u7528\nTDD\n\u7684\u601d\u60f3\uff0c\u5148\u5199\u6d4b\u8bd5\u4ee3\u7801\uff0c\u7136\u540e\u7f16\u5199\u6211\u4eec\u7684\u7f51\u7edc\u8bf7\u6c42\u51fd\u6570\uff0c\u7136\u540e\u7f16\u5199\u4e00\u4e9b\u5f02\u5e38\u573a\u666f\u4e0b\u9762\u7684\u6d4b\u8bd5\u4ee3\u7801\uff0c\u7ee7\u7eed\u589e\u5f3a\u6211\u4eec\u7684\u8bf7\u6c42\u51fd\u6570\uff0c\u518d\u6d4b\u8bd5\u3002\n\n\n\u4e0a\u9762\u7684\u6b65\u9aa4\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u8bd5\u7740\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\nhttp://127.0.0.1:5001/users\n\u63a5\u53e3\uff0c\u4e0d\u51fa\u610f\u5916\u7684\u8bdd\u6211\u4eec\u4f1a\u770b\u5230\u5982\u4e0b\u7684\njson\n\u4fe1\u606f\u8f93\u51fa\uff1a\n\n\n{\n\n    \ndata\n:\n \n{\n\n        \nusers\n:\n \n[]\n\n    \n},\n\n    \nstatus\n:\n \nsuccess\n\n\n}\n\n\n\n\n\n\n\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u7684\u6570\u636e\u5e93\u4e2d\u8fd8\u6ca1\u6709\u4efb\u4f55\u7684\u6570\u636e\uff0c\u6240\u4ee5\u80af\u5b9a\u8fd9\u91cc\u5f97\u5230\u7684\u662f\u4e00\u4e2a\u7a7a\u7684\u6570\u636e\u5217\u8868\u3002\u4e3a\u4e86\u6d4b\u8bd5\u65b9\u4fbf\uff0c\u6211\u4eec\u5728\nmanage.py\n\u6587\u4ef6\u4e2d\u589e\u52a0\u4e00\u4e2a\u547d\u4ee4\u6765\u6dfb\u52a0\u4e00\u4e9b\u6d4b\u8bd5\u6570\u636e\u5427\uff1a\n\n\nfrom\n \nproject.api.models\n \nimport\n \nUser\n\n\n@manager.command\n\n\ndef\n \nseed_db\n():\n\n    \nSeeds the database.\n\n    \ndb\n.\nsession\n.\nadd\n(\nUser\n(\nusername\n=\ncnych\n,\n \nemail\n=\nqikqiak@gmail.com\n))\n\n    \ndb\n.\nsession\n.\nadd\n(\nUser\n(\nusername\n=\nchyang\n,\n \nemail\n=\nicnych@gmail.com\n))\n\n    \ndb\n.\nsession\n.\ncommit\n()\n\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u5728\u547d\u4ee4\u884c\u4e2d\u6267\u884c\nseed_db\n\u547d\u4ee4\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose run users-service python manage.py seed_db\n\n\n\n\n\n\u6267\u884c\u6210\u529f\u540e\uff0c\u6211\u4eec\u518d\u6b21\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\u4e0a\u9762\u7684\u63a5\u53e3\uff0c\u5df2\u7ecf\u80fd\u591f\u770b\u5230\u7528\u6237\u5217\u8868\u4fe1\u606f\u4e86\u3002", 
            "title": "Flask Blueprint"
        }, 
        {
            "location": "/part1/deploy/", 
            "text": "\u4e0a\u9762\u7684\u8bfe\u7a0b\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u4e86\u6d4b\u8bd5\u548c3\u4e2a\nAPI\n\u63a5\u53e3\u7684\u5f00\u53d1\uff0c\u73b0\u5728\u6211\u4eec\u6765\u5b8c\u6210\u90e8\u7f72\u6211\u4eec\u7684\u5e94\u7528\u3002\n\n\n\u9996\u5148\u5728\u9879\u76ee\u6839\u76ee\u5f55\u65b0\u5efa\u4e00\u4e2a\ndocker-compose-prod.yml\n\u7684\u6587\u4ef6\uff0c\u5c06\ndocker-compose.yml\n\u6587\u4ef6\u7684\u5185\u5bb9\u5168\u90e8\u62f7\u8d1d\u8fc7\u6765\uff0c\u7136\u540e\u53bb\u6389\nusers-service\n\u4e0b\u9762\u7684\nvolumes\n\uff0c\u56e0\u4e3a\u8fd9\u662f\u6211\u4eec\u5728\u5f00\u53d1\u9636\u6bb5\u4fbf\u4e8e\u8c03\u8bd5\uff0c\u5c06\u4ee3\u7801\u6302\u8f7d\u5230\u5bb9\u5668\u4e2d\u7684\uff0c\u751f\u4ea7\u73af\u5883\u5c31\u9700\u8981\u8fd9\u6837\u505a\u4e86\uff0c\u7136\u540e\u5c31\u662f\u9700\u8981\u5c06\u73af\u5883\u53d8\u91cf\u66f4\u6539\u6210\u751f\u4ea7\u73af\u5883\u7684\u914d\u7f6e\uff1a\n\n\nenvironment\n:\n\n  \n-\n \nAPP_SETTINGS=project.config.ProductionConfig\n\n  \n-\n \nDATABASE_URL=mysql+pymysql://root:root321@users-db:3306/users_prod\n\n  \n-\n \nDATABASE_TEST_URL=mysql+pymysql://root:root321@users-db:3306/users_test\n\n\n\n\n\n\n\u7136\u540e\u6267\u884c\u6784\u5efa\u955c\u50cf\u3001\u521b\u5efa\u6570\u636e\u5e93\u3001\u6dfb\u52a0\u521d\u59cb\u6570\u636e\u3001\u6d4b\u8bd5\u7b49\u547d\u4ee4\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose -f docker-compose-prod.yml up -d --build\n\n(\ntdd3\n)\n$ docker-compose -f docker-compose-prod.yml run users-service python manage.py recreate_db\n\n(\ntdd3\n)\n$ docker-compose -f docker-compose-prod.yml run users-service python manage.py seed_db\n\n(\ntdd3\n)\n$ docker-compose -f docker-compose-prod.yml run users-service python manage.py \ntest\n\n\n\n\n\n\n\u6d4b\u8bd5\u9636\u6bb5\ntest_app_is_development\n\u8fd9\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u80af\u5b9a\u4e0d\u4f1a\u901a\u8fc7\u7684\uff0c\u56e0\u4e3a\u73b0\u5728\u662f\u751f\u4ea7\u73af\u5883\u4e86\u3002\n\n\n\u5728\u751f\u4ea7\u73af\u5883\u6211\u4eec\u4e00\u822c\u4f7f\u7528\nGunicorn\n\u6765\u5904\u7406\u6211\u4eec\u7684\u7f51\u7edc\u8bf7\u6c42\uff0c\u5728\nrequirements.txt\n\u6587\u4ef6\u4e2d\u6dfb\u52a0\ngunicorn==19.7.1\n\uff0c\u7136\u540e\u5b89\u88c5\u3002\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u5728\ndocker-compose=prod.yml\n\u6587\u4ef6\u4e2d\u7684\nusers-service\n\u533a\u57df\u589e\u52a0\u4e00\u6761\u547d\u4ee4\uff1a\n\n\ncommand\n:\n \ngunicorn -b 0.0.0.0:5000 manage:app\n\n\n\n\n\n\ncommand\n\u4f1a\u8986\u76d6\u4e0a\u9762\nDockerfile\n\u4e2d\u7684\nCMD\n\u547d\u4ee4\u3002\u91cd\u65b0\u6784\u5efa\u955c\u50cf\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose -f docker-compose-prod.yml up -d --build\n\n\n\n\n\n\u7531\u4e8e\u589e\u52a0\u4e86\u65b0\u7684\u4f9d\u8d56\u6587\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u91cd\u65b0\u6784\u5efa\uff0c\n--build\n\u662f\u5fc5\u987b\u7684\u3002\n\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u6765\u5b89\u88c5\nNginx\n\uff0c\u5bf9\u6211\u4eec\u7684\u7f51\u7edc\u8bf7\u6c42\u8fdb\u884c\u53cd\u5411\u4ee3\u7406\uff0c\u63d0\u9ad8\u6211\u4eec\u63a5\u53e3\u7684\u6027\u80fd\u3002\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u9762\u65b0\u5efa\u4e00\u4e2a\nnginx\n\u7684\u6587\u4ef6\u5939\uff0c\u7136\u540e\u5728\u8be5\u76ee\u5f55\u4e2d\u65b0\u589e\nDockerfile\n\u6587\u4ef6\uff1a\n\n\nFROM nginx:1.13.0\n\n\n\nRUN rm /etc/nginx/conf.d/default.conf\n\n\nADD /flask.conf /etc/nginx/conf.d\n\n\n\n\n\n\n\u7136\u540e\u5728\u5f53\u524d\u76ee\u5f55\u65b0\u5efa\u4e00\u4e2a\nflask.conf\n\u7684\u6587\u4ef6\uff1a\n\n\nserver {\n    listen 80;\n    location / {\n        proxy_pass http://users-service:5000;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n}\n\n\n\n\n\n\u4e0a\u9762\u662f\u4e00\u4e2a\u666e\u901a\u7684\nnginx\n\u914d\u7f6e\u6587\u4ef6\uff0c\u610f\u601d\u662f\u4ece80\u7aef\u53e3\u6765\u7684\u8bf7\u6c42\u90fd\u8f6c\u53d1\u5230\u540e\u7aef\u7684\nhttp://users-service:5000\n\u670d\u52a1\u4e0a\uff0c\u540e\u7aef\u7684\nusers-service\n\u670d\u52a1\u5c31\u662f\u4e0a\u9762\u6211\u4eec\u7528\ngunicorn\n\u542f\u52a8\u7684\u670d\u52a1\uff0c\u66f4\u591a\u7684\nnginx\n\u8d44\u6599\uff0c\u53ef\u4ee5\nGoogle\n\u67e5\u8be2\u3002\n\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u6211\u4eec\u7684\nnginx\n\u670d\u52a1\u6dfb\u52a0\u5230\ndocker-compose-prod.yml\n\u6587\u4ef6\u4e2d\uff1a\n\n\nnginx\n:\n\n  \ncontainer_name\n:\n \nnginx\n\n  \nbuild\n:\n \n./nginx/\n\n  \nrestart\n:\n \nalways\n\n  \nports\n:\n\n    \n-\n \n80:80\n\n  \ndepends_on\n:\n\n    \nusers-service\n:\n\n      \ncondition\n:\n \nservice_started\n\n  \nlinks\n:\n\n    \n-\n \nusers-service\n\n\n\n\n\n\n\u7136\u540e\u5c06\nusers-service\n\u533a\u57df\u4e2d\u7684\u7aef\u53e3\u66b4\u9732\u6539\u6210\u53ea\u66b4\u9732\u5bb9\u5668\u7aef\u53e3\uff0c\u56e0\u4e3a\u4e3b\u673a\u4e0d\u9700\u8981\u4f7f\u7528\u4e86\uff1a\n\n\nexpose\n:\n\n  \n-\n \n5000\n\n\n\n\n\n\n\u6700\u540e\u91cd\u65b0\u6784\u5efa\nDocker\n\u955c\u50cf\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose -f docker-compose-prod.yml up -d --build\n\n\n\n\n\n\u6784\u5efa\u6210\u529f\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u4f60\u673a\u5668\u7684IP \u6765\u8bbf\u95ee\u6211\u4eec\u7684\u670d\u52a1\u4e86\uff0c\u5982\u679c\u4f60\u6709\u57df\u540d\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u5c06\u4f60\u7684\u57df\u540d\u89e3\u6790\u5230\u4f60\u4e3b\u673a\u7684IP \u4e0a\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u6109\u5feb\u7684\u7528\u57df\u540d\u8fdb\u884c\u8bbf\u95ee\u6211\u4eec\u7684\u670d\u52a1\u4e86\uff0cDone!", 
            "title": "\u90e8\u7f72"
        }, 
        {
            "location": "/part1/jinjia/", 
            "text": "\u63a5\u4e0b\u6765\u6211\u4eec\u5b66\u4e60\u4e0b\u670d\u52a1\u7aef\u6a21\u677f\u7684\u4f7f\u7528\uff0c\u5728\nproject/api/views/py\n\u6587\u4ef6\u4e2d\u589e\u52a0\u4e00\u4e2a\u65b0\u7684\u8def\u7531\u5904\u7406\u51fd\u6570\uff1a\n\n\nfrom\n \nflask\n \nimport\n \nBlueprint\n,\n \njsonify\n,\n \nrequest\n,\n \nrender_template\n\n\n@users_blueprint.route\n(\n/\n,\n \nmethods\n=\n[\nGET\n])\n\n\ndef\n \nindex\n():\n\n    \nreturn\n \nrender_template\n(\nindex.html\n)\n\n\n\n\n\n\n\u7136\u540e\u66f4\u65b0\u4e0b\nBlueprint\n\uff0c\u589e\u52a0\u5bf9\u6a21\u677f\u7684\u914d\u7f6e\uff1a\n\n\nusers_blueprint\n \n=\n \nBlueprint\n(\nusers\n,\n \n__name__\n,\n \ntemplate_folder\n=\n./templates\n)\n\n\n\n\n\n\n\u7136\u540e\u5728\nproject/api\n\u76ee\u5f55\u4e0b\u589e\u52a0\u4e00\u4e2a\ntemplates\n\u7684\u6587\u4ef6\u5939\uff0c\u5728\u8be5\u6587\u4ef6\u5939\u4e0b\u9762\u6dfb\u52a0\u4e00\u4e2a\nindex.html\n\u7684\u6587\u4ef6\uff1a\n\n\n!DOCTYPE html\n\n\nhtml\n \nlang\n=\nen\n\n\nhead\n\n    \nmeta\n \ncharset\n=\nUTF-8\n\n    \ntitle\nFlask microservice app on Docker\n/\ntitle\n\n    \nmeta\n \nname\n=\nauthor\n \ncontent\n=\n\n    \nmeta\n \nname\n=\ndescription\n \ncontent\n=\n\n    \nmeta\n \nname\n=\nviewport\n \ncontent\n=\nwidth=device-width,initial-scale=1\n\n    \n!-- styles --\n\n    \nlink\n \nhref\n=\n//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\n \nrel\n=\nstylesheet\n\n    {% block css %}{% endblock %}\n\n/\nhead\n\n\nbody\n\n\ndiv\n \nclass\n=\ncontainer\n\n  \ndiv\n \nclass\n=\nrow\n\n    \ndiv\n \nclass\n=\ncol-md-4\n\n      \nbr\n\n      \nh1\nAll Users\n/\nh1\n\n      \nhr\nbr\n\n      \nform\n \naction\n=\n/\n \nmethod\n=\nPOST\n\n        \ndiv\n \nclass\n=\nform-group\n\n          \ninput\n \nname\n=\nusername\n \nclass\n=\nform-control input-lg\n \ntype\n=\ntext\n \nplaceholder\n=\nEnter a username\n \nrequired\n\n        \n/\ndiv\n\n        \ndiv\n \nclass\n=\nform-group\n\n          \ninput\n \nname\n=\nemail\n \nclass\n=\nform-control input-lg\n \ntype\n=\nemail\n \nplaceholder\n=\nEnter an email address\n \nrequired\n\n        \n/\ndiv\n\n        \ninput\n \ntype\n=\nsubmit\n \nclass\n=\nbtn btn-primary btn-lg btn-block\n \nvalue\n=\nSubmit\n\n      \n/\nform\n\n      \nbr\n\n      \nhr\n\n      \ndiv\n\n        {% if users %}\n          {% for user in users %}\n            \nh4\n \nclass\n=\nwell\nstrong\n{{user.username}}\n/\nstrong\n - \nem\n{{user.created_at.strftime(\n%Y-%m-%d\n)}}\n/\nem\n/\nh4\n\n          {% endfor %}\n        {% else %}\n          \np\nNo users!\n/\np\n\n        {% endif %}\n      \n/\ndiv\n\n    \n/\ndiv\n\n  \n/\ndiv\n\n\n/\ndiv\n\n\n!-- scripts --\n\n\nscript\n \nsrc\n=\nhttps://code.jquery.com/jquery-2.2.4.min.js\n/\nscript\n\n{% block js %}{% endblock %}\n\n/\nbody\n\n\n/\nhtml\n\n\n\n\n\n\n\u7136\u540e\u518d\u91cd\u65b0\u6784\u5efa\u6211\u4eec\u5f00\u53d1\u73af\u5883\u7684\u955c\u50cf\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose -f docker-compose.yml up -d --build\n\n\n\n\n\n\u6784\u5efa\u5b8c\u6210\u540e\uff0c\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\nhttp://127.0.0.1:5001\n\n\n\n\n\u600e\u4e48\u6765\u6d4b\u8bd5\u5462\uff1f\u5982\u679c\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u6ca1\u6709\u4efb\u4f55\u6570\u636e\uff1a\n\n\ndef\n \ntest_main_no_users\n(\nself\n):\n\n    \n\u6ca1\u6709\u7528\u6237\n\n    \nresponse\n \n=\n \nself\n.\nclient\n.\nget\n(\n/\n)\n\n    \nself\n.\nassertEqual\n(\nresponse\n.\nstatus_code\n,\n \n200\n)\n\n    \nself\n.\nassertIn\n(\nNo users!\n,\n \nresponse\n.\ndata\n)\n\n\n\n\n\n\n\u6dfb\u52a0\u51e0\u6761\u6d4b\u8bd5\u6570\u636e\uff0c\u83b7\u53d6\u6240\u6709\u7528\u6237\u5217\u8868\uff0c\u6dfb\u52a0\u4e00\u6761\u6d4b\u8bd5\u7528\u4f8b\uff1a\n\n\ndef\n \ntest_main_with_users\n(\nself\n):\n\n    \n\u6709\u591a\u4e2a\u7528\u6237\u7684\u573a\u666f\n\n    \nadd_user\n(\ncnych\n,\n \nicnych@gmail.com\n)\n\n    \nadd_user\n(\nqikqiak\n,\n \nqikqiak@gmail.com\n)\n\n    \nresponse\n \n=\n \nself\n.\nclient\n.\nget\n(\n/\n)\n\n    \nself\n.\nassertEqual\n(\nresponse\n.\nstatus_code\n,\n \n200\n)\n\n    \nself\n.\nassertIn\n(\nb\nAll Users\n,\n \nresponse\n.\ndata\n)\n\n    \nself\n.\nassertNotIn\n(\nb\nNo users!\n,\n \nresponse\n.\ndata\n)\n\n    \nself\n.\nassertIn\n(\nb\ncnych\n,\n \nresponse\n.\ndata\n)\n\n    \nself\n.\nassertIn\n(\nb\nqikqiak\n,\n \nresponse\n.\ndata\n)\n\n\n\n\n\n\n\u73b0\u5728\u6211\u4eec\u6267\u884c\u6d4b\u8bd5\u547d\u4ee4\uff0c\u4f1a\u6d4b\u8bd5\u4e0d\u901a\u8fc7\u7684\uff0c\u56e0\u4e3a\u8fd8\u6ca1\u6709\u5c06\u7528\u6237\u5217\u8868\u7684\u6570\u636e\u4f20\u9012\u5230\u9996\u9875\uff0c\u73b0\u5728\u6765\u66f4\u6539\nproject/api/views.py\n\u7684\nindex\n\u5904\u7406\u51fd\u6570\uff0c\u589e\u52a0\u7528\u6237\u5217\u8868\u7684\u83b7\u53d6\uff1a\n\n\n@users_blueprint.route\n(\n/\n,\n \nmethods\n=\n[\nGET\n])\n\n\ndef\n \nindex\n():\n\n    \nusers\n \n=\n \nUser\n.\nquery\n.\nall\n()\n\n    \nreturn\n \nrender_template\n(\nindex.html\n,\n \nusers\n=\nusers\n)\n\n\n\n\n\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u591f\u5c06\nusers\n\u5217\u8868\u4f20\u9012\u5230\u524d\u7aef\u9875\u9762\nindex.html\n\u4e2d\u53bb\u4e86\uff0c\u7136\u540e\u53ef\u4ee5\u901a\u8fc7\u6807\u7b7e\n{% for user in users %}\n\u5bf9\u6bcf\u4e00\u4e2a\u7528\u6237\u8fdb\u884c\u6e32\u67d3\u4e86\uff0c\u73b0\u5728\u7ee7\u7eed\u6267\u884c\u6d4b\u8bd5\u547d\u4ee4\uff0c\u901a\u8fc7~~~\n\n\n\u5728\u4e0a\u9762\u7684\u524d\u7aef\u9875\u9762\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u8fd8\u6709\u4e00\u4e2a\u8868\u5355\uff0c\u7528\u6237\u70b9\u51fb\u63d0\u4ea4\u6309\u94ae\u540e\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u7528\u6237\u5230\u6570\u636e\u5e93\u4e2d\uff0c\u5f53\u7136\u7ee7\u7eed\u6211\u4eec\u7684\u6d4b\u8bd5\u7528\u4f8b\uff1a\n\n\ndef\n \ntest_main_add_user\n(\nself\n):\n\n    \n\u524d\u7aef\u9875\u9762\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u7528\u6237\n\n    \nwith\n \nself\n.\nclient\n:\n\n        \nresponse\n \n=\n \nself\n.\nclient\n.\npost\n(\n\n            \n/\n,\n\n            \ndata\n=\ndict\n(\nusername\n=\ncnych\n,\n \nemail\n=\ncnych@gmail.com\n),\n\n            \nfollow_redirects\n=\nTrue\n\n        \n)\n\n        \nself\n.\nassertEqual\n(\nresponse\n.\nstatus_code\n,\n \n200\n)\n\n        \nself\n.\nassertIn\n(\nb\nAll Users\n,\n \nresponse\n.\ndata\n)\n\n        \nself\n.\nassertNotIn\n(\nb\nNo users!\n,\n \nresponse\n.\ndata\n)\n\n        \nself\n.\nassertIn\n(\nb\ncnych\n,\n \nresponse\n.\ndata\n)\n\n\n\n\n\n\n\u4e0a\u9762\u7684\u6d4b\u8bd5\u4ee3\u7801\u4e2d\u6211\u4eec\u770b\u5230\nself.client.post()\n\u51fd\u6570\u4e2d\u591a\u4e86\u4e00\u4e2a\nfollow_redirects=True\n\u53c2\u6570\uff0c\u8fd9\u6837\u7684\u8bdd\u80fd\u786e\u4fdd\npost\n\u64cd\u4f5c\u5b8c\u6210\u540e\u9875\u9762\u80fd\u591f\u91cd\u65b0\u5237\u65b0\uff0c\u8fd9\u6837\u7684\u8bdd\u9996\u9875\u7684\u7528\u6237\u5217\u8868\u6570\u636e\u5c31\u80fd\u91cd\u65b0\u83b7\u53d6\u6e32\u67d3\u4e86\uff0c\u73b0\u5728\u7ee7\u7eed\u6267\u884c\u6211\u4eec\u7684\u6d4b\u8bd5\u547d\u4ee4\uff0c\u4f1a\u51fa\u73b0\u4e00\u4e2a\u9519\u8bef\uff1a\n\n\n======================================================================\n\nFAIL: test_main_add_user \n(\ntest_users.TestUserService\n)\n\n\u524d\u7aef\u9875\u9762\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u7528\u6237\n----------------------------------------------------------------------\nTraceback \n(\nmost recent call last\n)\n:\n  File \n/usr/src/app/project/tests/test_users.py\n, line \n159\n, in test_main_add_user\n    self.assertEqual\n(\nresponse.status_code, \n200\n)\n\nAssertionError: \n405\n !\n=\n \n200\n\n\n----------------------------------------------------------------------\n\n\n\n\n\n\u8fd9\u662f\u56e0\u4e3a\u5728\u9996\u9875\u7684\u8def\u7531\u5904\u7406\u51fd\u6570\nindex\n\u4e2d\u8fd8\u6ca1\u6709\u5bf9\nPOST\n\u7684\u8bf7\u6c42\u8fdb\u884c\u5904\u7406\uff0c\u73b0\u5728\u6211\u4eec\u7ee7\u7eed\u6765\u66f4\u65b0\nproject/api/views.py\n\u7684\nindex\n\u5904\u7406\u51fd\u6570\uff1a\n\n\n@users_blueprint.route\n(\n/\n,\n \nmethods\n=\n[\nGET\n,\n \nPOST\n])\n\n\ndef\n \nindex\n():\n\n    \nif\n \nrequest\n.\nmethod\n \n==\n \nPOST\n:\n\n        \nusername\n \n=\n \nrequest\n.\nform\n[\nusername\n]\n\n        \nemail\n \n=\n \nrequest\n.\nform\n[\nemail\n]\n\n        \ndb\n.\nsession\n.\nadd\n(\nUser\n(\nusername\n=\nusername\n,\n \nemail\n=\nemail\n))\n\n        \ndb\n.\nsession\n.\ncommit\n()\n\n    \nusers\n \n=\n \nUser\n.\nquery\n.\norder_by\n(\nUser\n.\ncreated_at\n.\ndesc\n())\n.\nall\n()\n\n    \nreturn\n \nrender_template\n(\nindex.html\n,\n \nusers\n=\nusers\n)\n\n\n\n\n\n\n\u4e0a\u9762\u7684\u51fd\u6570\u9488\u5bf9\nPOST\n\u7684\u8bf7\u6c42\u8fdb\u884c\u4e86\u6570\u636e\u5e93\u6dfb\u52a0\u7684\u64cd\u4f5c\uff0c\u6ce8\u610f\u7528\u6237\u5217\u8868\u6211\u4eec\u589e\u52a0\u4e86\u4e00\u6761\u6839\u636e\ncreated_at\n\u8fdb\u884c\u6392\u5e8f\u7684\u89c4\u5219\u8fd8\u6709\nmethods\n\u589e\u52a0\u4e86\u4e00\u4e2a\nPOST\n\uff0c\u73b0\u5728\u518d\u6765\u6267\u884c\u6211\u4eec\u7684\u6d4b\u8bd5\u4ee3\u7801\uff0c\u901a\u8fc7~~~\n\n\n\u4e0a\u9762\u7684\u6d4b\u8bd5\u5168\u90e8\u901a\u8fc7\u8fc7\u540e\uff0c\u73b0\u5728\u6211\u4eec\u5c06\u6211\u4eec\u7684\u4ee3\u7801\u90e8\u7f72\u5230\u751f\u4ea7\u73af\u5883\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose -f docker-compose-prod.yml up -d --build\n\n\n\n\n\n\u7136\u540e\u6267\u884c\u6d4b\u8bd5\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose -f docker-compose-prod.yml -run users-service python manage.py \ntest\n\n\n\n\n\n\n\u7136\u540e\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\nhttp://127.0.0.1\n(\u56e0\u4e3a\u751f\u4ea7\u73af\u5883\u662f\u7528\nNginx\n\u505a\u8f6c\u53d1\u7684\uff0c\u6240\u4ee5\u4e0d\u7528\u52a0\u7aef\u53e3)\uff1a\n\n\n\n\u5929\u4e0b\u5927\u4e8b\uff0c\u5408\u4e45\u5fc5\u5206\uff0c\u5206\u4e45\u5fc5\u5408\n\uff0c \u4e0b\u8282\u8bfe\u6211\u4eec\u5c31\u6765\u5c06\u9879\u76ee\u8fdb\u884c\u62c6\u5206~~~\n\n\n\u6700\u540e\u8fd8\u662f\u5e7f\u544a~~~\n\n\n\u626b\u63cf\u4e0b\u9762\u7684\u4e8c\u7ef4\u7801(\u6216\u5fae\u4fe1\u641c\u7d22\niEverything\n)\u6dfb\u52a0\u6211\u5fae\u4fe1\u597d\u53cb(\u6ce8\u660epython)\uff0c\u7136\u540e\u53ef\u4ee5\u52a0\u5165\u5230\u6211\u4eec\u7684\npython\n\u8ba8\u8bba\u7fa4\u91cc\u9762\u5171\u540c\u5b66\u4e60", 
            "title": "Jinjia \u6a21\u677f"
        }, 
        {
            "location": "/part2/introduction/", 
            "text": "\u672c\u8282\u8bfe\u6211\u4eec\u5c06\u6211\u4eec\u7684\u9879\u76ee\u62c6\u5206\u62103\u4e2a\u5de5\u7a0b\uff0c\u6211\u4eec\u4e5f\u4f1a\u589e\u52a0\u4e00\u4e9b\u96c6\u6210\u6d4b\u8bd5\u6765\u786e\u4fdd\u6bcf\u4e00\u4e2a\u670d\u52a1\u90fd\u80fd\u591f\u6b63\u786e\u7684\u8fd0\u884c\uff0c\u5f15\u5165\u6301\u7eed\u96c6\u6210\u6982\u5ff5\uff0c\u6700\u540e\uff0c\u6211\u4eec\u8fd8\u5c06\u6dfb\u52a0\u4e00\u4e2a\nReactJS\n\u7684\u5ba2\u6237\u7aef\u3002\n\n\n1. \u7ed3\u6784\n\n\n\n\nflask-microservices-main\n - Docker Compose \u6587\u4ef6\u3001Nginx\u3001\u7ba1\u7406\u811a\u672c\u7b49\n\n\nflask-microservices-users\n - Flask \u5e94\u7528\n\n\nflask-microservices-client\n - \u5ba2\u6237\u7aef\n\n\n\n\n2. \u76ee\u6807\n\n\n\u672c\u8282\u8bfe\u7ed3\u675f\u540e\uff0c\u4f60\u80fd\u5b66\u4e60\u5230\uff1a\n\n\n\n\n\u7528\u4e00\u4e2a\nDocker Compose\n\u6587\u4ef6\u7ba1\u7406\u591a\u4e2a\ngit\n\u4ed3\u5e93\u7684\u670d\u52a1\n\n\n\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\u548c\u96c6\u6210\u6d4b\u8bd5\n\n\n\u6bcf\u4e2a\u670d\u52a1\u4e0d\u4f9d\u8d56\nDocker\n\u8fd0\u884c\n\n\n\u4e3a\u96c6\u6210\u6d4b\u8bd5\u914d\u7f6e\nTravis CI\n\n\n\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\nReact\n\u5e94\u7528\n\n\n\u7528\nReact\n\u7ec4\u4ef6\u6784\u5efa\u4e00\u4e2a\u5355\u9875\u9762\u5e94\u7528", 
            "title": "\u4ecb\u7ecd"
        }, 
        {
            "location": "/part2/introduction/#1", 
            "text": "flask-microservices-main  - Docker Compose \u6587\u4ef6\u3001Nginx\u3001\u7ba1\u7406\u811a\u672c\u7b49  flask-microservices-users  - Flask \u5e94\u7528  flask-microservices-client  - \u5ba2\u6237\u7aef", 
            "title": "1. \u7ed3\u6784"
        }, 
        {
            "location": "/part2/introduction/#2", 
            "text": "\u672c\u8282\u8bfe\u7ed3\u675f\u540e\uff0c\u4f60\u80fd\u5b66\u4e60\u5230\uff1a   \u7528\u4e00\u4e2a Docker Compose \u6587\u4ef6\u7ba1\u7406\u591a\u4e2a git \u4ed3\u5e93\u7684\u670d\u52a1  \u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\u548c\u96c6\u6210\u6d4b\u8bd5  \u6bcf\u4e2a\u670d\u52a1\u4e0d\u4f9d\u8d56 Docker \u8fd0\u884c  \u4e3a\u96c6\u6210\u6d4b\u8bd5\u914d\u7f6e Travis CI  \u5728\u5bb9\u5668\u4e2d\u8fd0\u884c React \u5e94\u7528  \u7528 React \u7ec4\u4ef6\u6784\u5efa\u4e00\u4e2a\u5355\u9875\u9762\u5e94\u7528", 
            "title": "2. \u76ee\u6807"
        }, 
        {
            "location": "/part2/coverage/", 
            "text": "\u4ee3\u7801\u8986\u76d6\n\u662f\u67e5\u627e\u672a\u88ab\u6d4b\u8bd5\u6267\u884c\u7684\u4ee3\u7801\u533a\u57df\u7684\u8fc7\u7a0b\u3002\u4e0d\u8fc7\u8981\u8bb0\u4f4f\u7684\u662f\u8fd9\u5e76\u4e0d\u80fd\u8bf4\u660e\u4f60\u6d4b\u8bd5\u4ee3\u7801\u7684\u6709\u6548\u6027\u3002\n\n\n\u5728\nrequirements.txt\n\u6587\u4ef6\u4e2d\u6dfb\u52a0\u4f9d\u8d56\u5305\uff1a\n\n\ncoverage==4.4.2\n\n\n\n\n\n\u7136\u540e\uff0c\u6211\u4eec\u5728\nmanage.py\n\u4e2d\u65b0\u589e\u4e00\u4e2a\u547d\u4ee4\uff1a\n\n\nimport\n \ncoverage\n\n\nCOV\n \n=\n \ncoverage\n.\ncoverage\n(\n\n    \nbranch\n=\nTrue\n,\n\n    \ninclude\n=\nproject/*\n,\n\n    \nomit\n=\n[\n\n        \nproject/tests/*\n\n    \n]\n\n\n)\n\n\nCOV\n.\nstart\n()\n\n\n\n@manager.command\n\n\ndef\n \ncov\n():\n\n    \nRuns the unit tests with coverage.\n\n    \ntests\n \n=\n \nunittest\n.\nTestLoader\n()\n.\ndiscover\n(\nproject/tests\n)\n\n    \nresult\n \n=\n \nunittest\n.\nTextTestRunner\n(\nverbosity\n=\n2\n)\n.\nrun\n(\ntests\n)\n\n    \nif\n \nresult\n.\nwasSuccessful\n():\n\n        \nCOV\n.\nstop\n()\n\n        \nCOV\n.\nsave\n()\n\n        \nprint\n(\nCoverage Summary:\n)\n\n        \nCOV\n.\nreport\n()\n\n        \nCOV\n.\nhtml_report\n()\n\n        \nCOV\n.\nerase\n()\n\n        \nreturn\n \n0\n\n    \nreturn\n \n1\n\n\n\n\n\n\n\u56e0\u4e3a\u65b0\u589e\u4e86\u4f9d\u8d56\u5305\uff0c\u6240\u4ee5\u9700\u8981\u91cd\u65b0\u6784\u5efa\u5bb9\u5668\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose -f docker-compose.yml up -d --build\n\n\n\n\n\n\u6784\u5efa\u5b8c\u6210\u540e\u6267\u884c\u4ee3\u7801\u8986\u76d6\u547d\u4ee4\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose -f docker-compose.yml run users-service python manage.py cov\n\n\n\n\n\n\u7136\u540e\u4f60\u80fd\u770b\u5230\u6d4b\u8bd5\u4e0b\u9762\u7684\u4fe1\u606f\uff1a\n\n\nCoverage Summary:\nName                    Stmts   Miss Branch BrPart  Cover\n---------------------------------------------------------\nproject/__init__.py        \n12\n      \n5\n      \n0\n      \n0\n    \n58\n%\nproject/api/models.py      \n13\n     \n10\n      \n0\n      \n0\n    \n23\n%\nproject/api/views.py       \n55\n      \n0\n     \n10\n      \n0\n   \n100\n%\nproject/config.py          \n16\n      \n0\n      \n0\n      \n0\n   \n100\n%\n---------------------------------------------------------\nTOTAL                      \n96\n     \n15\n     \n10\n      \n0\n    \n86\n%\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u9879\u76ee\u6839\u76ee\u5f55\u4e2d\u591a\u4e86\u4e00\u4e2a\nhtmlcov\n\u7684\u6587\u4ef6\u5939\uff0c\u8be5\u76ee\u5f55\u4e0b\u9762\u662f\u81ea\u52a8\u751f\u6210\u7684\u4ee3\u7801\u8986\u76d6\u7684\u7ed3\u679c\u9875\u9762\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\nhtmlcov/index.html\n\uff0c\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u9875\u9762\uff1a\n\n\n\u53e6\u5916\u8981\u8bb0\u5f97\u5c06\nhtmlcov\n\u6587\u4ef6\u5939\u6dfb\u52a0\u5230\n.gitignore\n\u6587\u4ef6\u4e2d~", 
            "title": "\u4ee3\u7801\u8986\u76d6"
        }, 
        {
            "location": "/part2/lint/", 
            "text": "Liniting\n\u662f\u4e00\u4e2a\u68c0\u67e5\u4f60\u4ee3\u7801\u98ce\u683c\u548c\u7f16\u7801\u9519\u8bef\u7684\u4e00\u4e2a\u8fc7\u7a0b\uff0c\u5bf9\u4e8e\npython\n\u4e2d\u6709\u5f88\u591a\u6d41\u884c\u7684\nlinting\n\u5de5\u5177\uff0c\u6211\u4eec\u8fd9\u91cc\u4f7f\u7528\nFlake8\n - \u878d\u5408\u4e86\npep8\n\u548c\npyflakes\n\u4e24\u79cd\nlinting\n\u5de5\u5177\u3002\n\n\n\u9996\u5148\uff0c\u5728\nrequrements.txt\n\u6587\u4ef6\u4e2d\u6dfb\u52a0\nflake8\n\u4f9d\u8d56\u5305\uff1a\n\n\nflake8==3.5.0\n\n\n\n\n\n\u540c\u6837\u7684\uff0c\u91cd\u65b0\u6784\u5efa\u5bb9\u5668\uff1a\n\n\n(\ntdd3\n)\n$ docker-compose -f docker-compose.yml up -d --build\n\n\n\n\n\n\u6784\u5efa\u6210\u529f\u540e\u8fd0\u884c\nflake8\n\u547d\u4ee4\u68c0\u6d4b\u4ee3\u7801\uff1a\n\n\n(\ntdd3\n)\n$ $ docker-compose -f docker-compose.yml run users-service flake8 project\nStarting users-db ... \ndone\n\nproject/__init__.py:2:1: F401 \nflask.jsonify\n imported but unused\nproject/tests/test_users.py:28:80: E501 line too long \n(\n83\n \n \n79\n characters\n)\n\n\n\n\n\n\n\u53ef\u4ee5\u770b\u5230\u68c0\u6d4b\u51fa\u4e24\u6761\u4fe1\u606f\uff0c\u4e00\u6761\u662f\nflask.jsonify\n\u6ca1\u6709\u4f7f\u7528\uff0c\u53e6\u5916\u4e00\u6761\u662f\u4e00\u884c\u8bed\u53e5\u592a\u957f\uff0c\u6211\u4eec\u5148\u53bb\u4fee\u590d\u4e00\u4e0b\uff0c\u7136\u540e\u91cd\u65b0\u6267\u884c\u4ee3\u7801\u68c0\u6d4b\uff0c\u76f4\u5230\u6ca1\u6709\u9519\u8bef\u4fe1\u606f\uff0c\u7136\u540e\u91cd\u65b0\u63d0\u4ea4\u4ee3\u7801\u3002", 
            "title": "\u4ee3\u7801\u8d28\u91cf"
        }, 
        {
            "location": "/part2/ci/", 
            "text": "\u6301\u7eed\u96c6\u6210\u7684\u76ee\u7684\uff0c\u662f\u8ba9\u4ea7\u54c1\u53ef\u4ee5\u5feb\u901f\u8fed\u4ee3\uff0c\u540c\u65f6\u8fd8\u80fd\u4fdd\u6301\u9ad8\u8d28\u91cf\u3002\u5b83\u7684\u6838\u5fc3\u63aa\u65bd\u662f\uff0c\u4ee3\u7801\u96c6\u6210\u5230\u4e3b\u5e72\u4e4b\u524d\uff0c\u5fc5\u987b\u901a\u8fc7\u81ea\u52a8\u5316\u6d4b\u8bd5\u3002\u53ea\u8981\u6709\u4e00\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u5931\u8d25\uff0c\u5c31\u4e0d\u80fd\u96c6\u6210\u3002\u7531\u4e8e\u6211\u4eec\u7684\u4ee3\u7801\u6258\u7ba1\u5728\ngithub\n\u4e0a\u9762\uff0c\u6240\u4ee5\u9009\u62e9\nTravis CI\n\u6765\u505a\u6301\u7eed\u96c6\u6210\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\u3002\n\n\n\u8981\u89e6\u53d1\u6784\u5efa\u5de5\u4f5c\uff0c\u9700\u8981\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u9762\u6dfb\u52a0\u4e00\u4e2a\n.travis.yml\n\u7684\u6587\u4ef6\uff1a\n\n\nsudo\n:\n \nrequired\n\n\n\nservices\n:\n\n  \n-\n \ndocker\n\n\n\nenv\n:\n\n  \nDOCKER_COMPOSE_VERSION\n:\n \n1.14.0\n\n\n\nbefore_install\n:\n\n  \n-\n \nsudo rm /usr/local/bin/docker-compose\n\n  \n-\n \ncurl -L https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-`uname -s`-`uname -m` \n docker-compose\n\n  \n-\n \nchmod +x docker-compose\n\n  \n-\n \nsudo mv docker-compose /usr/local/bin\n\n\n\nbefore_script\n:\n\n  \n-\n \ndocker-compose -f docker-compose.yml up --build -d\n\n\n\nscript\n:\n\n  \n-\n \ndocker-compose -f docker-compose.yml run users-service python manage.py test\n\n  \n-\n \ndocker-compose -f docker-compose.yml run users-service flake8 project\n\n\n\nafter_script\n:\n\n  \n-\n \ndocker-compose -f docker-compose.yml down\n\n\n\n\n\n\n\u4e0a\u9762\u7684\u811a\u672c\u6587\u4ef6\u770b\u4e0a\u53bb\u8fd8\u662f\u5f88\u5bb9\u6613\u7684\uff0c\u9996\u5148\u5b89\u88c5\ndocker-compose\n\uff0c\u7136\u540e\u5728\u6267\u884c\u811a\u672c\u4e4b\u524d\u6784\u5efa\u955c\u50cf\uff0c\u7136\u540e\u6267\u884c\u6d4b\u8bd5\u3001\u4ee3\u7801\u8d28\u91cf\u68c0\u6d4b\u7b49\u64cd\u4f5c\uff0c\u6700\u540e\u505a\u4e00\u4e9b\u6e05\u7406\u5de5\u4f5c\u3002\n\n\n\u7136\u540e\u6211\u4eec\u767b\u5f55\nTravis CI\n\uff0c\u5728\u4e2a\u4eba\u9875\u9762\uff0c\u786e\u4fdd\u5c06\u5f53\u524d\u9879\u76ee\u6fc0\u6d3b\n\n\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u63d0\u4ea4\u4ee3\u7801\uff0c\u63a8\u9001\u5230\nGitHub\n\u4e0a\uff0c\u8fd9\u5e94\u8be5\u4f1a\u89e6\u53d1\u4e00\u6b21\u6784\u5efa\u3002\u7136\u540e\u6211\u4eec\u540c\u6837\u7684\u53ef\u4ee5\u524d\u5f80\nTravis CI\n\u67e5\u770b\u6784\u5efa\u72b6\u6001\uff1a\n\n\n\n\u901a\u8fc7\u540e\uff0c\u4f60\u6700\u597d\u80fd\u591f\u6dfb\u52a0\u4e00\u4e2a\nTravis\n\u7684\u72b6\u6001\u5fbd\u7ae0\u5728\nREADME.md\n\u6587\u4ef6\u4e2d\uff0c\u8fd9\u6837\u80fd\u8ba9\u522b\u4eba\u660e\u767d\u4f60\u7684\u9879\u76ee\u72b6\u6001\u3002\n\n\n[![Build Status](https://travis-ci.org/cnych/flask-microservices-users.svg?branch=master)](https://travis-ci.org/cnych/flask-microservices-users)\n\n\n\n\n\n\u5c31\u76ee\u524d\u6765\u8bf4\uff0c\u867d\u7136\u6211\u4eec\u7684\u9879\u76ee\u8fd8\u76f8\u5bf9\u6bd4\u8f83\u7b80\u5355\uff0c\u4f46\u662f\u57fa\u672c\u4e0a\u6211\u4eec\u7684\u5de5\u4f5c\u6d41\u5df2\u7ecf\u80fd\u591f\u8dd1\u5f97\u975e\u5e38\u987a\u7545\u4e86\uff1a\n\n\n\n\n\u672c\u5730\u7f16\u7801\n\n\n\u63d0\u4ea4\u63a8\u9001\u5230\nGitHub\n\n\n\u901a\u8fc7\nTravis\n\u6765\u5b8c\u6210\u81ea\u52a8\u5316\u6d4b\u8bd5", 
            "title": "\u6301\u7eed\u96c6\u6210"
        }, 
        {
            "location": "/part2/react/", 
            "text": "React\n\u662f\u4e00\u4e2a\u58f0\u660e\u5f0f\u3001\u57fa\u4e8e\u7ec4\u4ef6\u7684\njavascript\n\u5e93\uff0c\u53ef\u4ee5\u975e\u5e38\u8f7b\u677e\u5730\u521b\u5efa\u7528\u6237\u4ea4\u4e92\u754c\u9762\u3002\u4e3a\u4f60\u5e94\u7528\u7684\u6bcf\u4e00\u4e2a\u72b6\u6001\u8bbe\u8ba1\u7b80\u6d01\u7684\u89c6\u56fe\uff0c\u5728\u6570\u636e\u6539\u53d8\u65f6\nReact\n\u4e5f\u53ef\u4ee5\u9ad8\u6548\u5730\u66f4\u65b0\u6e32\u67d3\u754c\u9762\u3002\n\n\n\u5982\u679c\u4f60\u8fd8\u6ca1\u63a5\u89e6\u8fc7\nReact\n\u7684\u8bdd\uff0c\u5efa\u8bae\u4f60\u5148\u9605\u8bfb\nWhy did we build React?\n\u548c\nReact \u5feb\u901f\u5165\u95e8\n\u4e24\u7bc7\u6587\u7ae0\uff0c\u5f53\u7136\u6211\u4e5f\u5efa\u8bae\u4f60\u80fd\u5b66\u5b66\nBabel\n\u548c\nWebpack\n\u7684\u76f8\u5173\u77e5\u8bc6\uff0c\u8fd9\u4e9b\u77e5\u8bc6\u70b9\u7ed3\u5408\u5728\u4e00\u8d77\u53ef\u4ee5\u975e\u5e38\u5b8c\u7f8e\u7684\u5e2e\u52a9\u4f60\u8fdb\u884c\nReact\n\u5e94\u7528\u7684\u5f00\u53d1\u3002\n\n\n\u9996\u5148\u786e\u4fdd\u4f60\u7684\u7cfb\u7edf\u4e2d\u5df2\u7ecf\u5b89\u88c5\u4e86\nNode\n\u548c\nNPM\n\uff1a\n\n\n$ tdd100  node -v\nv8.5.0\n$ tdd100  npm -v\n\n5\n.4.2\n\n\n\n\n\n\u5982\u679c\u4f60\u6ca1\u5b89\u88c5\u7684\u8bdd\uff0c\u6839\u636e\u4e0a\u9762\u4e24\u4e2a\u8fde\u63a5\u4f60\u4e5f\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u7684\u5b89\u88c5\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8be6\u7ec6\u8bf4\u660e\u4e86\u3002\n\n\n\u521d\u59cb\u5316\u9879\u76ee\n\n\n\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u975e\u5e38\u725b\u903c\u7684\u521b\u5efa\nReact\n\u9879\u76ee\u7684\u811a\u624b\u67b6\u5de5\u5177\uff1a\nCreate React App\n\u3002\n\u9996\u5148\u6211\u4eec\u5b89\u88c5\nCreate React App\n\u5de5\u5177\u5230\u5168\u5c40\u73af\u5883\u4e2d\uff1a\n\n\n$ npm install create-react-app --global\n\n\n\n\n\n\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u5728\u6211\u4eec\u7684\nflask-microservices-users\n\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u9762\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u5939\uff1a\nclient\n\uff0c\u7136\u540e\u521d\u59cb\u5316\u6211\u4eec\u7684\u9879\u76ee\u7ed3\u6784\uff1a\n\n\n$ mkdir client \n \ncd\n client\n$ create-react-app .\n\n\n\n\n\n\u9879\u76ee\u7ed3\u6784\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u76f8\u5173\u7684\u4f9d\u8d56\u5305\u4e5f\u5df2\u7ecf\u5b89\u88c5\u597d\uff0c\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u542f\u52a8\u670d\u52a1\uff1a\n\n\n$ npm start\n\n\n\n\n\n\u670d\u52a1\u542f\u52a8\u5b8c\u6210\u540e\uff0c\nCreate React App\n\u5de5\u5177\u4f1a\u81ea\u52a8\u7528\u9ed8\u8ba4\u7684\u6d4f\u89c8\u5668\u6253\u5f00\uff1a\nhttp://localhost:3000\n\u3002\n\n\n\n\u786e\u4fdd\u4e0a\u9762\u8fd9\u4e9b\u90fd\u6b63\u5e38\u540e\uff0c\u5173\u6389\u670d\u52a1(Crtl + C)\uff0c\u4e3a\u4e86\u7b80\u5316\u6211\u4eec\u7684\u5f00\u53d1\u8fc7\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u77e5\nnpm\n\u4e0d\u8981\u4e3a\u9879\u76ee\u521b\u5efa\npackage-lock.json\n\u6587\u4ef6\uff1a\n\n\n$ \necho\n \npackage-lock=false\n \n .npmrc\n\n\n\n\n\n\n\n\u53ef\u4ee5\u901a\u8fc7\u6587\u6863\nnpm docs\n\u67e5\u770b\u5173\u4e8e\u914d\u7f6e\u6587\u4ef6\n.npmrc\n\u7684\u66f4\u591a\u4fe1\u606f\u3002\n\n\n\u5bf9\npackage-lock.json\n\u6587\u4ef6\u4e0d\u592a\u6e05\u695a\u7684\uff0c\u53ef\u4ee5\u67e5\u770b\u8fd9\u7bc7\u6587\u7ae0:\nUnderstanding lock files in NPM 5\n\u8fdb\u884c\u4e86\u89e3\u3002\n\n\n\n\n\u73b0\u5728\u6765\u5f00\u59cb\u521b\u5efa\u521b\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u7ec4\u4ef6\u5427~~~\n\n\n\u7b2c\u4e00\u4e2a\u7ec4\u4ef6\n\n\n\u4e3a\u4e86\u8ba9\u6211\u4eec\u7684\u9879\u76ee\u7ed3\u6784\u770b\u8d77\u6765\u66f4\u52a0\u7b80\u5355\uff0c\u6211\u4eec\u79fb\u9664\nsrc\n\u76ee\u5f55\u4e0b\u9762\u7684\nApp.css\n\uff0c\nApp.js\n\uff0c\nApp.test.js\n\u4ee5\u53ca\nindex.css\n\u6587\u4ef6\uff0c\u7136\u540e\u66f4\u65b0\nindex.js\n\u6587\u4ef6\uff1a\n\n\nimport\n \nReact\n \nfrom\n \nreact\n;\n\n\nimport\n \nReactDOM\n \nfrom\n \nreact-dom\n;\n\n\n\nconst\n \nApp\n \n=\n \n()\n \n=\n \n{\n\n    \nreturn\n \n(\n\n      \ndiv\n \nclassName\n=\ncontainer\n\n        \ndiv\n \nclassName\n=\nrow\n\n          \ndiv\n \nclassName\n=\ncol-md-4\n\n            \nbr\n \n/\n\n            \nh1\nAll\n \nUsers\n/h1\n\n            \nhr\n \n/\nbr\n \n/\n\n          \n/div\n\n        \n/div\n\n      \n/div\n\n    \n)\n\n\n};\n\n\n\nReactDOM\n.\nrender\n(\n\n  \nApp\n \n/\n,\n\n  \ndocument\n.\ngetElementById\n(\nroot\n)\n\n\n);\n\n\n\n\n\n\n\u4e0a\u9762\u4ee3\u7801\u505a\u4e86\u51e0\u4ef6\u4e8b\uff1a\n\n\n\n\n\u5bfc\u5165\nReact\n\u548c\nReactDom\n\u7c7b\u540e\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u53eb\nApp\n\u7684\u51fd\u6570\uff0c\u8fd9\u662f\nES6\n\u91cc\u9762\u7684\u7bad\u5934\u51fd\u6570\u7684\u5199\u6cd5\uff0c\u7136\u540e\u8be5\u51fd\u6570\u8fd4\u56de\u7684\u662f\u4e00\u4e2a\nJSX\n\u683c\u5f0f\u7684\u5bf9\u8c61\u3002\n\n\n\u6211\u4eec\u7528\nReactDOM\n\u7684\nrender\n\u65b9\u6cd5\u5c06\u6211\u4eec\u7684\nApp\n\u7ec4\u4ef6\u6302\u8f7d\u5230\u4e86\u4e00\u4e2aID\u4e3a\nroot\n\u7684\nHTML\n\u5143\u7d20\u4e0a\u3002\n\n\n\n\n\n\n\u6ce8\u610f\npublic\n\u76ee\u5f55\u4e0b\u9762\u7684\nindex.html\n\u6587\u4ef6\u7684\ndiv id=\"root\"\n/div\n\uff0c\u8fd9\u5c31\u662f\u88ab\u6302\u8f7d\u7684\u5730\u65b9\u3002\u53e6\u5916\u5bf9\u4e8e\u8fd8\u4e0d\u592a\u4e86\u89e3\nES6\n\u7684\u540c\u5b66\uff0c\u4e0d\u7528\u62c5\u5fc3\uff0c\u5b9e\u9645\u4e0a\u662f\u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7\njavascript\n\u7684\u8bed\u6cd5\uff0c\u76f4\u63a5\u5b66\u4e60\nES6\n\u7684(\u867d\u7136\u4e0d\u592a\u63a8\u8350\u8fd9\u6837)\uff0c\nES6\n\u6bd4\u539f\u751f\u7684\njavascript\n\u66f4\u52a0\u7cfb\u7edf\u3001\u66f4\u52a0\u5bb9\u6613\u5b66\u4e60\u3001\u4e5f\u66f4\u52a0\u63a5\u8fd1\u4f60\u6240\u5b66\u4e60\u8fc7\u7684\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00(\n\u70b9\u51fb\u8fd9\u91cc\u524d\u53bb\u5b66\u4e60\u5427\n)\n\n\n\n\n\u7136\u540e\u5728\npublic\n\u76ee\u5f55\u4e0b\u7684\nindex.html\n\u6587\u4ef6\u7684\nhead\n\u533a\u57df\u6dfb\u52a0\nbootstrap\n\u7684\ncss\n\u6837\u5f0f\u6587\u4ef6\uff1a\n\n\nlink\n \nrel\n=\nstylesheet\n \nhref\n=\nhttps://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css\n\n\n\n\n\n\n\u57fa\u4e8e\u7c7b\u7684\u7ec4\u4ef6\n\n\n\u73b0\u5728\u6211\u4eec\u6765\u5c06\u6211\u4eec\u7684\nApp\n\u7ec4\u4ef6\u66f4\u6539\u6210\u57fa\u4e8e\u7c7b\u7684\u5f62\u5f0f\uff1a\n\n\nimport\n \nReact\n,\n \n{\nComponent\n}\n \nfrom\n \nreact\n;\n\n\nimport\n \nReactDOM\n \nfrom\n \nreact-dom\n;\n\n\n\nclass\n \nApp\n \nextends\n \nComponent\n \n{\n\n    \nconstructor\n()\n \n{\n\n        \nsuper\n();\n\n    \n}\n\n    \nrender\n()\n \n{\n\n        \nreturn\n \n(\n\n          \ndiv\n \nclassName\n=\ncontainer\n\n            \ndiv\n \nclassName\n=\nrow\n\n              \ndiv\n \nclassName\n=\ncol-md-4\n\n                \nbr\n \n/\n\n                \nh1\nAll\n \nUsers\n/h1\n\n                \nhr\n \n/\nbr\n \n/\n\n              \n/div\n\n            \n/div\n\n          \n/div\n\n        \n)\n\n    \n}\n\n\n}\n\n\n\nReactDOM\n.\nrender\n(\n\n  \nApp\n \n/\n,\n\n  \ndocument\n.\ngetElementById\n(\nroot\n)\n\n\n);\n\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u6267\u884c\nnpm start\n\u53ef\u4ee5\u53d1\u73b0\u5176\u5b9e\u4e0a\u9762\u7684\u57fa\u4e8e\u7c7b\u7684\u7ec4\u4ef6\u548c\u524d\u9762\u7684\u51fd\u6570\u7ec4\u4ef6\uff0c\u6700\u540e\u7684\u8f93\u51fa\u90fd\u662f\u4e00\u6a21\u4e00\u6837\u7684\uff0c\u6211\u4eec\u5728\u540e\u9762\u4f1a\u6162\u6162\u53d1\u73b0\u4e8c\u8005\u4e4b\u95f4\u7684\u533a\u522b\u7684\u3002\n\n\nAJAX\u8bf7\u6c42\n\n\n\u4e3a\u4e86\u8fde\u63a5\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u6570\u636e\uff0c\u6211\u4eec\u5728\nApp\n\u7c7b\u4e2d\u589e\u52a0\u4e00\u4e2a\ngetUsers()\n\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u7528\u4e00\u4e2a\u975e\u5e38\u6d41\u884c\u7684\u5e93\uff1a\nAxios\n\u6765\u8fdb\u884c\u7f51\u7edc\u8bf7\u6c42\uff1a\n\u9996\u5148\u5148\u5b89\u88c5\naxios\n\u5305\uff1a\n\n\n$ npm install axios --save\n\n\n\n\n\n\u7136\u540e\u5728\nApp\n\u7c7b\u4e2d\u6dfb\u52a0\ngetUsers\n\u51fd\u6570\uff1a\n\n\nimport\n \nReact\n,\n \n{\nComponent\n}\n \nfrom\n \nreact\n;\n\n\nimport\n \nReactDOM\n \nfrom\n \nreact-dom\n;\n\n\nimport\n \naxios\n \nfrom\n \naxios\n;\n\n\n\nclass\n \nApp\n \nextends\n \nComponent\n \n{\n\n    \nconstructor\n()\n \n{\n\n        \nsuper\n();\n\n    \n}\n\n    \ngetUsers\n()\n \n{\n\n      \naxios\n.\nget\n(\n`\n${\nprocess\n.\nenv\n.\nREACT_APP_USERS_SERVICE_URL\n}\n/users`\n).\nthen\n(\nres\n \n=\n \n{\n\n        \nconsole\n.\nlog\n(\nres\n);\n\n      \n}).\ncatch\n(\nerr\n \n=\n \n{\n\n        \nconsole\n.\nlog\n(\nerr\n);\n\n      \n});\n\n    \n}\n\n    \nrender\n()\n \n{\n\n        \nreturn\n \n(\n\n          \ndiv\n \nclassName\n=\ncontainer\n\n            \ndiv\n \nclassName\n=\nrow\n\n              \ndiv\n \nclassName\n=\ncol-md-4\n\n                \nbr\n \n/\n\n                \nh1\nAll\n \nUsers\n/h1\n\n                \nhr\n \n/\nbr\n \n/\n\n              \n/div\n\n            \n/div\n\n          \n/div\n\n        \n)\n\n    \n}\n\n\n}\n\n\n\nReactDOM\n.\nrender\n(\n\n  \nApp\n \n/\n,\n\n  \ndocument\n.\ngetElementById\n(\nroot\n)\n\n\n);\n\n\n\n\n\n\n\u5f53\u7136\u4e0d\u8981\u5fd8\u8bb0\u5728\u9876\u90e8\u5bfc\u5165\naxios\n\u5305\u54e6~\n\n\n\u4e3a\u4e86\u9a8c\u8bc1\u4e0a\u9762\u7684\u529f\u80fd\uff0c\u6211\u4eec\u8981\u5148\u5f00\u542f\u6211\u4eec\u7684\u670d\u52a1\u7aef\uff0c\u6253\u5f00\u4e00\u4e2a\u65b0\u7684\u7ec8\u7aef\u7a97\u53e3\uff0c\u7136\u540e\u5b9a\u4f4d\u5230\nflask-microservices-users\n\u9879\u76ee\u6839\u76ee\u5f55\uff0c\u8fd8\u8bb0\u5f97\u524d\u9762\u7684\u542f\u52a8\ndocker-compose\n\u7684\u547d\u4ee4\u5417\uff1f\n\n\n$ docker-compose -f docker-compose.yml up -d\n\n\n\n\n\n\u4e3a\u4e86\u786e\u4fdd\u6211\u4eec\u670d\u52a1\u7aef\u7684\u4ee3\u7801\u662f\u6b63\u5e38\u5de5\u4f5c\u7684\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u6267\u884c\u4e0b\u6211\u4eec\u7684\u6d4b\u8bd5\u547d\u4ee4\uff1a\n\n\n$ docker-compose -f docker-compose.yml run users-service python manage.py \ntest\n\n\n\n\n\n\n\u6d4b\u8bd5\u901a\u8fc7\u540e\uff0c\u6211\u4eec\u56de\u5230\nReact\n\u9879\u76ee\uff0c\u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\u53ef\u4ee5\u770b\u51fa\u6211\u4eec\u9700\u8981\u589e\u52a0\u4e00\u4e2a\nprocess.env.REACT_APP_USERS_SERVICE_URL\n\u7684\u73af\u5883\u53d8\u91cf\uff0c\u9996\u5148\u6740\u6389\nReact\n\u7684\u670d\u52a1(Ctrl + C)\uff0c\u7136\u540e\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff1a\n\n\n$ \nexport\n \nREACT_APP_USERS_SERVICE_URL\n=\nhttp://127.0.0.1:5001\n\n\n\n\n\n\n\n\u6ce8\u610f\u6240\u6709\u7684\u81ea\u5b9a\u4e49\u7684\u73af\u5883\u53d8\u91cf\u5fc5\u987b\u8981\u5df2\nREACT_APP_\n\u5f00\u5934\uff0c\u66f4\u591a\u4fe1\u606f\u53ef\u4ee5\u67e5\u770b\n\u5b98\u65b9\u6587\u6863\n\n\n\n\n\u73b0\u5728\u4e3a\u4e86\u9a8c\u8bc1\ngetUsers()\n\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6784\u9020\u51fd\u6570\nconstructor()\n\u4e2d\u5148\u8c03\u7528\uff1a\n\n\nconstructor\n()\n \n{\n\n  \nsuper\n();\n\n  \nthis\n.\ngetUsers\n();\n\n\n}\n\n\n\n\n\n\n\u8fd9\u6837\u5f53\u6211\u4eec\u7684\nApp\n\u7ec4\u4ef6\u88ab\u5b9e\u4f8b\u5316\u7684\u65f6\u5019\u5c31\u4f1a\u8c03\u7528\ngetUsers()\n\u65b9\u6cd5\u4e86\u3002\u6211\u4eec\u6765\u8fd0\u884c\u547d\u4ee4\uff1a\nnpm start\n\u6253\u5f00\u6211\u4eec\u7684\nReact\n\u5e94\u7528\uff0c\u7136\u540e\u6253\u5f00\nChrome \u5f00\u53d1\u8005\u5de5\u5177\n(\u5f3a\u70c8\u63a8\u8350\u628a\nchrome\n\u6d4f\u89c8\u5668\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u6d4f\u89c8\u5668\uff0c\u8fd9\u8d27\u5bf9\u4e8e\u524d\u7aef\u5f00\u53d1\u8005\u6765\u8bf4\u771f\u7684\u662f\u795e\u5668\uff0c\u5728\u9875\u9762\u53f3\u952e\u9009\u62e9\u5ba1\u67e5\u5143\u7d20\u5373\u53ef\u6253\u5f00)\uff0c\u7136\u540e\u6253\u5f00\nJavaScript Console\n\u63a7\u5236\u53f0\uff0c\u4f60\u5c06\u80fd\u770b\u5230\u4e0b\u9762\u7684\u9519\u8bef\u4fe1\u606f\uff1a\n\n\n\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u6211\u4eec\u6b63\u5728\u53d1\u8d77\u4e00\u4e2a\n\u8de8\u57df\n\u7684\nAJAX\n\u8bf7\u6c42(\u4ece\nhttp://localhost:3000\n\u5230\nhttp://127.0.0.1:5001\n)\uff0c\u8fd9\u662f\u8fdd\u53cd\u6d4f\u89c8\u5668\u7684\n\u540c\u6e90\u7b56\u7565\n\u7684\uff0c\u6240\u4ee5\u8be5\u8bf7\u6c42\u88ab\u62d2\u7edd\u4e86\u3002\u5e78\u8fd0\u7684\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\nFlask-CORS\n\u6269\u5c55\u5728\u670d\u52a1\u7aef\u6765\u5904\u7406\u8de8\u57df\u7684\u8bf7\u6c42\u3002\n\n\n\u56de\u5230\nflaks-users-service\n\u7684\u76ee\u5f55\uff0c\u589e\u52a0\nFlask-CORS\n\u5305\u5728\nrequirements.txt\n\u6587\u4ef6\u4e2d\uff1a\n\n\nflask-cors==3.0.3\n\n\n\n\n\n\u4e3a\u65b9\u4fbf\u6211\u4eec\u5f00\u53d1\u8c03\u8bd5\uff0c\u6211\u4eec\u8bbe\u7f6e\u6240\u6709\u7684\u8bf7\u6c42\u90fd\u8fd0\u884c\u8de8\u57df\u64cd\u4f5c(\u5207\u8bb0\uff0c\u751f\u4ea7\u73af\u5883\u7edd\u5bf9\u4e0d\u80fd\u8fd9\u6837\u505a)\uff0c\u66f4\u65b0\nflaks-users-service/project/__init__.py\n\u6587\u4ef6\u7684\ncreate_app()\n\u65b9\u6cd5\uff1a\n\n\nfrom\n \nflask_cors\n \nimport\n \nCORS\n\n\ndef\n \ncreate_app\n():\n\n    \n# \u521d\u59cb\u5316\u5e94\u7528\n\n    \napp\n \n=\n \nFlask\n(\n__name__\n)\n\n\n    \n# \u8fd0\u884c\u8de8\u57df\n\n    \nCORS\n(\napp\n)\n\n\n    \n# \u73af\u5883\u914d\u7f6e\n\n    \napp_settings\n \n=\n \nos\n.\ngetenv\n(\nAPP_SETTINGS\n)\n\n    \napp\n.\nconfig\n.\nfrom_object\n(\napp_settings\n)\n\n    \n# \u5b89\u88c5\u6269\u5c55\n\n    \ndb\n.\ninit_app\n(\napp\n)\n\n    \n# \u6ce8\u518cblueprint\n\n    \nfrom\n \nproject.api.views\n \nimport\n \nusers_blueprint\n\n    \napp\n.\nregister_blueprint\n(\nusers_blueprint\n)\n\n    \nreturn\n \napp\n\n\n\n\n\n\n\u4e0d\u8981\u5fd8\u8bb0\u5728\u6587\u4ef6\u7684\u9876\u90e8\u5bfc\u5165\nflask_cors\n\u5305\uff1a\n\n\nfrom\n \nflask_cors\n \nimport\n \nCORS\n\n\n\n\n\n\n\u7531\u4e8e\u6211\u4eec\u65b0\u589e\u4e86\u4f9d\u8d56\u5305\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u91cd\u65b0\u6784\u5efa\u6211\u4eec\u7684\u955c\u50cf\uff1a\n\n\n$ docker-compose -f docker-compose.yml up -d --build\n\n\n\n\n\n\u7136\u540e\u66f4\u65b0\u3001\u521d\u59cb\u5316\u6570\u636e\u5e93\uff1a\n\n\n$ docker-compose -f docker-compose.yml run users-service python manage.py recreate_db\n$ docker-compose -f docker-compose.yml run users-service python manage.py seed_db\n\n\n\n\n\n\u7136\u540e\u5c06\u6211\u4eec\u7684\nReact\n\u5e94\u7528\u670d\u52a1\u6253\u5f00(\nnpm start\n)\uff0c\u4e00\u6837\u7684\u64cd\u4f5c\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\nJavaScript Console\n\u63a7\u5236\u7ec8\u7aef\uff0c\u8fd9\u4e0b\u6211\u4eec\u5e94\u8be5\u53ef\u4ee5\u770b\u5230\u6b63\u5e38\u7684\u7f51\u7edc\u8bf7\u6c42\u7684\u6253\u5370\u7ed3\u679c\uff1a\nconsole.log(res)\n\u3002\n\n\n\n\u6211\u4eec\u524d\u9762\u5728\u5199\u83b7\u53d6\u7528\u6237\u5217\u8868\u7684\nAPI\n\u7684\u65f6\u5019\uff0c\u8fd4\u56de\u7684\u6570\u636e\u7ed3\u6784\u662f\u8fd9\u6837\u7684\uff1a\n\n\n{\n\n  \nstatus\n:\n \nsuccess\n,\n\n  \ndata\n:\n \n{\n\n      \nusers\n:\n \nusers_list\n\n  \n}\n\n\n}\n\n\n\n\n\n\n\u8fd8\u8bb0\u5f97\u5417(\nproject/api/views.py\n\u6587\u4ef6\u4e2d\u7684\nget_users\n\u65b9\u6cd5)\uff1f\u6211\u4eec\u6765\u66f4\u6539\naxios\n\u83b7\u53d6\u6210\u529f\u540e\u7684\u6253\u5370\u8bed\u53e5\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u62ff\u5230\u7528\u6237\u5217\u8868\u6570\u636e\uff1a\n\n\ngetUsers\n()\n \n{\n\n  \naxios\n.\nget\n(\n`\n${\nprocess\n.\nenv\n.\nREACT_APP_USERS_SERVICE_URL\n}\n/users`\n)\n\n  \n.\nthen\n((\nres\n)\n \n=\n \n{\n \nconsole\n.\nlog\n(\nres\n.\ndata\n.\ndata\n.\nusers\n);\n \n})\n\n  \n.\ncatch\n((\nerr\n)\n \n=\n \n{\n \nconsole\n.\nlog\n(\nerr\n);\n \n})\n\n\n}\n\n\n\n\n\n\n\uff08\u60f3\u60f3\u4e3a\u4ec0\u4e48\u662f\nres.data.data.users\n\uff1f\uff09\u73b0\u5728\u4f60\u53ef\u4ee5\u5728\nJavascript Console\n\u7ec8\u7aef\u4e2d\u770b\u5230\u4e24\u4e2a\u7528\u6237\u5bf9\u8c61\u7684\u6570\u7ec4\u6253\u5370\u51fa\u6765\u4e86\uff1a\n\n\n[\n\n  \n{\ncreated_at\n:\nSat, 13 Jan 2018 06:12:40 GMT\n,\nemail\n:\nqikqiak@gmail.com\n,\nid\n:\n1\n,\nusername\n:\ncnych\n},\n\n  \n{\ncreated_at\n:\nSat, 13 Jan 2018 06:12:40 GMT\n,\nemail\n:\nicnych@gmail.com\n,\nid\n:\n2\n,\nusername\n:\nchyang\n}\n\n\n]\n\n\n\n\n\n\n\u73b0\u5728\u6709\u4e2a\u95ee\u9898\u662f\uff0c\u6211\u4eec\u662f\u5728\u6784\u9020\u51fd\u6570\u4e2d\u8c03\u7528\u7684\ngetUsers()\n\u65b9\u6cd5\uff0c\u800c\u6784\u9020\u51fd\u6570\nconstructor()\n\u662f\u5728\u7ec4\u4ef6\u88ab\u6302\u8f7d\u5230\nDOM\n\u4e4b\u524d\u8c03\u7528\u7684\uff0c\u5982\u679c\nAJAX\n\u8bf7\u6c42\u5728\u7ec4\u4ef6\u88ab\u6302\u8f7d\u5b8c\u6210\u4e4b\u524d\u6bd4\u9884\u671f\u82b1\u8d39\u4e86\u66f4\u591a\u7684\u65f6\u95f4\u4f1a\u51fa\u73b0\u4ec0\u4e48\u60c5\u51b5\u5462\uff1f\u8fd9\u6709\u53ef\u80fd\u4f1a\u9020\u6210\n\u7ade\u4e89\u5371\u5bb3\n\uff0c\u4ec0\u4e48\u610f\u601d\uff1f\u5c31\u662f\u9875\u9762\u4e0a\u7684\u6570\u636e\u53ef\u80fd\u73b0\u5728\u80fd\u591f\u6e32\u67d3\u51fa\u6765\uff0c\u53e6\u5916\u4e00\u6b21\u53c8\u53ef\u80fd\u6e32\u67d3\u4e0d\u51fa\u6765(\u56e0\u4e3a\u8fd9\u4e2a\u65f6\u5019\u6570\u636e\u5728\u7ec4\u4ef6\u6302\u8f7d\u5b8c\u6210\u540e\u8fd8\u6ca1\u5b8c\u6210\u8bf7\u6c42\uff0c\u660e\u767d\u4e86\u5417\uff1f)\uff0c\u8fd9\u53d6\u51b3\u4e0e\u6211\u4eec\u7684\nAJAX\n\u8bf7\u6c42\u662f\u5426\u80fd\u591f\u5728\u7ec4\u4ef6\u6302\u8f7d\u5b8c\u6210\u4e4b\u524d\u5b8c\u6210\u8bf7\u6c42\uff0c\u5bf9\u5427\u3002\u4e0d\u8fc7\u4e0d\u7528\u62c5\u5fc3\uff0c\nReact\n\u5b9a\u4e49\u4e86\u4e00\u7cfb\u5217\u7684\u751f\u547d\u5468\u671f\u51fd\u6570\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\n\u7ec4\u4ef6\u58f0\u660e\u5468\u671f\n\n\n\u57fa\u4e8e\u7c7b\u7684\u7ec4\u4ef6\u6709\u4e00\u4e2a\u7279\u5b9a\u7684\u51fd\u6570\uff0c\u5b83\u4eec\u5728\u7ec4\u4ef6\u7684\u751f\u547d\u5468\u671f\u5404\u4e2a\u9636\u6bb5\u6267\u884c\u3002\u8fd9\u4e9b\u51fd\u6570\u88ab\u79f0\u4f5c\n\u751f\u547d\u5468\u671f\n\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u82b1\u70b9\u65f6\u95f4\u770b\u770b\n\u5b98\u65b9\u6587\u6863\n\u6765\u7b80\u5355\u7684\u5b66\u4e60\u4e0b\u6bcf\u4e2a\u58f0\u660e\u5468\u671f\u65b9\u6cd5\uff0c\u770b\u4e0b\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u662f\u5728\u4ec0\u4e48\u5730\u65b9\u88ab\u8c03\u7528\u7684\u3002\n\u7b80\u5355\u603b\u7ed3\u4e0b\uff1a\u65b9\u6cd5\u4e2d\u5e26\u6709\u524d\u7f00\nwill\n\u7684\u5728\u7279\u5b9a\u73af\u8282\u4e4b\u524d\u88ab\u8c03\u7528\uff0c\u800c\u5e26\u6709\u524d\u7f00\ndid\n\u7684\u65b9\u6cd5\u5219\u4f1a\u5728\u7279\u5b9a\u73af\u8282\u4e4b\u540e\u88ab\u8c03\u7528\u3002\n\n\n\n\n\u6302\u8f7d\n\n\n\u4e0b\u9762\u8fd9\u4e9b\u65b9\u6cd5\u4f1a\u5728\u7ec4\u4ef6\u5b9e\u4f8b\u88ab\u521b\u5efa\u548c\u63d2\u5165\nDOM\n\u4e2d\u65f6\u88ab\u8c03\u7528\uff1a\n\n\n\n\nconstructor()\n\n\ncomponentWillMount()\uff1a\u4f1a\u5728\u7ec4\u4ef6\nrender\n\u4e4b\u524d\u6267\u884c\uff0c\u5e76\u4e14\u6c38\u8fdc\u90fd\u53ea\u6267\u884c\u4e00\u6b21\u3002\n\n\nrender()\n\n\ncomponentDidMount()\uff1a\u4f1a\u5728\u7ec4\u4ef6\u52a0\u8f7d\u5b8c\u6bd5\u4e4b\u540e\u7acb\u5373\u6267\u884c\u3002\u8fd9\u4e2a\u65f6\u5019\u7ec4\u4ef6\u5df2\u7ecf\u751f\u6210\u4e86\u5bf9\u5e94\u7684\nDOM\n\u7ed3\u6784\n\n\n\n\n\n\n\n\n\u66f4\u65b0\n\n\n\u5c5e\u6027\u6216\u8005\u72b6\u6001\u7684\u6539\u53d8\u4f1a\u89e6\u53d1\u4e00\u6b21\u66f4\u65b0\u3002\u5f53\u4e00\u4e2a\u7ec4\u4ef6\u5728\u88ab\u91cd\u65b0\u6e32\u67d3\u65f6\uff0c\u4e0b\u9762\u8fd9\u4e9b\u65b9\u6cd5\u4f1a\u88ab\u8c03\u7528\uff1a\n\n\n\n\ncomponentWillReceiveProps()\uff1a\u5728\u7ec4\u4ef6\u63a5\u6536\u5230\u4e00\u4e2a\u65b0\u7684\nprop\n\u65f6\u88ab\u6267\u884c\n\n\nshouldComponentUpdate()\n\n\ncomponentWillUpdate()\n\n\nrender()\n\n\ncomponentDidUpdate()\n\n\n\n\n\n\n\n\n\u5378\u8f7d\n\n\n\u5f53\u4e00\u4e2a\u7ec4\u4ef6\u4ece\nDOM\n\u4e2d\u79fb\u9664\u65f6\uff0c\u4f1a\u8c03\u7528\u4e0b\u9762\u7684\u65b9\u6cd5\uff1a\n\n\n\n\ncomponentWillUnmount()\n\n\n\n\n\n\n\u8bf4\u4e86\u8fd9\u4e48\u591a\uff0c\u6211\u4eec\u5e94\u8be5\u5728\u54ea\u4e2a\u65b9\u6cd5\u91cc\u9762\u6765\u505a\u6211\u4eec\u7684\u7f51\u7edc\u8bf7\u6c42\u5462\uff1f\u5b9e\u9645\u4e0a\nES6\n\u4e2d\u7684\u6784\u9020\u51fd\u6570\u548c\ncomponentWillMount\n\u51fd\u6570\u662f\u4e00\u81f4\u7684\uff0c\u4e0a\u9762\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u6784\u9020\u51fd\u6570\u4e2d\u6267\u884c\u7f51\u7edc\u8bf7\u6c42\u751a\u81f3\u662f\u6240\u6709\u7684\u5f02\u6b65\u64cd\u4f5c\u90fd\u4e0d\u662f\u597d\u7684\u9009\u62e9\uff0c\u5728\ncomponentDidMount\n\u51fd\u6570\u4e2d\u6267\u884c\u5f02\u6b65\u64cd\u4f5c\u662f\u6700\u597d\u7684\u65f6\u673a\uff0c\u53ef\u4ee5\u901a\u8fc7\nWhere to Fetch Data: componentWillMount vs componentDidMount\n\u4e86\u89e3\u5230\u539f\u56e0\u3002\n\n\n\u66f4\u6539\nclient/src/index.js\n\u4ee3\u7801\uff0c\u5728\nApp\n\u7c7b\u4e2d\u589e\u52a0\u65b9\u6cd5\uff1a\n\n\nclass\n \nApp\n \nextends\n \nComponent\n \n{\n\n  \nconstructor\n()\n \n{\n\n    \nsuper\n();\n\n  \n};\n\n  \ncomponentDidMount\n()\n \n{\n\n    \nthis\n.\ngetUsers\n();\n\n  \n};\n\n  \ngetUsers\n()\n \n{\n\n    \naxios\n.\nget\n(\n`\n${\nprocess\n.\nenv\n.\nREACT_APP_USERS_SERVICE_URL\n}\n/users`\n)\n\n    \n.\nthen\n((\nres\n)\n \n=\n \n{\n \nconsole\n.\nlog\n(\nres\n.\ndata\n.\ndata\n.\nusers\n);\n \n})\n\n    \n.\ncatch\n((\nerr\n)\n \n=\n \n{\n \nconsole\n.\nlog\n(\nerr\n);\n \n})\n\n  \n};\n\n  \nrender\n()\n \n{\n\n    \nreturn\n \n(\n\n      \ndiv\n \nclassName\n=\ncontainer\n\n        \ndiv\n \nclassName\n=\nrow\n\n          \ndiv\n \nclassName\n=\ncol-md-4\n\n            \nbr\n/\n\n            \nh1\nAll\n \nUsers\n/h1\n\n            \nhr\n/\nbr\n/\n\n          \n/div\n\n        \n/div\n\n      \n/div\n\n    \n)\n\n  \n}\n\n\n};\n\n\n\nReactDOM\n.\nrender\n(\n\n  \nApp\n \n/\n,\n\n  \ndocument\n.\ngetElementById\n(\nroot\n)\n\n\n);\n\n\n\n\n\n\n\u786e\u4fdd\u4e0a\u9762\u7684\nReact\n\u5e94\u7528\u4ecd\u7136\u80fd\u591f\u6b63\u5e38\u5de5\u4f5c\n\n\nState\uff08\u72b6\u6001\uff09\n\n\nstate\n\u662f\nReact\n\u4e2d\u975e\u5e38\u91cd\u8981\u7684\u4e00\u4e2a\u6982\u5ff5\uff0c\u4e00\u4e2a\u7ec4\u4ef6\u7684\u663e\u793a\u5f62\u6001\u53ef\u4ee5\u7531\u5b83\u7684\u6570\u636e\u72b6\u6001\u548c\u914d\u7f6e\u53c2\u6570\u6765\u51b3\u5b9a\uff0c\u4e00\u4e2a\u7ec4\u4ef6\u53ef\u4ee5\u62e5\u6709\u81ea\u5df1\u7684\u72b6\u6001\uff0c\u72b6\u6001\u7684\u6539\u53d8\u53ef\u4ee5\u8ba9\nReact\n\u9ad8\u6548\u7684\u66f4\u65b0\u754c\u9762\u3002\n\u73b0\u5728\u6211\u4eec\u4e3a\u7ec4\u4ef6\nApp\n\u589e\u52a0\u4e00\u4e2a\nusers\n\u7684\u72b6\u6001\u6570\u636e\uff0c\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\nsetState()\n\u65b9\u6cd5\u6765\u66f4\u65b0\u72b6\u6001\u6570\u636e\uff0c\u66f4\u65b0\ngetUsers()\n\u65b9\u6cd5\uff1a\n\n\ngetUsers\n()\n \n{\n\n  \naxios\n.\nget\n(\n`\n${\nprocess\n.\nenv\n.\nREACT_APP_USERS_SERVICE_URL\n}\n/users`\n).\nthen\n(\nres\n \n=\n \n{\n\n    \nthis\n.\nsetState\n({\n\n        \nusers\n:\n \nres\n.\ndata\n.\ndata\n.\nusers\n\n    \n});\n\n  \n}).\ncatch\n(\nerr\n \n=\n \n{\n\n    \nconsole\n.\nlog\n(\nerr\n);\n\n  \n});\n\n\n}\n\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u5728\u6784\u9020\u51fd\u6570\u4e2d\u589e\u52a0\u72b6\u6001\nusers\n\uff1a\n\n\nconstructor\n()\n \n{\n\n    \nsuper\n();\n\n    \nthis\n.\nstate\n \n=\n \n{\n\n        \nusers\n:\n \n[]\n\n    \n}\n\n\n}\n\n\n\n\n\n\n\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u9ed8\u8ba4\u521d\u59cb\u5316\u7684\u65f6\u5019\nusers\n\u6570\u636e\u662f\u4e00\u4e2a\u7a7a\u6570\u7ec4\uff0c\u5728\ngetUsers()\n\u65b9\u6cd5\u8c03\u7528\u6210\u529f\u540e\uff0c\u6211\u4eec\u8c03\u7528\nsetState()\n\u65b9\u6cd5\u66f4\u65b0\u4e86\nusers\n\u72b6\u6001\u3002\n\n\n\n\n\u67e5\u770b\n\u5b98\u65b9\u6587\u6863\n\u5b66\u4e60\u6b63\u786e\u7684\u4f7f\u7528\nstate\n\u3002\n\n\n\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u66f4\u65b0\nrendor()\n\u65b9\u6cd5\u6765\u5c06\u72b6\u6001\u6570\u636e\u6e32\u67d3\u5230\u9875\u9762\u4e2d\uff1a\n\n\nrender\n()\n \n{\n\n    \nreturn\n \n(\n\n      \ndiv\n \nclassName\n=\ncontainer\n\n        \ndiv\n \nclassName\n=\nrow\n\n          \ndiv\n \nclassName\n=\ncol-md-4\n\n            \nbr\n \n/\n\n            \nh1\nAll\n \nUsers\n/h1\n\n            \nhr\n \n/\nbr\n \n/\n\n            \n{\n\n                \nthis\n.\nstate\n.\nusers\n.\nmap\n(\nuser\n \n=\n \n{\n\n                    \nreturn\n \n(\n\n                        \nh4\n\n                          \nkey\n=\n{\n \nuser\n.\nid\n \n}\n\n                          \nclassName\n=\nwell\n\n                        \n{\n \nuser\n.\nusername\n \n}\n\n                        \n/h4\n\n                    \n)\n\n                \n})\n\n            \n}\n\n          \n/div\n\n        \n/div\n\n      \n/div\n\n    \n)\n\n\n}\n\n\n\n\n\n\n\u4e0a\u9762\u7684\nrender()\n\u51fd\u6570\uff1a\n\n\n\n\n\u6211\u4eec\u5faa\u73af(\u7528\u7684\nES6\u7684map\n\u65b9\u6cd5)\nusers\n\u72b6\u6001\u6570\u636e\uff0c\u6bcf\u6b21\u5faa\u73af\u4e2d\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684\nH4\n\u5143\u7d20\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u6211\u4eec\u521d\u59cb\u5316\u7684\nusers\n\u662f\u4e00\u4e2a\u7a7a\u6570\u7ec4\u7684\u539f\u56e0\uff0c\u907f\u514d\u521d\u59cb\u5316\u7684\u65f6\u5019\u51fa\u9519\u3002\n\n\n\u6ce8\u610f\nH4\n\u5143\u7d20\u4e2d\u6211\u4eec\u589e\u52a0\u4e86\u4e00\u4e2a\u5c5e\u6027\nkey\n\uff1a\nReact\n\u901a\u8fc7\u8be5\u503c\u6765\u8ddf\u8e2a\u6bcf\u4e00\u4e2a\u5143\u7d20\uff0c\u6bcf\u4e2a\nkey\n\u5bf9\u5e94\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u76f8\u540c\u7684\nkey\nReact\n\u4f1a\u8ba4\u4e3a\u662f\u540c\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u8fd9\u6837\u540e\u7eed\u76f8\u540c\u7684\nkey\n\u5bf9\u5e94\u7ec4\u4ef6\u90fd\u4e0d\u4f1a\u88ab\u521b\u5efa\uff0c\u7b80\u5355\u7684\u6765\u8bf4\u5c31\u662f\u8be5\u5c5e\u6027\u662f\u7528\u6765\u4fdd\u8bc1\nReact\n\u9ad8\u6548\u7684\u4e00\u4e2a\u91cd\u8981\u6807\u8bc6\uff0c\u5728\u5faa\u73af\u4e2d\u4e00\u5b9a\u8981\u52a0\u4e0a\u8be5\u5c5e\u6027\u3002\n\u67e5\u770b\u5b98\u65b9\u6587\u6863\n\u4e86\u89e3\u66f4\u591a\u5173\u4e8e\nkey\n\u7684\u6982\u5ff5\u3002\n\n\n\n\n\u5230\u8fd9\u91cc\uff0c\u5176\u5b9e\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u770b\u5230\nReact\n\u5e94\u7528\u7684\u6548\u679c\u4e86\uff0c\u5982\u4e0b\u56fe\uff1a\n\n\n\n\u7ec4\u4ef6\n\n\n\u6211\u4eec\u77e5\u9053\nReact\n\u662f\u4e00\u4e2a\u7ec4\u4ef6\u5316\u7684\u5e93\uff0c\u6211\u4eec\u8fd9\u91cc\u53ef\u4ee5\u5c06\u7528\u6237\u5217\u8868\u505a\u6210\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u8fd9\u6837\u5176\u4ed6\u4efb\u4f55\u5730\u65b9\u8981\u4f7f\u7528\u7528\u6237\u5217\u8868\u7684\u8bdd\uff0c\u53ea\u9700\u8981\u5c06\u8fd9\u4e2a\u7ec4\u4ef6\u5f15\u5165\u5c31\u884c\u4e86\uff0c\u662f\u4e0d\u662f\u5f88\u65b9\u4fbf~~~\n\n\n\u9996\u5148\u5728\nsrc\n\u76ee\u5f55\u4e0b\u9762\u65b0\u5efa\ncomponents\n\u76ee\u5f55\uff0c\u5728\u8be5\u76ee\u5f55\u4e0b\u65b0\u5efa\u6587\u4ef6\uff1a\nUserList.jsx\n\uff1a\n\n\nimport\n \nReact\n \nfrom\n \nreact\n;\n\n\n\nconst\n \nUserList\n \n=\n \n(\nprops\n)\n \n=\n \n{\n\n    \nreturn\n \n(\n\n        \ndiv\n\n          \n{\n\n            \nprops\n.\nusers\n.\nmap\n(\nuser\n \n=\n \n{\n\n              \nreturn\n \n(\n\n                \nh4\n\n                  \nkey\n=\n{\n \nuser\n.\nid\n \n}\n\n                  \nclassName\n=\nwell\n\n                \n{\n \nuser\n.\nusername\n \n}\n\n                \n/h4\n\n              \n)\n\n            \n})\n\n          \n}\n\n        \n/div\n\n    \n)\n\n\n};\n\n\n\nexport\n \ndefault\n \nUserList\n;\n\n\n\n\n\n\n\u6ce8\u610f\u8fd9\u91cc\uff0c\u4e3a\u4ec0\u4e48\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u51fd\u6570\u7ec4\u4ef6\u800c\u4e0d\u662f\u57fa\u4e8e\u7c7b\u7684\u7ec4\u4ef6\u5462\uff1f\u6ce8\u610f\u5728\u8be5\u7ec4\u4ef6\u4e2d\u6211\u4eec\u4f7f\u7528\nprops\n\u4ee3\u66ff\u4e86\nstate\n\uff1a\n\n\n\n\nProps\n\uff1a\u6570\u636e\u901a\u8fc7\nprops\n\u5411\u4e0b\u4f20\u9012\uff0c\u662f\u53ea\u8bfb\u7684\n\n\nState\n\uff1a\u6570\u636e\u7ed1\u5b9a\u5230\u4e00\u4e2a\u7ec4\u4ef6\u4e0a\uff0c\u662f\u53ef\u8bfb\u5199\u7684\n\n\n\n\n\n\n\u53ef\u4ee5\u67e5\u770b\u6587\u7ae0\nReactJS: Props vs. State\n\u4e86\u89e3\u66f4\u591a\u5c5e\u6027\u548c\u72b6\u6001\u7684\u533a\u522b\u3002\n\n\n\n\n\u9650\u5236\u57fa\u4e8e\u7c7b\u7684\uff08\u6709\u72b6\u6001\uff09\u7ec4\u4ef6\u6570\u91cf\u662f\u4e00\u4e2a\u597d\u7684\u4e60\u60ef\uff0c\u56e0\u4e3a\u5b83\u4eec\u53ef\u4ee5\u64cd\u4f5c\u72b6\u6001\uff0c\u56e0\u4e3a\u4e0d\u592a\u53ef\u9884\u6d4b\uff0c\u4e0d\u592a\u53ef\u63a7\u5236\u3002\u5982\u679c\u4f60\u53ea\u9700\u8981\u6e32\u67d3\u6570\u636e\uff08\u5c31\u50cf\u6211\u4eec\u7684\nUserList\n\u7ec4\u4ef6\uff09,\u4f7f\u7528\u4e00\u4e2a\u51fd\u6570\u7c7b\u7684\u7ec4\u4ef6\u662f\u4e00\u4e2a\u66f4\u597d\u7684\u9009\u62e9\u3002\n\n\n\u73b0\u5728\u6211\u4eec\u9700\u8981\u5728\u7236\u7ec4\u4ef6\u4e2d\u901a\u8fc7\u72b6\u6001\u6570\u636e\u4f20\u9012\u7ed9\u5b50\u7ec4\u4ef6\uff0c\u9996\u5148\u5728\nindex.js\n\u6587\u4ef6\u4e2d\u5148\u5f15\u5165\u6211\u4eec\u7684\u7528\u6237\u5217\u8868\u7ec4\u4ef6\uff1a\n\n\nimport\n \nUserList\n \nfrom\n \n./components/UserList\n;\n\n\n\n\n\n\n\u7136\u540e\u66f4\u65b0\nrender()\n\u65b9\u6cd5\uff1a\n\n\nrender\n()\n \n{\n\n    \nreturn\n \n(\n\n      \ndiv\n \nclassName\n=\ncontainer\n\n        \ndiv\n \nclassName\n=\nrow\n\n          \ndiv\n \nclassName\n=\ncol-md-4\n\n            \nbr\n \n/\n\n            \nh1\nAll\n \nUsers\n/h1\n\n            \nhr\n \n/\nbr\n \n/\n\n            \nUserList\n \nusers\n=\n{\nthis\n.\nstate\n.\nusers\n}\n \n/\n\n          \n/div\n\n        \n/div\n\n      \n/div\n\n    \n)\n\n\n}\n\n\n\n\n\n\n\u6ce8\u610f\u770b\u4e0a\u9762\u662f\u600e\u6837\u5f15\u5165\u7528\u6237\u5217\u8868\u7ec4\u4ef6\u7684\uff1a\n\uff0c\u8fd9\u6837\nApp\n\u7ec4\u4ef6\u5c06\u72b6\u6001\u6570\u636e\nusers\n\u901a\u8fc7\u5c5e\u6027\u7684\u5f62\u5f0f\u4f20\u9012\u7ed9\u4e86\u5b50\u7ec4\u4ef6\nUserList\n\uff0c\u7136\u540e\u5b50\u7ec4\u4ef6\u4e2d\u901a\u8fc7\u5c5e\u6027\nusers\n\u8fdb\u884c\u6570\u636e\u6e32\u67d3\uff0c\u6574\u4e2a\u6d41\u7a0b\u660e\u767d\u4e86\u5417\uff1f\n\n\n\u5230\u8fd9\u91cc\u8bf7\u786e\u4fdd\nReact\n\u5e94\u7528\u80fd\u591f\u6b63\u5e38\u7684\u5de5\u4f5c\uff0c\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\nhttp://localhost:3000\n\u80fd\u5f97\u5230\u4e0a\u9762\u76f8\u540c\u7684\u7ed3\u679c\uff0c\u7136\u540e\u6211\u4eec\u5bf9\u6211\u4eec\u7684\u4ee3\u7801\u8fdb\u884c\u4e00\u4e9b\nReview\n\uff0c\u7136\u540e\u63d0\u4ea4\u5230\ngithub\n\u4e0a\u53bb\u3002", 
            "title": "React \u5e94\u7528"
        }, 
        {
            "location": "/part2/react/#_1", 
            "text": "\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u975e\u5e38\u725b\u903c\u7684\u521b\u5efa React \u9879\u76ee\u7684\u811a\u624b\u67b6\u5de5\u5177\uff1a Create React App \u3002\n\u9996\u5148\u6211\u4eec\u5b89\u88c5 Create React App \u5de5\u5177\u5230\u5168\u5c40\u73af\u5883\u4e2d\uff1a  $ npm install create-react-app --global  \u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u5728\u6211\u4eec\u7684 flask-microservices-users \u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u9762\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u5939\uff1a client \uff0c\u7136\u540e\u521d\u59cb\u5316\u6211\u4eec\u7684\u9879\u76ee\u7ed3\u6784\uff1a  $ mkdir client    cd  client\n$ create-react-app .  \u9879\u76ee\u7ed3\u6784\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u76f8\u5173\u7684\u4f9d\u8d56\u5305\u4e5f\u5df2\u7ecf\u5b89\u88c5\u597d\uff0c\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u542f\u52a8\u670d\u52a1\uff1a  $ npm start  \u670d\u52a1\u542f\u52a8\u5b8c\u6210\u540e\uff0c Create React App \u5de5\u5177\u4f1a\u81ea\u52a8\u7528\u9ed8\u8ba4\u7684\u6d4f\u89c8\u5668\u6253\u5f00\uff1a http://localhost:3000 \u3002  \u786e\u4fdd\u4e0a\u9762\u8fd9\u4e9b\u90fd\u6b63\u5e38\u540e\uff0c\u5173\u6389\u670d\u52a1(Crtl + C)\uff0c\u4e3a\u4e86\u7b80\u5316\u6211\u4eec\u7684\u5f00\u53d1\u8fc7\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u77e5 npm \u4e0d\u8981\u4e3a\u9879\u76ee\u521b\u5efa package-lock.json \u6587\u4ef6\uff1a  $  echo   package-lock=false    .npmrc   \u53ef\u4ee5\u901a\u8fc7\u6587\u6863 npm docs \u67e5\u770b\u5173\u4e8e\u914d\u7f6e\u6587\u4ef6 .npmrc \u7684\u66f4\u591a\u4fe1\u606f\u3002  \u5bf9 package-lock.json \u6587\u4ef6\u4e0d\u592a\u6e05\u695a\u7684\uff0c\u53ef\u4ee5\u67e5\u770b\u8fd9\u7bc7\u6587\u7ae0: Understanding lock files in NPM 5 \u8fdb\u884c\u4e86\u89e3\u3002   \u73b0\u5728\u6765\u5f00\u59cb\u521b\u5efa\u521b\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u7ec4\u4ef6\u5427~~~", 
            "title": "\u521d\u59cb\u5316\u9879\u76ee"
        }, 
        {
            "location": "/part2/react/#_2", 
            "text": "\u4e3a\u4e86\u8ba9\u6211\u4eec\u7684\u9879\u76ee\u7ed3\u6784\u770b\u8d77\u6765\u66f4\u52a0\u7b80\u5355\uff0c\u6211\u4eec\u79fb\u9664 src \u76ee\u5f55\u4e0b\u9762\u7684 App.css \uff0c App.js \uff0c App.test.js \u4ee5\u53ca index.css \u6587\u4ef6\uff0c\u7136\u540e\u66f4\u65b0 index.js \u6587\u4ef6\uff1a  import   React   from   react ;  import   ReactDOM   from   react-dom ;  const   App   =   ()   =   { \n     return   ( \n       div   className = container \n         div   className = row \n           div   className = col-md-4 \n             br   / \n             h1 All   Users /h1 \n             hr   / br   / \n           /div \n         /div \n       /div \n     )  };  ReactDOM . render ( \n   App   / , \n   document . getElementById ( root )  );   \u4e0a\u9762\u4ee3\u7801\u505a\u4e86\u51e0\u4ef6\u4e8b\uff1a   \u5bfc\u5165 React \u548c ReactDom \u7c7b\u540e\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u53eb App \u7684\u51fd\u6570\uff0c\u8fd9\u662f ES6 \u91cc\u9762\u7684\u7bad\u5934\u51fd\u6570\u7684\u5199\u6cd5\uff0c\u7136\u540e\u8be5\u51fd\u6570\u8fd4\u56de\u7684\u662f\u4e00\u4e2a JSX \u683c\u5f0f\u7684\u5bf9\u8c61\u3002  \u6211\u4eec\u7528 ReactDOM \u7684 render \u65b9\u6cd5\u5c06\u6211\u4eec\u7684 App \u7ec4\u4ef6\u6302\u8f7d\u5230\u4e86\u4e00\u4e2aID\u4e3a root \u7684 HTML \u5143\u7d20\u4e0a\u3002    \u6ce8\u610f public \u76ee\u5f55\u4e0b\u9762\u7684 index.html \u6587\u4ef6\u7684 div id=\"root\" /div \uff0c\u8fd9\u5c31\u662f\u88ab\u6302\u8f7d\u7684\u5730\u65b9\u3002\u53e6\u5916\u5bf9\u4e8e\u8fd8\u4e0d\u592a\u4e86\u89e3 ES6 \u7684\u540c\u5b66\uff0c\u4e0d\u7528\u62c5\u5fc3\uff0c\u5b9e\u9645\u4e0a\u662f\u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7 javascript \u7684\u8bed\u6cd5\uff0c\u76f4\u63a5\u5b66\u4e60 ES6 \u7684(\u867d\u7136\u4e0d\u592a\u63a8\u8350\u8fd9\u6837)\uff0c ES6 \u6bd4\u539f\u751f\u7684 javascript \u66f4\u52a0\u7cfb\u7edf\u3001\u66f4\u52a0\u5bb9\u6613\u5b66\u4e60\u3001\u4e5f\u66f4\u52a0\u63a5\u8fd1\u4f60\u6240\u5b66\u4e60\u8fc7\u7684\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00( \u70b9\u51fb\u8fd9\u91cc\u524d\u53bb\u5b66\u4e60\u5427 )   \u7136\u540e\u5728 public \u76ee\u5f55\u4e0b\u7684 index.html \u6587\u4ef6\u7684 head \u533a\u57df\u6dfb\u52a0 bootstrap \u7684 css \u6837\u5f0f\u6587\u4ef6\uff1a  link   rel = stylesheet   href = https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css", 
            "title": "\u7b2c\u4e00\u4e2a\u7ec4\u4ef6"
        }, 
        {
            "location": "/part2/react/#_3", 
            "text": "\u73b0\u5728\u6211\u4eec\u6765\u5c06\u6211\u4eec\u7684 App \u7ec4\u4ef6\u66f4\u6539\u6210\u57fa\u4e8e\u7c7b\u7684\u5f62\u5f0f\uff1a  import   React ,   { Component }   from   react ;  import   ReactDOM   from   react-dom ;  class   App   extends   Component   { \n     constructor ()   { \n         super (); \n     } \n     render ()   { \n         return   ( \n           div   className = container \n             div   className = row \n               div   className = col-md-4 \n                 br   / \n                 h1 All   Users /h1 \n                 hr   / br   / \n               /div \n             /div \n           /div \n         ) \n     }  }  ReactDOM . render ( \n   App   / , \n   document . getElementById ( root )  );   \u7136\u540e\u6211\u4eec\u6267\u884c npm start \u53ef\u4ee5\u53d1\u73b0\u5176\u5b9e\u4e0a\u9762\u7684\u57fa\u4e8e\u7c7b\u7684\u7ec4\u4ef6\u548c\u524d\u9762\u7684\u51fd\u6570\u7ec4\u4ef6\uff0c\u6700\u540e\u7684\u8f93\u51fa\u90fd\u662f\u4e00\u6a21\u4e00\u6837\u7684\uff0c\u6211\u4eec\u5728\u540e\u9762\u4f1a\u6162\u6162\u53d1\u73b0\u4e8c\u8005\u4e4b\u95f4\u7684\u533a\u522b\u7684\u3002", 
            "title": "\u57fa\u4e8e\u7c7b\u7684\u7ec4\u4ef6"
        }, 
        {
            "location": "/part2/react/#ajax", 
            "text": "\u4e3a\u4e86\u8fde\u63a5\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u6570\u636e\uff0c\u6211\u4eec\u5728 App \u7c7b\u4e2d\u589e\u52a0\u4e00\u4e2a getUsers() \u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u7528\u4e00\u4e2a\u975e\u5e38\u6d41\u884c\u7684\u5e93\uff1a Axios \u6765\u8fdb\u884c\u7f51\u7edc\u8bf7\u6c42\uff1a\n\u9996\u5148\u5148\u5b89\u88c5 axios \u5305\uff1a  $ npm install axios --save  \u7136\u540e\u5728 App \u7c7b\u4e2d\u6dfb\u52a0 getUsers \u51fd\u6570\uff1a  import   React ,   { Component }   from   react ;  import   ReactDOM   from   react-dom ;  import   axios   from   axios ;  class   App   extends   Component   { \n     constructor ()   { \n         super (); \n     } \n     getUsers ()   { \n       axios . get ( ` ${ process . env . REACT_APP_USERS_SERVICE_URL } /users` ). then ( res   =   { \n         console . log ( res ); \n       }). catch ( err   =   { \n         console . log ( err ); \n       }); \n     } \n     render ()   { \n         return   ( \n           div   className = container \n             div   className = row \n               div   className = col-md-4 \n                 br   / \n                 h1 All   Users /h1 \n                 hr   / br   / \n               /div \n             /div \n           /div \n         ) \n     }  }  ReactDOM . render ( \n   App   / , \n   document . getElementById ( root )  );   \u5f53\u7136\u4e0d\u8981\u5fd8\u8bb0\u5728\u9876\u90e8\u5bfc\u5165 axios \u5305\u54e6~  \u4e3a\u4e86\u9a8c\u8bc1\u4e0a\u9762\u7684\u529f\u80fd\uff0c\u6211\u4eec\u8981\u5148\u5f00\u542f\u6211\u4eec\u7684\u670d\u52a1\u7aef\uff0c\u6253\u5f00\u4e00\u4e2a\u65b0\u7684\u7ec8\u7aef\u7a97\u53e3\uff0c\u7136\u540e\u5b9a\u4f4d\u5230 flask-microservices-users \u9879\u76ee\u6839\u76ee\u5f55\uff0c\u8fd8\u8bb0\u5f97\u524d\u9762\u7684\u542f\u52a8 docker-compose \u7684\u547d\u4ee4\u5417\uff1f  $ docker-compose -f docker-compose.yml up -d  \u4e3a\u4e86\u786e\u4fdd\u6211\u4eec\u670d\u52a1\u7aef\u7684\u4ee3\u7801\u662f\u6b63\u5e38\u5de5\u4f5c\u7684\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u6267\u884c\u4e0b\u6211\u4eec\u7684\u6d4b\u8bd5\u547d\u4ee4\uff1a  $ docker-compose -f docker-compose.yml run users-service python manage.py  test   \u6d4b\u8bd5\u901a\u8fc7\u540e\uff0c\u6211\u4eec\u56de\u5230 React \u9879\u76ee\uff0c\u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\u53ef\u4ee5\u770b\u51fa\u6211\u4eec\u9700\u8981\u589e\u52a0\u4e00\u4e2a process.env.REACT_APP_USERS_SERVICE_URL \u7684\u73af\u5883\u53d8\u91cf\uff0c\u9996\u5148\u6740\u6389 React \u7684\u670d\u52a1(Ctrl + C)\uff0c\u7136\u540e\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff1a  $  export   REACT_APP_USERS_SERVICE_URL = http://127.0.0.1:5001   \u6ce8\u610f\u6240\u6709\u7684\u81ea\u5b9a\u4e49\u7684\u73af\u5883\u53d8\u91cf\u5fc5\u987b\u8981\u5df2 REACT_APP_ \u5f00\u5934\uff0c\u66f4\u591a\u4fe1\u606f\u53ef\u4ee5\u67e5\u770b \u5b98\u65b9\u6587\u6863   \u73b0\u5728\u4e3a\u4e86\u9a8c\u8bc1 getUsers() \u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6784\u9020\u51fd\u6570 constructor() \u4e2d\u5148\u8c03\u7528\uff1a  constructor ()   { \n   super (); \n   this . getUsers ();  }   \u8fd9\u6837\u5f53\u6211\u4eec\u7684 App \u7ec4\u4ef6\u88ab\u5b9e\u4f8b\u5316\u7684\u65f6\u5019\u5c31\u4f1a\u8c03\u7528 getUsers() \u65b9\u6cd5\u4e86\u3002\u6211\u4eec\u6765\u8fd0\u884c\u547d\u4ee4\uff1a npm start \u6253\u5f00\u6211\u4eec\u7684 React \u5e94\u7528\uff0c\u7136\u540e\u6253\u5f00 Chrome \u5f00\u53d1\u8005\u5de5\u5177 (\u5f3a\u70c8\u63a8\u8350\u628a chrome \u6d4f\u89c8\u5668\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u6d4f\u89c8\u5668\uff0c\u8fd9\u8d27\u5bf9\u4e8e\u524d\u7aef\u5f00\u53d1\u8005\u6765\u8bf4\u771f\u7684\u662f\u795e\u5668\uff0c\u5728\u9875\u9762\u53f3\u952e\u9009\u62e9\u5ba1\u67e5\u5143\u7d20\u5373\u53ef\u6253\u5f00)\uff0c\u7136\u540e\u6253\u5f00 JavaScript Console \u63a7\u5236\u53f0\uff0c\u4f60\u5c06\u80fd\u770b\u5230\u4e0b\u9762\u7684\u9519\u8bef\u4fe1\u606f\uff1a \n\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u6211\u4eec\u6b63\u5728\u53d1\u8d77\u4e00\u4e2a \u8de8\u57df \u7684 AJAX \u8bf7\u6c42(\u4ece http://localhost:3000 \u5230 http://127.0.0.1:5001 )\uff0c\u8fd9\u662f\u8fdd\u53cd\u6d4f\u89c8\u5668\u7684 \u540c\u6e90\u7b56\u7565 \u7684\uff0c\u6240\u4ee5\u8be5\u8bf7\u6c42\u88ab\u62d2\u7edd\u4e86\u3002\u5e78\u8fd0\u7684\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 Flask-CORS \u6269\u5c55\u5728\u670d\u52a1\u7aef\u6765\u5904\u7406\u8de8\u57df\u7684\u8bf7\u6c42\u3002  \u56de\u5230 flaks-users-service \u7684\u76ee\u5f55\uff0c\u589e\u52a0 Flask-CORS \u5305\u5728 requirements.txt \u6587\u4ef6\u4e2d\uff1a  flask-cors==3.0.3  \u4e3a\u65b9\u4fbf\u6211\u4eec\u5f00\u53d1\u8c03\u8bd5\uff0c\u6211\u4eec\u8bbe\u7f6e\u6240\u6709\u7684\u8bf7\u6c42\u90fd\u8fd0\u884c\u8de8\u57df\u64cd\u4f5c(\u5207\u8bb0\uff0c\u751f\u4ea7\u73af\u5883\u7edd\u5bf9\u4e0d\u80fd\u8fd9\u6837\u505a)\uff0c\u66f4\u65b0 flaks-users-service/project/__init__.py \u6587\u4ef6\u7684 create_app() \u65b9\u6cd5\uff1a  from   flask_cors   import   CORS  def   create_app (): \n     # \u521d\u59cb\u5316\u5e94\u7528 \n     app   =   Flask ( __name__ ) \n\n     # \u8fd0\u884c\u8de8\u57df \n     CORS ( app ) \n\n     # \u73af\u5883\u914d\u7f6e \n     app_settings   =   os . getenv ( APP_SETTINGS ) \n     app . config . from_object ( app_settings ) \n     # \u5b89\u88c5\u6269\u5c55 \n     db . init_app ( app ) \n     # \u6ce8\u518cblueprint \n     from   project.api.views   import   users_blueprint \n     app . register_blueprint ( users_blueprint ) \n     return   app   \u4e0d\u8981\u5fd8\u8bb0\u5728\u6587\u4ef6\u7684\u9876\u90e8\u5bfc\u5165 flask_cors \u5305\uff1a  from   flask_cors   import   CORS   \u7531\u4e8e\u6211\u4eec\u65b0\u589e\u4e86\u4f9d\u8d56\u5305\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u91cd\u65b0\u6784\u5efa\u6211\u4eec\u7684\u955c\u50cf\uff1a  $ docker-compose -f docker-compose.yml up -d --build  \u7136\u540e\u66f4\u65b0\u3001\u521d\u59cb\u5316\u6570\u636e\u5e93\uff1a  $ docker-compose -f docker-compose.yml run users-service python manage.py recreate_db\n$ docker-compose -f docker-compose.yml run users-service python manage.py seed_db  \u7136\u540e\u5c06\u6211\u4eec\u7684 React \u5e94\u7528\u670d\u52a1\u6253\u5f00( npm start )\uff0c\u4e00\u6837\u7684\u64cd\u4f5c\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 JavaScript Console \u63a7\u5236\u7ec8\u7aef\uff0c\u8fd9\u4e0b\u6211\u4eec\u5e94\u8be5\u53ef\u4ee5\u770b\u5230\u6b63\u5e38\u7684\u7f51\u7edc\u8bf7\u6c42\u7684\u6253\u5370\u7ed3\u679c\uff1a console.log(res) \u3002  \u6211\u4eec\u524d\u9762\u5728\u5199\u83b7\u53d6\u7528\u6237\u5217\u8868\u7684 API \u7684\u65f6\u5019\uff0c\u8fd4\u56de\u7684\u6570\u636e\u7ed3\u6784\u662f\u8fd9\u6837\u7684\uff1a  { \n   status :   success , \n   data :   { \n       users :   users_list \n   }  }   \u8fd8\u8bb0\u5f97\u5417( project/api/views.py \u6587\u4ef6\u4e2d\u7684 get_users \u65b9\u6cd5)\uff1f\u6211\u4eec\u6765\u66f4\u6539 axios \u83b7\u53d6\u6210\u529f\u540e\u7684\u6253\u5370\u8bed\u53e5\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u62ff\u5230\u7528\u6237\u5217\u8868\u6570\u636e\uff1a  getUsers ()   { \n   axios . get ( ` ${ process . env . REACT_APP_USERS_SERVICE_URL } /users` ) \n   . then (( res )   =   {   console . log ( res . data . data . users );   }) \n   . catch (( err )   =   {   console . log ( err );   })  }   \uff08\u60f3\u60f3\u4e3a\u4ec0\u4e48\u662f res.data.data.users \uff1f\uff09\u73b0\u5728\u4f60\u53ef\u4ee5\u5728 Javascript Console \u7ec8\u7aef\u4e2d\u770b\u5230\u4e24\u4e2a\u7528\u6237\u5bf9\u8c61\u7684\u6570\u7ec4\u6253\u5370\u51fa\u6765\u4e86\uff1a  [ \n   { created_at : Sat, 13 Jan 2018 06:12:40 GMT , email : qikqiak@gmail.com , id : 1 , username : cnych }, \n   { created_at : Sat, 13 Jan 2018 06:12:40 GMT , email : icnych@gmail.com , id : 2 , username : chyang }  ]   \u73b0\u5728\u6709\u4e2a\u95ee\u9898\u662f\uff0c\u6211\u4eec\u662f\u5728\u6784\u9020\u51fd\u6570\u4e2d\u8c03\u7528\u7684 getUsers() \u65b9\u6cd5\uff0c\u800c\u6784\u9020\u51fd\u6570 constructor() \u662f\u5728\u7ec4\u4ef6\u88ab\u6302\u8f7d\u5230 DOM \u4e4b\u524d\u8c03\u7528\u7684\uff0c\u5982\u679c AJAX \u8bf7\u6c42\u5728\u7ec4\u4ef6\u88ab\u6302\u8f7d\u5b8c\u6210\u4e4b\u524d\u6bd4\u9884\u671f\u82b1\u8d39\u4e86\u66f4\u591a\u7684\u65f6\u95f4\u4f1a\u51fa\u73b0\u4ec0\u4e48\u60c5\u51b5\u5462\uff1f\u8fd9\u6709\u53ef\u80fd\u4f1a\u9020\u6210 \u7ade\u4e89\u5371\u5bb3 \uff0c\u4ec0\u4e48\u610f\u601d\uff1f\u5c31\u662f\u9875\u9762\u4e0a\u7684\u6570\u636e\u53ef\u80fd\u73b0\u5728\u80fd\u591f\u6e32\u67d3\u51fa\u6765\uff0c\u53e6\u5916\u4e00\u6b21\u53c8\u53ef\u80fd\u6e32\u67d3\u4e0d\u51fa\u6765(\u56e0\u4e3a\u8fd9\u4e2a\u65f6\u5019\u6570\u636e\u5728\u7ec4\u4ef6\u6302\u8f7d\u5b8c\u6210\u540e\u8fd8\u6ca1\u5b8c\u6210\u8bf7\u6c42\uff0c\u660e\u767d\u4e86\u5417\uff1f)\uff0c\u8fd9\u53d6\u51b3\u4e0e\u6211\u4eec\u7684 AJAX \u8bf7\u6c42\u662f\u5426\u80fd\u591f\u5728\u7ec4\u4ef6\u6302\u8f7d\u5b8c\u6210\u4e4b\u524d\u5b8c\u6210\u8bf7\u6c42\uff0c\u5bf9\u5427\u3002\u4e0d\u8fc7\u4e0d\u7528\u62c5\u5fc3\uff0c React \u5b9a\u4e49\u4e86\u4e00\u7cfb\u5217\u7684\u751f\u547d\u5468\u671f\u51fd\u6570\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002", 
            "title": "AJAX\u8bf7\u6c42"
        }, 
        {
            "location": "/part2/react/#_4", 
            "text": "\u57fa\u4e8e\u7c7b\u7684\u7ec4\u4ef6\u6709\u4e00\u4e2a\u7279\u5b9a\u7684\u51fd\u6570\uff0c\u5b83\u4eec\u5728\u7ec4\u4ef6\u7684\u751f\u547d\u5468\u671f\u5404\u4e2a\u9636\u6bb5\u6267\u884c\u3002\u8fd9\u4e9b\u51fd\u6570\u88ab\u79f0\u4f5c \u751f\u547d\u5468\u671f \u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u82b1\u70b9\u65f6\u95f4\u770b\u770b \u5b98\u65b9\u6587\u6863 \u6765\u7b80\u5355\u7684\u5b66\u4e60\u4e0b\u6bcf\u4e2a\u58f0\u660e\u5468\u671f\u65b9\u6cd5\uff0c\u770b\u4e0b\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u662f\u5728\u4ec0\u4e48\u5730\u65b9\u88ab\u8c03\u7528\u7684\u3002\n\u7b80\u5355\u603b\u7ed3\u4e0b\uff1a\u65b9\u6cd5\u4e2d\u5e26\u6709\u524d\u7f00 will \u7684\u5728\u7279\u5b9a\u73af\u8282\u4e4b\u524d\u88ab\u8c03\u7528\uff0c\u800c\u5e26\u6709\u524d\u7f00 did \u7684\u65b9\u6cd5\u5219\u4f1a\u5728\u7279\u5b9a\u73af\u8282\u4e4b\u540e\u88ab\u8c03\u7528\u3002   \u6302\u8f7d  \u4e0b\u9762\u8fd9\u4e9b\u65b9\u6cd5\u4f1a\u5728\u7ec4\u4ef6\u5b9e\u4f8b\u88ab\u521b\u5efa\u548c\u63d2\u5165 DOM \u4e2d\u65f6\u88ab\u8c03\u7528\uff1a   constructor()  componentWillMount()\uff1a\u4f1a\u5728\u7ec4\u4ef6 render \u4e4b\u524d\u6267\u884c\uff0c\u5e76\u4e14\u6c38\u8fdc\u90fd\u53ea\u6267\u884c\u4e00\u6b21\u3002  render()  componentDidMount()\uff1a\u4f1a\u5728\u7ec4\u4ef6\u52a0\u8f7d\u5b8c\u6bd5\u4e4b\u540e\u7acb\u5373\u6267\u884c\u3002\u8fd9\u4e2a\u65f6\u5019\u7ec4\u4ef6\u5df2\u7ecf\u751f\u6210\u4e86\u5bf9\u5e94\u7684 DOM \u7ed3\u6784     \u66f4\u65b0  \u5c5e\u6027\u6216\u8005\u72b6\u6001\u7684\u6539\u53d8\u4f1a\u89e6\u53d1\u4e00\u6b21\u66f4\u65b0\u3002\u5f53\u4e00\u4e2a\u7ec4\u4ef6\u5728\u88ab\u91cd\u65b0\u6e32\u67d3\u65f6\uff0c\u4e0b\u9762\u8fd9\u4e9b\u65b9\u6cd5\u4f1a\u88ab\u8c03\u7528\uff1a   componentWillReceiveProps()\uff1a\u5728\u7ec4\u4ef6\u63a5\u6536\u5230\u4e00\u4e2a\u65b0\u7684 prop \u65f6\u88ab\u6267\u884c  shouldComponentUpdate()  componentWillUpdate()  render()  componentDidUpdate()     \u5378\u8f7d  \u5f53\u4e00\u4e2a\u7ec4\u4ef6\u4ece DOM \u4e2d\u79fb\u9664\u65f6\uff0c\u4f1a\u8c03\u7528\u4e0b\u9762\u7684\u65b9\u6cd5\uff1a   componentWillUnmount()    \u8bf4\u4e86\u8fd9\u4e48\u591a\uff0c\u6211\u4eec\u5e94\u8be5\u5728\u54ea\u4e2a\u65b9\u6cd5\u91cc\u9762\u6765\u505a\u6211\u4eec\u7684\u7f51\u7edc\u8bf7\u6c42\u5462\uff1f\u5b9e\u9645\u4e0a ES6 \u4e2d\u7684\u6784\u9020\u51fd\u6570\u548c componentWillMount \u51fd\u6570\u662f\u4e00\u81f4\u7684\uff0c\u4e0a\u9762\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u6784\u9020\u51fd\u6570\u4e2d\u6267\u884c\u7f51\u7edc\u8bf7\u6c42\u751a\u81f3\u662f\u6240\u6709\u7684\u5f02\u6b65\u64cd\u4f5c\u90fd\u4e0d\u662f\u597d\u7684\u9009\u62e9\uff0c\u5728 componentDidMount \u51fd\u6570\u4e2d\u6267\u884c\u5f02\u6b65\u64cd\u4f5c\u662f\u6700\u597d\u7684\u65f6\u673a\uff0c\u53ef\u4ee5\u901a\u8fc7 Where to Fetch Data: componentWillMount vs componentDidMount \u4e86\u89e3\u5230\u539f\u56e0\u3002  \u66f4\u6539 client/src/index.js \u4ee3\u7801\uff0c\u5728 App \u7c7b\u4e2d\u589e\u52a0\u65b9\u6cd5\uff1a  class   App   extends   Component   { \n   constructor ()   { \n     super (); \n   }; \n   componentDidMount ()   { \n     this . getUsers (); \n   }; \n   getUsers ()   { \n     axios . get ( ` ${ process . env . REACT_APP_USERS_SERVICE_URL } /users` ) \n     . then (( res )   =   {   console . log ( res . data . data . users );   }) \n     . catch (( err )   =   {   console . log ( err );   }) \n   }; \n   render ()   { \n     return   ( \n       div   className = container \n         div   className = row \n           div   className = col-md-4 \n             br / \n             h1 All   Users /h1 \n             hr / br / \n           /div \n         /div \n       /div \n     ) \n   }  };  ReactDOM . render ( \n   App   / , \n   document . getElementById ( root )  );   \u786e\u4fdd\u4e0a\u9762\u7684 React \u5e94\u7528\u4ecd\u7136\u80fd\u591f\u6b63\u5e38\u5de5\u4f5c", 
            "title": "\u7ec4\u4ef6\u58f0\u660e\u5468\u671f"
        }, 
        {
            "location": "/part2/react/#state", 
            "text": "state \u662f React \u4e2d\u975e\u5e38\u91cd\u8981\u7684\u4e00\u4e2a\u6982\u5ff5\uff0c\u4e00\u4e2a\u7ec4\u4ef6\u7684\u663e\u793a\u5f62\u6001\u53ef\u4ee5\u7531\u5b83\u7684\u6570\u636e\u72b6\u6001\u548c\u914d\u7f6e\u53c2\u6570\u6765\u51b3\u5b9a\uff0c\u4e00\u4e2a\u7ec4\u4ef6\u53ef\u4ee5\u62e5\u6709\u81ea\u5df1\u7684\u72b6\u6001\uff0c\u72b6\u6001\u7684\u6539\u53d8\u53ef\u4ee5\u8ba9 React \u9ad8\u6548\u7684\u66f4\u65b0\u754c\u9762\u3002\n\u73b0\u5728\u6211\u4eec\u4e3a\u7ec4\u4ef6 App \u589e\u52a0\u4e00\u4e2a users \u7684\u72b6\u6001\u6570\u636e\uff0c\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 setState() \u65b9\u6cd5\u6765\u66f4\u65b0\u72b6\u6001\u6570\u636e\uff0c\u66f4\u65b0 getUsers() \u65b9\u6cd5\uff1a  getUsers ()   { \n   axios . get ( ` ${ process . env . REACT_APP_USERS_SERVICE_URL } /users` ). then ( res   =   { \n     this . setState ({ \n         users :   res . data . data . users \n     }); \n   }). catch ( err   =   { \n     console . log ( err ); \n   });  }   \u7136\u540e\u6211\u4eec\u5728\u6784\u9020\u51fd\u6570\u4e2d\u589e\u52a0\u72b6\u6001 users \uff1a  constructor ()   { \n     super (); \n     this . state   =   { \n         users :   [] \n     }  }   \u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u9ed8\u8ba4\u521d\u59cb\u5316\u7684\u65f6\u5019 users \u6570\u636e\u662f\u4e00\u4e2a\u7a7a\u6570\u7ec4\uff0c\u5728 getUsers() \u65b9\u6cd5\u8c03\u7528\u6210\u529f\u540e\uff0c\u6211\u4eec\u8c03\u7528 setState() \u65b9\u6cd5\u66f4\u65b0\u4e86 users \u72b6\u6001\u3002   \u67e5\u770b \u5b98\u65b9\u6587\u6863 \u5b66\u4e60\u6b63\u786e\u7684\u4f7f\u7528 state \u3002   \u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u66f4\u65b0 rendor() \u65b9\u6cd5\u6765\u5c06\u72b6\u6001\u6570\u636e\u6e32\u67d3\u5230\u9875\u9762\u4e2d\uff1a  render ()   { \n     return   ( \n       div   className = container \n         div   className = row \n           div   className = col-md-4 \n             br   / \n             h1 All   Users /h1 \n             hr   / br   / \n             { \n                 this . state . users . map ( user   =   { \n                     return   ( \n                         h4 \n                           key = {   user . id   } \n                           className = well \n                         {   user . username   } \n                         /h4 \n                     ) \n                 }) \n             } \n           /div \n         /div \n       /div \n     )  }   \u4e0a\u9762\u7684 render() \u51fd\u6570\uff1a   \u6211\u4eec\u5faa\u73af(\u7528\u7684 ES6\u7684map \u65b9\u6cd5) users \u72b6\u6001\u6570\u636e\uff0c\u6bcf\u6b21\u5faa\u73af\u4e2d\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684 H4 \u5143\u7d20\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u6211\u4eec\u521d\u59cb\u5316\u7684 users \u662f\u4e00\u4e2a\u7a7a\u6570\u7ec4\u7684\u539f\u56e0\uff0c\u907f\u514d\u521d\u59cb\u5316\u7684\u65f6\u5019\u51fa\u9519\u3002  \u6ce8\u610f H4 \u5143\u7d20\u4e2d\u6211\u4eec\u589e\u52a0\u4e86\u4e00\u4e2a\u5c5e\u6027 key \uff1a React \u901a\u8fc7\u8be5\u503c\u6765\u8ddf\u8e2a\u6bcf\u4e00\u4e2a\u5143\u7d20\uff0c\u6bcf\u4e2a key \u5bf9\u5e94\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u76f8\u540c\u7684 key React \u4f1a\u8ba4\u4e3a\u662f\u540c\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u8fd9\u6837\u540e\u7eed\u76f8\u540c\u7684 key \u5bf9\u5e94\u7ec4\u4ef6\u90fd\u4e0d\u4f1a\u88ab\u521b\u5efa\uff0c\u7b80\u5355\u7684\u6765\u8bf4\u5c31\u662f\u8be5\u5c5e\u6027\u662f\u7528\u6765\u4fdd\u8bc1 React \u9ad8\u6548\u7684\u4e00\u4e2a\u91cd\u8981\u6807\u8bc6\uff0c\u5728\u5faa\u73af\u4e2d\u4e00\u5b9a\u8981\u52a0\u4e0a\u8be5\u5c5e\u6027\u3002 \u67e5\u770b\u5b98\u65b9\u6587\u6863 \u4e86\u89e3\u66f4\u591a\u5173\u4e8e key \u7684\u6982\u5ff5\u3002   \u5230\u8fd9\u91cc\uff0c\u5176\u5b9e\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u770b\u5230 React \u5e94\u7528\u7684\u6548\u679c\u4e86\uff0c\u5982\u4e0b\u56fe\uff1a", 
            "title": "State\uff08\u72b6\u6001\uff09"
        }, 
        {
            "location": "/part2/react/#_5", 
            "text": "\u6211\u4eec\u77e5\u9053 React \u662f\u4e00\u4e2a\u7ec4\u4ef6\u5316\u7684\u5e93\uff0c\u6211\u4eec\u8fd9\u91cc\u53ef\u4ee5\u5c06\u7528\u6237\u5217\u8868\u505a\u6210\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u8fd9\u6837\u5176\u4ed6\u4efb\u4f55\u5730\u65b9\u8981\u4f7f\u7528\u7528\u6237\u5217\u8868\u7684\u8bdd\uff0c\u53ea\u9700\u8981\u5c06\u8fd9\u4e2a\u7ec4\u4ef6\u5f15\u5165\u5c31\u884c\u4e86\uff0c\u662f\u4e0d\u662f\u5f88\u65b9\u4fbf~~~  \u9996\u5148\u5728 src \u76ee\u5f55\u4e0b\u9762\u65b0\u5efa components \u76ee\u5f55\uff0c\u5728\u8be5\u76ee\u5f55\u4e0b\u65b0\u5efa\u6587\u4ef6\uff1a UserList.jsx \uff1a  import   React   from   react ;  const   UserList   =   ( props )   =   { \n     return   ( \n         div \n           { \n             props . users . map ( user   =   { \n               return   ( \n                 h4 \n                   key = {   user . id   } \n                   className = well \n                 {   user . username   } \n                 /h4 \n               ) \n             }) \n           } \n         /div \n     )  };  export   default   UserList ;   \u6ce8\u610f\u8fd9\u91cc\uff0c\u4e3a\u4ec0\u4e48\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u51fd\u6570\u7ec4\u4ef6\u800c\u4e0d\u662f\u57fa\u4e8e\u7c7b\u7684\u7ec4\u4ef6\u5462\uff1f\u6ce8\u610f\u5728\u8be5\u7ec4\u4ef6\u4e2d\u6211\u4eec\u4f7f\u7528 props \u4ee3\u66ff\u4e86 state \uff1a   Props \uff1a\u6570\u636e\u901a\u8fc7 props \u5411\u4e0b\u4f20\u9012\uff0c\u662f\u53ea\u8bfb\u7684  State \uff1a\u6570\u636e\u7ed1\u5b9a\u5230\u4e00\u4e2a\u7ec4\u4ef6\u4e0a\uff0c\u662f\u53ef\u8bfb\u5199\u7684    \u53ef\u4ee5\u67e5\u770b\u6587\u7ae0 ReactJS: Props vs. State \u4e86\u89e3\u66f4\u591a\u5c5e\u6027\u548c\u72b6\u6001\u7684\u533a\u522b\u3002   \u9650\u5236\u57fa\u4e8e\u7c7b\u7684\uff08\u6709\u72b6\u6001\uff09\u7ec4\u4ef6\u6570\u91cf\u662f\u4e00\u4e2a\u597d\u7684\u4e60\u60ef\uff0c\u56e0\u4e3a\u5b83\u4eec\u53ef\u4ee5\u64cd\u4f5c\u72b6\u6001\uff0c\u56e0\u4e3a\u4e0d\u592a\u53ef\u9884\u6d4b\uff0c\u4e0d\u592a\u53ef\u63a7\u5236\u3002\u5982\u679c\u4f60\u53ea\u9700\u8981\u6e32\u67d3\u6570\u636e\uff08\u5c31\u50cf\u6211\u4eec\u7684 UserList \u7ec4\u4ef6\uff09,\u4f7f\u7528\u4e00\u4e2a\u51fd\u6570\u7c7b\u7684\u7ec4\u4ef6\u662f\u4e00\u4e2a\u66f4\u597d\u7684\u9009\u62e9\u3002  \u73b0\u5728\u6211\u4eec\u9700\u8981\u5728\u7236\u7ec4\u4ef6\u4e2d\u901a\u8fc7\u72b6\u6001\u6570\u636e\u4f20\u9012\u7ed9\u5b50\u7ec4\u4ef6\uff0c\u9996\u5148\u5728 index.js \u6587\u4ef6\u4e2d\u5148\u5f15\u5165\u6211\u4eec\u7684\u7528\u6237\u5217\u8868\u7ec4\u4ef6\uff1a  import   UserList   from   ./components/UserList ;   \u7136\u540e\u66f4\u65b0 render() \u65b9\u6cd5\uff1a  render ()   { \n     return   ( \n       div   className = container \n         div   className = row \n           div   className = col-md-4 \n             br   / \n             h1 All   Users /h1 \n             hr   / br   / \n             UserList   users = { this . state . users }   / \n           /div \n         /div \n       /div \n     )  }   \u6ce8\u610f\u770b\u4e0a\u9762\u662f\u600e\u6837\u5f15\u5165\u7528\u6237\u5217\u8868\u7ec4\u4ef6\u7684\uff1a \uff0c\u8fd9\u6837 App \u7ec4\u4ef6\u5c06\u72b6\u6001\u6570\u636e users \u901a\u8fc7\u5c5e\u6027\u7684\u5f62\u5f0f\u4f20\u9012\u7ed9\u4e86\u5b50\u7ec4\u4ef6 UserList \uff0c\u7136\u540e\u5b50\u7ec4\u4ef6\u4e2d\u901a\u8fc7\u5c5e\u6027 users \u8fdb\u884c\u6570\u636e\u6e32\u67d3\uff0c\u6574\u4e2a\u6d41\u7a0b\u660e\u767d\u4e86\u5417\uff1f  \u5230\u8fd9\u91cc\u8bf7\u786e\u4fdd React \u5e94\u7528\u80fd\u591f\u6b63\u5e38\u7684\u5de5\u4f5c\uff0c\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 http://localhost:3000 \u80fd\u5f97\u5230\u4e0a\u9762\u76f8\u540c\u7684\u7ed3\u679c\uff0c\u7136\u540e\u6211\u4eec\u5bf9\u6211\u4eec\u7684\u4ee3\u7801\u8fdb\u884c\u4e00\u4e9b Review \uff0c\u7136\u540e\u63d0\u4ea4\u5230 github \u4e0a\u53bb\u3002", 
            "title": "\u7ec4\u4ef6"
        }, 
        {
            "location": "/part2/test/", 
            "text": "\u5728\u4e86\u89e3\u4e0a\u9762\u7684\u4e00\u4e9b\nReact\n\u57fa\u672c\u6982\u5ff5\u8fc7\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6765\u4f7f\u7528\nTDD\n\u7684\u601d\u60f3\u6765\u8fdb\u884c\u6211\u4eec\u5f00\u53d1\u4e86\u3002\n\n\nCreate React App\n\u9ed8\u8ba4\u4f7f\u7528\nJest\n\u8fdb\u884c\u6d4b\u8bd5\uff0c\u6240\u4ee5\u4f60\u9700\u8981\u5148\u5b89\u88c5\njest-cli\n\uff0c\u8fdb\u5165\u5230\nclient\n\u6839\u76ee\u5f55\uff1a\n\n\n$ npm install jest-cli@20.0.4 --save-dev\n\n\n\n\n\n\n\n\u6ce8\u610f\u7248\u672c\n\n\n\u5728\u5b89\u88c5\u7684\u65f6\u5019\u6700\u597d\u548c\u6211\u8fd9\u91cc\u7684\u7248\u672c\u4fdd\u6301\u4e00\u81f4\uff0c\u56e0\u4e3a\u5176\u4ed6\u7684\u7248\u672c\u53ef\u80fd\u4f1a\u6709\u5176\u4ed6\u95ee\u9898\uff0c\u5c31\u9700\u8981\u81ea\u5df1\u53bb\u8e29\u5751\u4e86\u54e6~~~\n\n\n\n\n\u53e6\u5916\u6211\u4eec\u8fd8\u9700\u8981\u4f7f\u7528\nEnzyme\n - Airbnb\u51fa\u54c1\u7684\u4e00\u4e2a\u4e13\u95e8\u7528\u4e8e\u6d4b\u8bd5\nReact\n\u7ec4\u4ef6\u7684\u975e\u5e38\u597d\u7528\u7684\u5e93\uff0c\u540c\u6837\u7684\u5b89\u88c5\nEnzyme\n\uff1a\n\n\n$ npm install --save-dev enzyme@3.1.0 enzyme-adapter-react-16@1.0.2\n\n\n\n\n\n\u4e3a\u4e86\u8ba9\nEnzyme\n\u914d\u7f6e\nReact 16\n\u7684adapter\uff0c\u5728\nsrc\n\u76ee\u5f55\u4e0b\u9762\u65b0\u589e\u4e00\u4e2a\nsetupTests.js\n\u7684\u6587\u4ef6\uff1a\n\n\nimport\n \n{\n \nconfigure\n \n}\n \nfrom\n \nenzyme\n;\n\n\nimport\n \nAdapter\n \nfrom\n \nenzyme-adapter-react-16\n;\n\n\n\nconfigure\n({\nadapter\n:\n \nnew\n \nAdapter\n()});\n\n\n\n\n\n\n\n\n\u5173\u4e8e\nEnzyme\n\u7684\u66f4\u591a\u7528\u6cd5\uff0c\u53ef\u4ee5\u524d\u5f80\n\u5b98\u65b9\u6587\u6863\n\u67e5\u770b\u3002\n\n\n\n\n\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u5c31\u53ef\u4ee5\u8fd0\u884c\u6d4b\u8bd5\u547d\u4ee4\u4e86\uff1a\n\n\n$ npm \ntest\n\nNo tests found related to files changed since last commit.\n\n\n\n\n\n\u9ed8\u8ba4\u4e0a\u9762\u7684\u6d4b\u8bd5\u547d\u4ee4\u8fd0\u884c\u5728\nwatch\n\u6a21\u5f0f\u4e0b\u9762\uff0c\u6240\u4ee5\u4f60\u6bcf\u6b21\u66f4\u6539\u4e86\u4ee3\u7801\u540e\u90fd\u4f1a\u91cd\u65b0\u6267\u884c\u4e00\u904d\u3002\n\n\n112/5000\n\u4e0eJest\u4e00\u8d77\uff0c\u6211\u4eec\u5c06\u4f7f\u7528Enzyme\uff0c\u4e00\u4e2a\u4e13\u95e8\u7528\u4e8e\u6d4b\u8bd5React\u7ec4\u4ef6\u7684\u68a6\u5e7b\u822c\u7684\u5b9e\u7528\u7a0b\u5e8f\u5e93\u3002\n\n\n\u7ec4\u4ef6\u6d4b\u8bd5\n\n\n\u5728\ncomponents\n\u6587\u4ef6\u5939\u4e0b\u9762\u65b0\u5efa\u6587\u4ef6\nUserList.test.js\n\uff1a\n\n\nimport\n \nReact\n \nfrom\n \nreact\n;\n\n\nimport\n \n{\n \nshallow\n \n}\n \nfrom\n \nenzyme\n;\n\n\nimport\n \nUserList\n \nfrom\n \n./UserList\n;\n\n\n\nconst\n \nusers\n \n=\n \n[\n\n    \n{\n\n        \nactive\n:\n \ntrue\n,\n\n        \nemail\n:\n \nicnych@gmail.com\n,\n\n        \nid\n:\n \n1\n,\n\n        \nusername\n:\n \ncnych\n\n    \n},\n \n{\n\n        \nactive\n:\n \ntrue\n,\n\n        \nemail\n:\n \nqikqiak@gmail.com\n,\n\n        \nid\n:\n \n2\n,\n\n        \nusername\n:\n \nqikqiak\n\n    \n}\n\n\n];\n\n\n\ntest\n(\nUserList renders property\n,\n \n()\n \n=\n \n{\n\n    \nconst\n \nwrapper\n \n=\n \nshallow\n(\nUserList\n \nusers\n=\n{\nusers\n}\n \n/\n);\n\n    \nconst\n \nelement\n \n=\n \nwrapper\n.\nfind\n(\nh4\n);\n\n    \nexpect\n(\nelement\n.\nlength\n).\ntoBe\n(\n2\n);\n\n    \nexpect\n(\nelement\n.\nget\n(\n0\n).\nprops\n.\nclassName\n).\ntoBe\n(\nwell\n);\n\n    \nexpect\n(\nelement\n.\nget\n(\n0\n).\nprops\n.\nchildren\n).\ntoBe\n(\ncnych\n);\n\n\n});\n\n\n\n\n\n\n\u4e0a\u9762\u7684\u6d4b\u8bd5\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u4e86\u4e00\u4e2a\nshallow\n\u7684\u65b9\u6cd5\u6765\u521b\u5efa\nUserList\n\u7ec4\u4ef6\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u5b83\u7684\u8f93\u51fa\u8fdb\u884c\u65ad\u8a00\u6d4b\u8bd5\u4e86\uff0c\u4f7f\u7528\nshallow\n\u53ef\u4ee5\u5b8c\u5168\u7684\u9694\u79bb\u7ec4\u4ef6\u8fdb\u884c\u6d4b\u8bd5\uff0c\u8fd9\u6709\u52a9\u4e8e\u5b50\u7ec4\u4ef6\u4e0d\u4f1a\u5bf9\u6d4b\u8bd5\u7ed3\u679c\u4ea7\u751f\u5f71\u54cd\u3002\n\n\n\n\n\u6709\u5173\nshallow\n\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u4ee5\u53ca\u7ec4\u4ef6\u6e32\u67d3\u7684\u5176\u4ed6\u65b9\u6cd5\uff0c\u53ef\u4ee5\u53c2\u9605\nStackOverflow \u8fd9\u7bc7\u6587\u7ae0\n\uff0c\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u5230\u5b98\u7f51\u67e5\u770b\u3002\n\n\n\n\n\u7136\u540e\u7ee7\u7eed\u8fd0\u884c\u6d4b\u8bd5\uff0c\u770b\u662f\u5426\u6b63\u5e38\u901a\u8fc7\uff1a\n\n\n$ npm run \ntest\n\n PASS  src/components/UserList.test.js\n  \u2713 UserList renders property \n(\n11ms\n)\n\n\nTest Suites: \n1\n passed, \n1\n total\nTests:       \n1\n passed, \n1\n total\nSnapshots:   \n0\n total\nTime:        \n2\n.38s\nRan all \ntest\n suites related to changed files.\n\n\n\n\n\n\u5982\u679c\u6d4b\u8bd5\u6ca1\u901a\u8fc7\uff0c\u8bf7\u68c0\u67e5\u4e0b\u6d4b\u8bd5\u4ee3\u7801\uff0c\u5df2\u7ecf\u6d4b\u8bd5\u4f9d\u8d56\u5305\u7684\u7248\u672c\u662f\u5426\u517c\u5bb9\u3002\n\n\n\u5feb\u7167\u6d4b\u8bd5\n\n\n\u4e0a\u9762\u7684\u6d4b\u8bd5\u901a\u8fc7\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u589e\u52a0\u4e00\u4e2a\u5feb\u7167\u6d4b\u8bd5\u6765\u4fdd\u8bc1\nUI\n\u754c\u9762\u4e0d\u4f1a\u6539\u53d8\u3002\u589e\u52a0\u4e0b\u9762\u7684\u4ee3\u7801\u5230\nUserList.test.js\n\u6587\u4ef6\u4e2d\uff1a\n\n\ntest\n(\nUserList renders a snapshot properly\n,\n \n()\n \n=\n \n{\n\n  \nconst\n \ntree\n \n=\n \nrenderer\n.\ncreate\n(\nUsersList\n \nusers\n=\n{\nusers\n}\n/\n).\ntoJSON\n();\n\n  \nexpect\n(\ntree\n).\ntoMatchSnapshot\n();\n\n\n});\n\n\n\n\n\n\n\u8bb0\u5f97\u5728\u6587\u4ef6\u9876\u90e8\u5bfc\u5165\nrenderer\n\uff1a\n\n\nimport\n \nrenderer\n \nfrom\n \nreact-test-renderer\n;\n\n\n\n\n\n\n\u7136\u540e\u7ee7\u7eed\u8fd0\u884c\u6d4b\u8bd5\u547d\u4ee4\uff0c\u5728\u7b2c\u4e00\u6b21\u6d4b\u8bd5\u8fd0\u884c\u65f6\uff0c\u4f1a\u5c06\u7ec4\u4ef6\u8f93\u51fa\u7684\u5feb\u7167\u4fdd\u5b58\u5230\n__snapshots__\n\u6587\u4ef6\u5939\u4e2d\u3002 \u7136\u540e\u5728\u4ee5\u540e\u7684\u6d4b\u8bd5\u4e2d\uff0c\u5c06\u65b0\u8f93\u51fa\u7684\u5feb\u7167\u4e0e\u4fdd\u5b58\u7684\u5feb\u7167\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u4e0d\u540c\uff0c\u5219\u6d4b\u8bd5\u5931\u8d25\u3002\n\n\n\u7531\u4e8e\u6d4b\u8bd5\u5728\nwatch\n\u6a21\u5f0f\u4e0b\uff0c\u6211\u4eec\u5c06\nUserList\n\u7ec4\u4ef6\u4e2d\u7684\n{user.username}\n\u66f4\u6539\u4e3a\n{user.email}\n\uff0c\u4fdd\u5b58\u540e\u89e6\u53d1\u65b0\u7684\u6d4b\u8bd5\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6d4b\u8bd5\u5931\u8d25\u4e86\uff1a\n\n\nSnapshot Summary\n \u203a \n1\n snapshot \ntest\n failed in \n1\n \ntest\n suite. Inspect your code changes or press \n`\nu\n`\n to update them.\n\nTest Suites: \n1\n failed, \n1\n total\nTests:       \n2\n failed, \n2\n total\nSnapshots:   \n1\n failed, \n1\n total\nTime:        \n1\n.609s\nRan all \ntest\n suites related to changed files.\n\n\n\n\n\n\u6839\u636e\u4e0a\u9762\u7684\u63d0\u793a\uff0c\u5982\u679c\u6211\u4eec\u7684\u76ee\u7684\u5c31\u662f\u8981\u66f4\u6539\u4e0a\u9762\u7684\u7ec4\u4ef6\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u66f4\u65b0\u5feb\u7167\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8f93\u5165\nu\n\u952e\u5373\u53ef\uff1a\n\n\nWatch Usage\n \u203a Press a to run all tests.\n \u203a Press u to update failing snapshots.\n \u203a Press p to filter by a filename regex pattern.\n \u203a Press t to filter by a \ntest\n name regex pattern.\n \u203a Press q to quit watch mode.\n \u203a Press Enter to trigger a \ntest\n run.\n\n\n\n\n\n\u8f93\u5165\nu\n\u952e\u8fc7\u540e\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5feb\u7167\u6d4b\u8bd5\u901a\u8fc7\u4e86\uff0c\u5f53\u7136\u4e86\u6211\u4eec\u8fd8\u9700\u8981\u76f8\u5e94\u7684\u66f4\u6539\u4e0a\u9762\u7ec4\u4ef6\u6d4b\u8bd5\u4e2d\u7684\u671f\u671b\u503c\uff0c\u786e\u4fdd\u6d4b\u8bd5\u901a\u8fc7\u540e\uff0c\u5c06\u6587\u4ef6\u5939\n__snapshots__\n\u52a0\u5165\u5230\n.gitignore\n\u6587\u4ef6\u4e2d\uff0c\u7136\u540e\u63d0\u4ea4\u4ee3\u7801\u3002", 
            "title": "React \u6d4b\u8bd5"
        }, 
        {
            "location": "/part2/test/#_1", 
            "text": "\u5728 components \u6587\u4ef6\u5939\u4e0b\u9762\u65b0\u5efa\u6587\u4ef6 UserList.test.js \uff1a  import   React   from   react ;  import   {   shallow   }   from   enzyme ;  import   UserList   from   ./UserList ;  const   users   =   [ \n     { \n         active :   true , \n         email :   icnych@gmail.com , \n         id :   1 , \n         username :   cnych \n     },   { \n         active :   true , \n         email :   qikqiak@gmail.com , \n         id :   2 , \n         username :   qikqiak \n     }  ];  test ( UserList renders property ,   ()   =   { \n     const   wrapper   =   shallow ( UserList   users = { users }   / ); \n     const   element   =   wrapper . find ( h4 ); \n     expect ( element . length ). toBe ( 2 ); \n     expect ( element . get ( 0 ). props . className ). toBe ( well ); \n     expect ( element . get ( 0 ). props . children ). toBe ( cnych );  });   \u4e0a\u9762\u7684\u6d4b\u8bd5\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u4e86\u4e00\u4e2a shallow \u7684\u65b9\u6cd5\u6765\u521b\u5efa UserList \u7ec4\u4ef6\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u5b83\u7684\u8f93\u51fa\u8fdb\u884c\u65ad\u8a00\u6d4b\u8bd5\u4e86\uff0c\u4f7f\u7528 shallow \u53ef\u4ee5\u5b8c\u5168\u7684\u9694\u79bb\u7ec4\u4ef6\u8fdb\u884c\u6d4b\u8bd5\uff0c\u8fd9\u6709\u52a9\u4e8e\u5b50\u7ec4\u4ef6\u4e0d\u4f1a\u5bf9\u6d4b\u8bd5\u7ed3\u679c\u4ea7\u751f\u5f71\u54cd\u3002   \u6709\u5173 shallow \u7684\u66f4\u591a\u4fe1\u606f\uff0c\u4ee5\u53ca\u7ec4\u4ef6\u6e32\u67d3\u7684\u5176\u4ed6\u65b9\u6cd5\uff0c\u53ef\u4ee5\u53c2\u9605 StackOverflow \u8fd9\u7bc7\u6587\u7ae0 \uff0c\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u5230\u5b98\u7f51\u67e5\u770b\u3002   \u7136\u540e\u7ee7\u7eed\u8fd0\u884c\u6d4b\u8bd5\uff0c\u770b\u662f\u5426\u6b63\u5e38\u901a\u8fc7\uff1a  $ npm run  test \n PASS  src/components/UserList.test.js\n  \u2713 UserList renders property  ( 11ms ) \n\nTest Suites:  1  passed,  1  total\nTests:        1  passed,  1  total\nSnapshots:    0  total\nTime:         2 .38s\nRan all  test  suites related to changed files.  \u5982\u679c\u6d4b\u8bd5\u6ca1\u901a\u8fc7\uff0c\u8bf7\u68c0\u67e5\u4e0b\u6d4b\u8bd5\u4ee3\u7801\uff0c\u5df2\u7ecf\u6d4b\u8bd5\u4f9d\u8d56\u5305\u7684\u7248\u672c\u662f\u5426\u517c\u5bb9\u3002", 
            "title": "\u7ec4\u4ef6\u6d4b\u8bd5"
        }, 
        {
            "location": "/part2/test/#_2", 
            "text": "\u4e0a\u9762\u7684\u6d4b\u8bd5\u901a\u8fc7\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u589e\u52a0\u4e00\u4e2a\u5feb\u7167\u6d4b\u8bd5\u6765\u4fdd\u8bc1 UI \u754c\u9762\u4e0d\u4f1a\u6539\u53d8\u3002\u589e\u52a0\u4e0b\u9762\u7684\u4ee3\u7801\u5230 UserList.test.js \u6587\u4ef6\u4e2d\uff1a  test ( UserList renders a snapshot properly ,   ()   =   { \n   const   tree   =   renderer . create ( UsersList   users = { users } / ). toJSON (); \n   expect ( tree ). toMatchSnapshot ();  });   \u8bb0\u5f97\u5728\u6587\u4ef6\u9876\u90e8\u5bfc\u5165 renderer \uff1a  import   renderer   from   react-test-renderer ;   \u7136\u540e\u7ee7\u7eed\u8fd0\u884c\u6d4b\u8bd5\u547d\u4ee4\uff0c\u5728\u7b2c\u4e00\u6b21\u6d4b\u8bd5\u8fd0\u884c\u65f6\uff0c\u4f1a\u5c06\u7ec4\u4ef6\u8f93\u51fa\u7684\u5feb\u7167\u4fdd\u5b58\u5230 __snapshots__ \u6587\u4ef6\u5939\u4e2d\u3002 \u7136\u540e\u5728\u4ee5\u540e\u7684\u6d4b\u8bd5\u4e2d\uff0c\u5c06\u65b0\u8f93\u51fa\u7684\u5feb\u7167\u4e0e\u4fdd\u5b58\u7684\u5feb\u7167\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u4e0d\u540c\uff0c\u5219\u6d4b\u8bd5\u5931\u8d25\u3002  \u7531\u4e8e\u6d4b\u8bd5\u5728 watch \u6a21\u5f0f\u4e0b\uff0c\u6211\u4eec\u5c06 UserList \u7ec4\u4ef6\u4e2d\u7684 {user.username} \u66f4\u6539\u4e3a {user.email} \uff0c\u4fdd\u5b58\u540e\u89e6\u53d1\u65b0\u7684\u6d4b\u8bd5\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6d4b\u8bd5\u5931\u8d25\u4e86\uff1a  Snapshot Summary\n \u203a  1  snapshot  test  failed in  1   test  suite. Inspect your code changes or press  ` u `  to update them.\n\nTest Suites:  1  failed,  1  total\nTests:        2  failed,  2  total\nSnapshots:    1  failed,  1  total\nTime:         1 .609s\nRan all  test  suites related to changed files.  \u6839\u636e\u4e0a\u9762\u7684\u63d0\u793a\uff0c\u5982\u679c\u6211\u4eec\u7684\u76ee\u7684\u5c31\u662f\u8981\u66f4\u6539\u4e0a\u9762\u7684\u7ec4\u4ef6\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u66f4\u65b0\u5feb\u7167\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8f93\u5165 u \u952e\u5373\u53ef\uff1a  Watch Usage\n \u203a Press a to run all tests.\n \u203a Press u to update failing snapshots.\n \u203a Press p to filter by a filename regex pattern.\n \u203a Press t to filter by a  test  name regex pattern.\n \u203a Press q to quit watch mode.\n \u203a Press Enter to trigger a  test  run.  \u8f93\u5165 u \u952e\u8fc7\u540e\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5feb\u7167\u6d4b\u8bd5\u901a\u8fc7\u4e86\uff0c\u5f53\u7136\u4e86\u6211\u4eec\u8fd8\u9700\u8981\u76f8\u5e94\u7684\u66f4\u6539\u4e0a\u9762\u7ec4\u4ef6\u6d4b\u8bd5\u4e2d\u7684\u671f\u671b\u503c\uff0c\u786e\u4fdd\u6d4b\u8bd5\u901a\u8fc7\u540e\uff0c\u5c06\u6587\u4ef6\u5939 __snapshots__ \u52a0\u5165\u5230 .gitignore \u6587\u4ef6\u4e2d\uff0c\u7136\u540e\u63d0\u4ea4\u4ee3\u7801\u3002", 
            "title": "\u5feb\u7167\u6d4b\u8bd5"
        }, 
        {
            "location": "/part2/form/", 
            "text": "\u8fd9\u4e00\u8282\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u6dfb\u52a0\u7528\u6237\u7684\u529f\u80fd\u7ec4\u4ef6\u3002\u5728\nclient/src/components\n\u76ee\u5f55\u4e0b\u9762\u6dfb\u52a0\u4e24\u4e2a\u65b0\u6587\u4ef6\uff1a\n\n\n\n\nAddUser.jsx\n\n\nAddUser.test.js\n\n\n\n\n\u6dfb\u52a0\u6d4b\u8bd5\u4ee3\u7801\uff1a\n\n\nimport\n \nReact\n \nfrom\n \nreact\n;\n\n\nimport\n \n{\n \nshallow\n \n}\n \nfrom\n \nenzyme\n;\n\n\nimport\n \nrenderer\n \nfrom\n \nreact-test-renderer\n;\n\n\n\nimport\n \nAddUser\n \nfrom\n \n./AddUser\n;\n\n\n\ntest\n(\nAddUser renders properly\n,\n \n()\n \n=\n \n{\n\n  \nconst\n \nwrapper\n \n=\n \nshallow\n(\nAddUser\n \n/\n);\n\n  \nconst\n \nelement\n \n=\n \nwrapper\n.\nfind\n(\nform\n);\n\n  \nexpect\n(\nelement\n.\nfind\n(\ninput\n).\nlength\n).\ntoBe\n(\n3\n);\n\n  \nexpect\n(\nelement\n.\nfind\n(\ninput\n).\nget\n(\n0\n).\nprops\n.\nname\n).\ntoBe\n(\nusername\n);\n\n  \nexpect\n(\nelement\n.\nfind\n(\ninput\n).\nget\n(\n1\n).\nprops\n.\nname\n).\ntoBe\n(\nemail\n);\n\n  \nexpect\n(\nelement\n.\nfind\n(\ninput\n).\nget\n(\n2\n).\nprops\n.\nname\n).\ntoBe\n(\nsubmit\n);\n\n\n});\n\n\n\n\n\n\n\u73b0\u5728\u8fd0\u884c\u6d4b\u8bd5\u4ee3\u7801\u80af\u5b9a\u4f1a\u62a5\u9519\u7684\uff0c\u7136\u540e\u6839\u636e\u4e0a\u9762\u6211\u4eec\u7684\u6d4b\u8bd5\u4ee3\u7801\uff0c\u6765\u7f16\u5199\nAddUser\n\u7ec4\u4ef6\u4ee3\u7801\uff1a\n\n\nimport\n \nReact\n \nfrom\n \nreact\n;\n\n\n\nconst\n \nAddUser\n \n=\n \n(\nprops\n)\n \n=\n \n{\n\n  \nreturn\n \n(\n\n    \nform\n\n      \ndiv\n \nclassName\n=\nform-group\n\n        \ninput\n\n          \ntype\n=\ntext\n \nname\n=\nusername\n\n          \nclassName\n=\nform-control input-lg\n\n          \nplaceholder\n=\nEnter a username\n\n          \nrequired\n\n        \n/\n\n      \n/div\n\n      \ndiv\n \nclassName\n=\nform-group\n\n        \ninput\n\n          \nname\n=\nemail\n\n          \nclassName\n=\nform-control input-lg\n\n          \ntype\n=\nemail\n\n          \nplaceholder\n=\nEnter an email address\n\n          \nrequired\n\n        \n/\n\n      \n/div\n\n      \ninput\n\n        \ntype\n=\nsubmit\n\n        \nclassName\n=\nbtn btn-primary btn-lg btn-block\n\n        \nvalue\n=\nSubmit\n\n      \n/\n\n    \n/form\n\n  \n);\n\n\n};\n\n\n\nexport\n \ndefault\n \nAddUser\n;\n\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u5728\nindex.js\n\u6587\u4ef6\u4e2d\u5f15\u5165\nAddUser\n\u7ec4\u4ef6\uff1a\n\n\nimport AddUser from \n./components/AddUser\n;\n\n\n\n\n\n\n\u7136\u540e\u5728\nrender()\n\u65b9\u6cd5\u4e2d\u589e\u52a0\u7ec4\u4ef6\uff1a\n\n\nrender\n()\n \n{\n\n  \nreturn\n \n(\n\n    \ndiv\n \nclassName\n=\ncontainer\n\n      \ndiv\n \nclassName\n=\nrow\n\n        \ndiv\n \nclassName\n=\ncol-md-6\n\n          \nbr\n/\n\n          \nh1\nAll\n \nUsers\n/h1\n\n          \nhr\n/\nbr\n/\n\n          \nAddUser\n/\n\n          \nbr\n/\n\n          \nUsersList\n \nusers\n=\n{\nthis\n.\nstate\n.\nusers\n}\n/\n\n        \n/div\n\n      \n/div\n\n    \n/div\n\n  \n)\n\n\n};\n\n\n\n\n\n\n\u786e\u4fdd\u6211\u4eec\u4e4b\u524d\u7684\u540e\u7aef\u670d\u52a1\u662f\u542f\u52a8\u7684\u72b6\u6001\uff1a\n\n\n$ docker-compose -f docker-compose.yml up -d --build\n\n\n\n\n\n\u7136\u540e\u5b9a\u4f4d\u5230 client \u76ee\u5f55\u4e0b\u9762\uff0c\u5148\u5bfc\u5165\u6211\u4eec\u7684\u73af\u5883\u53d8\u91cf\uff1a\n\n\n$ \nexport\n \nREACT_APP_USERS_SERVICE_URL\n=\nhttp://127.0.0.1:5001\n$ npm run start\n\n\n\n\n\n\u7136\u540e\u5728\u81ea\u52a8\u6253\u5f00\u7684\u6d4f\u89c8\u5668\u4e2d\nhttp://localhost:3000/\n\u5e94\u8be5\u80fd\u770b\u5230\u4e0b\u9762\u7684\u754c\u9762\uff1a\n\n\n\u7136\u540e\u5728\nAddUser.test.js\n\u6587\u4ef6\u4e2d\u65b0\u589e\u4e00\u4e2a\u6d4b\u8bd5\uff1a\n\n\ntest\n(\nAddUser renders a snapshot properly\n,\n \n()\n \n=\n \n{\n\n    \nconst\n \ntree\n \n=\n \nrenderer\n.\ncreate\n(\nAddUser\n/\n).\ntoJSON\n();\n\n    \nexpect\n(\ntree\n).\ntoMatchSnapshot\n();\n\n\n});\n\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u6267\u884c\u6d4b\u8bd5\uff0c\u786e\u4fdd\u6d4b\u8bd5\u80fd\u591f\u6b63\u5e38\u901a\u8fc7\n\n\n$ npm run \ntest\n\n\n\n\n\n\n\u7531\u4e8e\u8fd9\u662f\u4e00\u4e2a\u5355\u9875\u9762\u5e94\u7528\u7a0b\u5e8f\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5e0c\u671b\u5728\u63d0\u4ea4\u8868\u5355\u7684\u65f6\u5019\u963b\u6b62\u6d4f\u89c8\u5668\u5237\u65b0\u9875\u9762\uff0c\u8fd9\u6837\u7684\u7528\u6237\u4f53\u9a8c\u4f1a\u597d\u5f88\u591a\u7684\u3002\u8981\u5b8c\u6210\u8be5\u529f\u80fd\u9700\u8981\u4ee5\u4e0b4\u6b65\uff1a\n\n\n\n\n\u5904\u7406\u8868\u5355\u63d0\u4ea4\u4e8b\u4ef6\n\n\n\u83b7\u53d6\u7528\u6237\u8f93\u5165\n\n\n\u53d1\u9001\nAJAX\n\u8bf7\u6c42\n\n\n\u66f4\u65b0\u9875\u9762\n\n\n\n\n\u5904\u7406\u8868\u5355\u63d0\u4ea4\u4e8b\u4ef6\n\n\n\u4e3a\u4e86\u8ba9\u6211\u4eec\u81ea\u5df1\u80fd\u591f\u5904\u7406\nsubmit\n\u63d0\u4ea4\u4e8b\u4ef6\uff0c\u53ea\u9700\u8981\u5728\nAddUser.jsx\n\u6587\u4ef6\u4e2d\u66f4\u65b0\u4e0b\nform\n\u8868\u5355\u5143\u7d20\u5373\u53ef\uff1a\n\n\nform\n \nonSubmit\n=\n{(event)\n \n=\n event.preventDefault()}\n\n\n\n\n\n\n\u5927\u5bb6\u8bb0\u4f4f\nevent.preventDefault()\n\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u662f\u7528\u6765\u963b\u6b62\u5143\u7d20\u7684\u9ed8\u8ba4\u5904\u7406\u4e8b\u4ef6\u7684\uff0c\u4ee5\u540e\u80af\u5b9a\u4f1a\u7528\u5230\u7684\uff0c\u7136\u540e\u6211\u4eec\u968f\u610f\u8f93\u5165\u4e00\u4e2a\u7528\u6237\u540d\u6216\u90ae\u4ef6\u5730\u5740\uff0c\u7136\u540e\u5c1d\u8bd5\u63d0\u4ea4\u4e00\u6b21\u8868\u5355\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u9875\u9762\u6ca1\u6709\u4efb\u4f55\u53cd\u5e94\uff0c\u8fd9\u6b63\u662f\u6211\u4eec\u6240\u5e0c\u671b\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u963b\u6b62\u4e86\u6b63\u5e38\u7684\u4e8b\u4ef6\u884c\u4e3a\u3002\n\n\n\u7136\u540e\u6211\u4eec\u5728\nclient/src/index.js\n\u6587\u4ef6\u4e2d\uff0c\u4e3a\nApp\n\u7ec4\u4ef6\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u65b9\u6cd5\uff1a\n\n\naddUser\n(\nevent\n)\n \n{\n\n  \nevent\n.\npreventDefault\n();\n\n  \nconsole\n.\nlog\n(\nsanity check!\n);\n\n\n};\n\n\n\n\n\n\n\u7531\u4e8e AddUser \u662f\u4e00\u4e2a\u51fd\u6570\u7ec4\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u901a\u8fc7\nprops\n\u6765\u4f20\u9012\u4e0a\u9762\u7684\u6dfb\u52a0\u65b9\u6cd5\uff0c\u66f4\u65b0 render \u65b9\u6cd5\u4e0b\u9762\u7684 AddUser \u5143\u7d20\uff0c\u5982\u4e0b\u6240\u793a\uff1a\n\n\nAddUser\n \naddUser\n=\n{\nthis\n.\naddUser\n}\n \n/\n\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u9700\u8981\u66f4\u65b0 App \u7ec4\u4ef6\u7684\u6784\u9020\u51fd\u6570\uff1a\n\n\nconstructor\n()\n \n{\n\n    \nsuper\n();\n\n    \nthis\n.\nstate\n \n=\n \n{\n\n        \nusers\n:\n \n[]\n\n    \n};\n\n    \nthis\n.\naddUser\n \n=\n \nthis\n.\naddUser\n.\nbind\n(\nthis\n);\n\n\n}\n\n\n\n\n\n\n\u6ce8\u610f\u4e0a\u9762\u7684\nbind\n\u65b9\u6cd5\uff0c\u6211\u4eec\u901a\u8fc7 bind \u65b9\u6cd5\u6765\u624b\u52a8\u7ed1\u5b9a this \u7684\u4e0a\u4e0b\u6587\u3002\u5982\u679c\u6ca1\u6709\u7ed1\u5b9a\u7684\u8bdd\uff0c\u65b9\u6cd5\u5185\u7684\u4e0a\u4e0b\u6587\u662f\u4e0d\u6b63\u786e\u7684\u3002\n\n\n\n\n\u5173\u4e8b\u4ef6\u5904\u7406\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u53ef\u4ee5\u67e5\u770b React \u5173\u4e8e\u4e8b\u4ef6\u5904\u7406\u7684\n\u5b98\u65b9\u6587\u6863\n\u3002\n\n\n\n\n\u6ca1\u6709\u5b83\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5185\u7684\u4e0a\u4e0b\u6587\u5c06\u4e0d\u4f1a\u6709\u6b63\u786e\u7684\u4e0a\u4e0b\u6587\u3002 \u60f3\u8981\u6d4b\u8bd5\u8fd9\u4e2a\uff1f \u53ea\u9700\u5c06console.log\uff08this\uff09\u6dfb\u52a0\u5230addUser\uff08\uff09\uff0c\u7136\u540e\u63d0\u4ea4\u8868\u5355\u5373\u53ef\u3002 \u4ec0\u4e48\u662f\u4e0a\u4e0b\u6587\uff1f \u5220\u9664\u7ed1\u5b9a\u5e76\u518d\u6b21\u6d4b\u8bd5\u3002 \u73b0\u5728\u7684\u60c5\u51b5\u662f\u4ec0\u4e48\uff1f\n\n\n\u7136\u540e\u5728\u66f4\u65b0\nAddUser\n\u7ec4\u4ef6\u4e2d\u7684 form \u5143\u7d20\uff1a\n\n\nform\n \nonSubmit\n=\n{(\nevent\n)\n \n=\n \nprops\n.\naddUser\n(\nevent\n)}\n\n\n\n\n\n\n\u7136\u540e\u5207\u6362\u5230\u6d4f\u89c8\u5668\u4e2d\uff0c\u968f\u4fbf\u8f93\u5165\u7528\u6237\u540d\u548c\u90ae\u4ef6\uff0c\u70b9\u51fb\u63d0\u4ea4\u6309\u94ae\uff0c\u5728\nJavaScript Console\n\u7ec8\u7aef\uff08\u8fd8\u8bb0\u5f97\u600e\u4e48\u67e5\u770b\u5417\uff1f\uff09\u4e2d\u53ef\u4ee5\u770b\u5230\nsanity check!\n\u6253\u5370\u51fa\u6765\u3002\n\n\n\u83b7\u53d6\u7528\u6237\u8f93\u5165\n\n\n\u6211\u4eec\u5c06\u4f7f\u7528\n\u53d7\u63a7\u7ec4\u4ef6\n\u6765\u83b7\u53d6\u7528\u6237\u63d0\u4ea4\u7684\u6570\u636e\u3002\u5148\u589e\u52a0\u4e24\u4e2a\u65b0\u7684\u5c5e\u6027\u5728 App \u7ec4\u4ef6\u7684 state \u5bf9\u8c61\u4e0a\uff1a\n\n\nthis\n.\nstate\n \n=\n \n{\n\n  \nusers\n:\n \n[],\n\n  \nusername\n:\n \n,\n\n  \nemail\n:\n \n\n\n};\n\n\n\n\n\n\n\u7136\u540e\u901a\u8fc7\u5c5e\u6027\u4f20\u9012\u7ed9 AddUser \u7ec4\u4ef6\uff1a\n\n\nAddUser\n\n  \nusername\n=\n{\nthis\n.\nstate\n.\nusername\n}\n\n  \nemail\n=\n{\nthis\n.\nstate\n.\nemail\n}\n\n  \naddUser\n=\n{\nthis\n.\naddUser\n}\n\n\n/\n\n\n\n\n\n\n\u73b0\u5728\u6211\u4eec\u5728 AddUser \u7ec4\u4ef6\u4e2d\u5c31\u53ef\u4ee5\u901a\u8fc7\nprops\n\u6765\u8bbf\u95ee username \u548c email \u4e86\uff0c\u66f4\u65b0 AddUser \u7ec4\u4ef6\uff1a\n\n\nimport\n \nReact\n \nfrom\n \nreact\n;\n\n\n\nconst\n \nAddUser\n \n=\n \n(\nprops\n)\n \n=\n \n{\n\n    \nreturn\n \n(\n\n      \nform\n \nonSubmit\n=\n{(\nevent\n)\n \n=\n \nprops\n.\naddUser\n(\nevent\n)}\n\n          \ndiv\n \nclassName\n=\nform-group\n\n            \ninput\n\n              \ntype\n=\ntext\n \nname\n=\nusername\n\n              \nclassName\n=\nform-control input-lg\n\n              \nplaceholder\n=\nEnter a username\n\n              \nrequired\n\n              \nvalue\n=\n{\nprops\n.\nusername\n}\n\n            \n/\n\n          \n/div\n\n          \ndiv\n \nclassName\n=\nform-group\n\n            \ninput\n\n              \nname\n=\nemail\n\n              \nclassName\n=\nform-control input-lg\n\n              \ntype\n=\nemail\n\n              \nplaceholder\n=\nEnter an email address\n\n              \nrequired\n\n              \nvalue\n=\n{\nprops\n.\nemail\n}\n\n            \n/\n\n          \n/div\n\n          \ninput\n\n            \ntype\n=\nsubmit\n\n            \nclassName\n=\nbtn btn-primary btn-lg btn-block\n\n            \nvalue\n=\nSubmit\n\n          \n/\n\n        \n/form\n\n    \n);\n\n\n};\n\n\n\nexport\n \ndefault\n \nAddUser\n;\n\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5230\u6d4f\u89c8\u5668\u4e2d\u6d4b\u8bd5\u4e0b\uff0c\u968f\u610f\u8f93\u5165\u4e00\u4e9b\u503c\uff0c\u4f60\u4f1a\u53d1\u73b0\u4ec0\u4e48\u90fd\u4e0d\u80fd\u8f93\u5165\uff0c\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f\u4ed4\u7ec6\u770b\u4e0a\u9762\u7684 input \u7ec4\u4ef6\u7684 value \u503c\uff0c\u662f\u901a\u8fc7\nprops\n\u6765\u83b7\u53d6\u7684\uff0c\u800c\u4f20\u9012\u7ed9\u8be5\u7ec4\u4ef6\u7684\u503c\u662f\u901a\u8fc7\u7236\u7ec4\u4ef6\u7684 state \u4f20\u9012\u8fc7\u6765\u7684\uff0c\u56e0\u4e3a\u7236\u7ec4\u4ef6\u7684 state \u5bf9\u8c61\u4e2d\u7684 username \u548c email \u4e00\u76f4\u90fd\u662f\n\u7a7a\u5b57\u7b26\u4e32\n\uff0c\u6240\u4ee5\u6211\u4eec\u8fd9\u91cc\u7684\u8f93\u5165\u503c\u6ca1\u6709\u4efb\u4f55\u6548\u679c\u3002\n\n\n\n\n\u5c06\u7236\u7ec4\u4ef6\u4e2d\u7684 state \u5bf9\u8c61\u4e2d\u7684 username \u9ed8\u8ba4\u503c\u66f4\u6539\u6210\u5176\u4ed6\u5b57\u7b26\u4e32\uff0c\u518d\u770b\u770b\u6548\u679c\u5462?\u662f\u4e0d\u662f\u548c\u6211\u4eec\u7684\u5206\u6790\u662f\u4e00\u81f4\u7684\u3002\n\n\n\n\n\u90a3\u4e48\u6211\u4eec\u600e\u4e48\u6765\u66f4\u65b0\u7236\u7ec4\u4ef6\u4e2d\u7684\u72b6\u6001\u503c\u5462\uff0c\u8fd9\u6837\u5f53\u6211\u4eec\u5728\u8f93\u5165\u6846\u4e2d\u8f93\u5165\u6587\u672c\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u770b\u5230\u53d8\u5316\u4e86\u3002\n\n\n\u9996\u5148\uff0c\u5728 App \u7ec4\u4ef6\u4e2d\u65b0\u589e\u4e00\u4e2a\nhandleChange\n\u7684\u65b9\u6cd5\uff1a\n\n\nhandleChange\n(\nevent\n){\n\n  \nconst\n \nobj\n \n=\n \n{};\n\n  \nobj\n[\nevent\n.\ntarget\n.\nname\n]\n \n=\n \nevent\n.\ntarget\n.\nvalue\n;\n\n  \nthis\n.\nsetState\n(\nobj\n);\n\n\n}\n\n\n\n\n\n\n\u7136\u540e\u540c\u6837\u7684\uff0c\u5728\u6784\u9020\u51fd\u6570\u4e2d\u6dfb\u52a0\u4e00\u4e2a bind\uff1a\n\n\nthis\n.\nhandleChange\n \n=\n \nthis\n.\nhandleChange\n.\nbind\n(\nthis\n);\n\n\n\n\n\n\n\u7136\u540e\u901a\u8fc7\nprops\n\u5c06\u8be5\u65b9\u6cd5\u4f20\u9012\u7ed9\nAddUser\n\u7ec4\u4ef6\uff1a\n\n\nAddUser\n\n  \nusername\n=\n{\nthis\n.\nstate\n.\nusername\n}\n\n  \nemail\n=\n{\nthis\n.\nstate\n.\nemail\n}\n\n  \nhandleChange\n=\n{\nthis\n.\nhandleChange\n}\n\n  \naddUser\n=\n{\nthis\n.\naddUser\n}\n\n\n/\n\n\n\n\n\n\n\u7136\u540e\uff0c\u6211\u4eec\u5c31\u9700\u8981\u66f4\u65b0 AddUser \u7ec4\u4ef6\u4e86\uff0c\u6211\u4eec\u76d1\u542c input \u5143\u7d20\u7684 \nonChange\n \u65b9\u6cd5\uff0c\u5f53 input \u5143\u7d20\u53d1\u9001\u6539\u53d8\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u89e6\u53d1\u8be5\u8c03\u7528\uff1a\n\n\nimport\n \nReact\n \nfrom\n \nreact\n;\n\n\n\nconst\n \nAddUser\n \n=\n \n(\nprops\n)\n \n=\n \n{\n\n    \nreturn\n \n(\n\n      \nform\n \nonSubmit\n=\n{(\nevent\n)\n \n=\n \nprops\n.\naddUser\n(\nevent\n)}\n\n          \ndiv\n \nclassName\n=\nform-group\n\n            \ninput\n\n              \ntype\n=\ntext\n \nname\n=\nusername\n\n              \nclassName\n=\nform-control input-lg\n\n              \nplaceholder\n=\nEnter a username\n\n              \nrequired\n\n              \nvalue\n=\n{\nprops\n.\nusername\n}\n\n              \nonChange\n=\n{\nprops\n.\nhandleChange\n}\n\n            \n/\n\n          \n/div\n\n          \ndiv\n \nclassName\n=\nform-group\n\n            \ninput\n\n              \nname\n=\nemail\n\n              \nclassName\n=\nform-control input-lg\n\n              \ntype\n=\nemail\n\n              \nplaceholder\n=\nEnter an email address\n\n              \nrequired\n\n              \nvalue\n=\n{\nprops\n.\nemail\n}\n\n              \nonChange\n=\n{\nprops\n.\nhandleChange\n}\n\n            \n/\n\n          \n/div\n\n          \ninput\n\n            \ntype\n=\nsubmit\n\n            \nclassName\n=\nbtn btn-primary btn-lg btn-block\n\n            \nvalue\n=\nSubmit\n\n          \n/\n\n        \n/form\n\n    \n);\n\n\n};\n\n\n\nexport\n \ndefault\n \nAddUser\n;\n\n\n\n\n\n\n\u73b0\u5728\u6211\u80fd\u5728\u53bb\u6d4f\u89c8\u5668\u4e2d\u6d4b\u8bd5\u4e0b\uff0c\u5df2\u7ecf\u6b63\u5e38\u5de5\u4f5c\u4e86\u3002\u6211\u4eec\u53ef\u4ee5\u5728 addUser \u65b9\u6cd5\u4e2d\u6253\u5370\u4e0b state \u5bf9\u8c61\u7684\u503c\uff0c\u65b9\u4fbf\u6211\u4eec\u6765\u4e86\u89e3 state \u5bf9\u8c61\uff1a\n\n\naddUser\n(\nevent\n)\n \n{\n\n  \nevent\n.\npreventDefault\n();\n\n  \nconsole\n.\nlog\n(\nsanity check!\n);\n\n  \nconsole\n.\nlog\n(\nthis\n.\nstate\n);\n\n\n};\n\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5230\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165\u7528\u6237\u540d\u548c\u90ae\u4ef6\uff0c\u70b9\u51fb\u63d0\u4ea4\u6309\u94ae\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u7684 Console \u7ec8\u7aef\u4e2d\u770b\u5230\u5982\u4e0b\u7684\u4fe1\u606f\u4e86\uff1a\n\n\n\n\u73b0\u5728\u6211\u4eec\u83b7\u5f97\u4e86\u8f93\u5165\u7684\u503c\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5c31\u53ef\u4ee5\u53d1\u9001\u4e00\u4e2a\nAJAX\n\u8bf7\u6c42\uff0c\u5c06\u6211\u4eec\u7684\u8f93\u5165\u6dfb\u52a0\u5230\u6570\u636e\u5e93\u4e2d\uff0c\u7136\u540e\u66f4\u65b0 DOM \u6811...\n\n\n\u53d1\u9001 AJAX \u8bf7\u6c42\n\n\n\u8fd8\u8bb0\u5f97\u6211\u4eec\u524d\u9762\u7684 users-service \u670d\u52a1\u4e2d\u7684\nadd_user\n\u65b9\u6cd5\u5417\uff08\nproject/api/views.py\n\u6587\u4ef6\u4e0b\uff09\uff1f\u6211\u4eec\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u7528\u6237\u9700\u8981\u53d1\u9001 username \u548c email \u4e24\u9879\u6570\u636e\uff1a\n\n\ndb\n.\nsession\n.\nadd\n(\nUser\n(\nusername\n=\nusername\n,\n \nemail\n=\nemail\n))\n\n\n\n\n\n\n\u73b0\u5728\u6211\u4eec\u5728 React \u4ee3\u7801\u4e2d\u7528\nAxios\n\u6765\u53d1\u9001\u6dfb\u52a0\u7528\u6237\u7684 POST \u8bf7\u6c42\uff0c\u4fee\u6539\nclient/src/index.js\n\u4e2d App \u7ec4\u4ef6\u7684\naddUser\n\u65b9\u6cd5\uff1a\n\n\naddUser\n(\nevent\n)\n \n{\n\n  \nevent\n.\npreventDefault\n();\n\n  \nconsole\n.\nlog\n(\nsanity check!\n);\n\n  \nconst\n \ndata\n \n=\n \n{\n\n    \nusername\n:\n \nthis\n.\nstate\n.\nusername\n,\n\n    \nemail\n:\n \nthis\n.\nstate\n.\nemail\n\n  \n};\n\n  \naxios\n.\npost\n(\n`\n${\nprocess\n.\nenv\n.\nREACT_APP_USERS_SERVICE_URL\n}\n/users`\n,\n \ndata\n).\nthen\n(\nres\n \n=\n \n{\n\n    \nconsole\n.\nlog\n(\nres\n);\n\n  \n}).\ncatch\n(\nerr\n \n=\n \n{\n\n    \nconsole\n.\nlog\n(\nerr\n);\n\n  \n});\n\n\n}\n\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u5207\u6362\u5230\u6d4f\u89c8\u5668\u4e2d\u6dfb\u52a0\u4e00\u6761\u6570\u636e\uff0c\u53ea\u8981\u8f93\u5165\u7684 email \u5730\u5740\u662f\u552f\u4e00\u7684\uff0c\u6d4b\u8bd5\u5e94\u8be5\u90fd\u4f1a\u901a\u8fc7\u7684\u3002\u5982\u679c\u6211\u4eec\u8fde\u7eed\u70b9\u51fb\u63d0\u4ea4\u4e24\u6b21\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u770b\u5230\u5728 Chrome \u6d4f\u89c8\u5668\u7684\u7ec8\u7aef\u4e2d\u770b\u5230\u6709\u4e00\u4e2a\n400\n\u7684\u9519\u8bef\u7801\u6253\u5370\u51fa\u6765\uff0c\u56e0\u4e3a\u6211\u4eec\u7b2c\u4e8c\u6b21\u63d0\u4ea4\u7684 email \u90ae\u7bb1\u5df2\u7ecf\u5b58\u5728\u4e86\uff0c\u800c\u6211\u4eec\u524d\u9762\u7684\nusers-service\n\u670d\u52a1\u5728 email \u5b58\u5728\u7684\u60c5\u51b5\u4e0b\u4f1a\u8fd4\u56de 400 \u72b6\u6001\u7801\u3002\n\n\n\n\u66f4\u65b0\u9875\u9762\n\n\n\u6700\u540e\u5f53\u6dfb\u52a0\u7528\u6237\u7684\u8868\u5355\u63d0\u4ea4\u6210\u529f\u540e\u6211\u4eec\u6765\u66f4\u65b0\u7528\u6237\u5217\u8868\uff0c\u5e76\u4e14\u6e05\u7a7a\u8868\u5355\uff0c\u540c\u6837\u66f4\u65b0\naddUser\n\u65b9\u6cd5\uff1a\n\n\naddUser\n(\nevent\n)\n \n{\n\n  \nevent\n.\npreventDefault\n();\n\n  \nconsole\n.\nlog\n(\nsanity check!\n);\n\n  \nconst\n \ndata\n \n=\n \n{\n\n    \nusername\n:\n \nthis\n.\nstate\n.\nusername\n,\n\n    \nemail\n:\n \nthis\n.\nstate\n.\nemail\n\n  \n};\n\n  \naxios\n.\npost\n(\n`\n${\nprocess\n.\nenv\n.\nREACT_APP_USERS_SERVICE_URL\n}\n/users`\n,\n \ndata\n).\nthen\n(\nres\n \n=\n \n{\n\n    \nthis\n.\ngetUsers\n();\n\n    \nthis\n.\nsetState\n({\n \nusername\n:\n \n,\n \nemail\n:\n \n \n});\n\n  \n}).\ncatch\n(\nerr\n \n=\n \n{\n\n    \nconsole\n.\nlog\n(\nerr\n);\n\n  \n});\n\n\n}\n\n\n\n\n\n\n\u6211\u4eec\u524d\u9762\u77e5\u9053\u83b7\u53d6\u7528\u6237\u5217\u8868\u662f\u901a\u8fc7\ngetUsers()\n\u65b9\u6cd5\u7684\uff0c\u6240\u4ee5\u5f53\u6211\u4eec\u6dfb\u52a0\u7528\u6237\u7684\u8bf7\u6c42\u53d1\u9001\u6210\u529f\u540e\uff0c\u662f\u4e0d\u662f\u91cd\u65b0\u8bf7\u6c42\u4e0b\ngetUsrs()\n\u65b9\u6cd5\uff0c\u662f\u4e0d\u662f\u5c31\u80fd\u591f\u628a\u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709\u7528\u6237\u83b7\u53d6\u5230\u4e86\u554a\uff1f\u8981\u6e05\u7a7a\u8868\u5355\u8be5\u600e\u4e48\u505a\u5462\uff1f\u5f53\u7136\u662f\u64cd\u4f5c\u72b6\u6001\u4e86\uff0c\u6211\u4eec\u77e5\u9053\u53ea\u9700\u8981\u66f4\u6539 state \u5bf9\u8c61\u4e0b\u7684 username \u548c email\uff0c\u5bf9\u5e94\u7684\u5143\u7d20\u5c31\u4f1a\u53d1\u9001\u53d8\u5316\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u81ea\u5df1\u624b\u52a8\u53bb\u66f4\u65b0 DOM \u5143\u7d20\uff0c\u53ea\u9700\u8981\u64cd\u4f5c state \u5c31\u884c\uff0c\u662f\u4e0d\u662f\u5f88\u65b9\u4fbf\u4e86\u554a\uff1f\n\n\n\u7136\u540e\u6211\u4eec\u5207\u6362\u5230\u6d4f\u89c8\u5668\u4e2d\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u6dfb\u52a0\u4e00\u4e2a\u552f\u4e00\u7684\u90ae\u7bb1\uff0c\u662f\u4e0d\u662f\u63d0\u4ea4\u5b8c\u6210\u540e\u4e0b\u9762\u7684\u5217\u8868\u4e5f\u66f4\u65b0\u4e86\uff0c\u8868\u5355\u4e5f\u6e05\u7a7a\u4e86\u3002\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u8fd0\u884c\u4e0b\u6211\u4eec\u7684\u6d4b\u8bd5\u4ee3\u7801\uff1a\n\n\n$ npm run \ntest\n\n\n\n\n\n\n\u6211\u4eec\u4f1a\u53d1\u73b0\u6d4b\u8bd5\u662f\u6ca1\u6709\u901a\u8fc7\u7684\uff0c\u51fa\u73b0\u4e0b\u9762\u7684\u9519\u8bef\u63d0\u793a\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u7684 UI \u754c\u9762\u5df2\u7ecf\u53d1\u751f\u4e86\u6539\u53d8\uff0c\u548c\u4e4b\u524d\u6211\u4eec\u7684\u5feb\u7167\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ea\u9700\u8981\u8f93\u5165\nu\n\u66f4\u65b0\u4e0b\u5feb\u7167\u5373\u53ef\u3002\n\n\nSnapshot Summary\n \u203a \n1\n snapshot \ntest\n failed in \n1\n \ntest\n suite. Inspect your code changes or press \n`\nu\n`\n to update them.\n\n\n\n\n\n\u5feb\u7167\u66f4\u65b0\u540e\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u6d4b\u8bd5\u4ee3\u7801\u90fd\u4f1a\u901a\u8fc7\u7684\u3002\u5982\u679c\u6709\u5176\u4ed6\u95ee\u9898\uff0c\u8bf7\u4ed4\u7ec6\u67e5\u770b\u4e0b\u9519\u8bef\u65e5\u5fd7\uff0c\u4ed4\u7ec6\u6392\u67e5\uff0c\u7136\u540e\u63d0\u4ea4\u4ee3\u7801\u5230\ngithub\n\u3002", 
            "title": "React \u8868\u5355"
        }, 
        {
            "location": "/part2/form/#_1", 
            "text": "\u4e3a\u4e86\u8ba9\u6211\u4eec\u81ea\u5df1\u80fd\u591f\u5904\u7406 submit \u63d0\u4ea4\u4e8b\u4ef6\uff0c\u53ea\u9700\u8981\u5728 AddUser.jsx \u6587\u4ef6\u4e2d\u66f4\u65b0\u4e0b form \u8868\u5355\u5143\u7d20\u5373\u53ef\uff1a  form   onSubmit = {(event)   =  event.preventDefault()}   \u5927\u5bb6\u8bb0\u4f4f event.preventDefault() \u8fd9\u4e2a\u65b9\u6cd5\uff0c\u662f\u7528\u6765\u963b\u6b62\u5143\u7d20\u7684\u9ed8\u8ba4\u5904\u7406\u4e8b\u4ef6\u7684\uff0c\u4ee5\u540e\u80af\u5b9a\u4f1a\u7528\u5230\u7684\uff0c\u7136\u540e\u6211\u4eec\u968f\u610f\u8f93\u5165\u4e00\u4e2a\u7528\u6237\u540d\u6216\u90ae\u4ef6\u5730\u5740\uff0c\u7136\u540e\u5c1d\u8bd5\u63d0\u4ea4\u4e00\u6b21\u8868\u5355\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u9875\u9762\u6ca1\u6709\u4efb\u4f55\u53cd\u5e94\uff0c\u8fd9\u6b63\u662f\u6211\u4eec\u6240\u5e0c\u671b\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u963b\u6b62\u4e86\u6b63\u5e38\u7684\u4e8b\u4ef6\u884c\u4e3a\u3002  \u7136\u540e\u6211\u4eec\u5728 client/src/index.js \u6587\u4ef6\u4e2d\uff0c\u4e3a App \u7ec4\u4ef6\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u65b9\u6cd5\uff1a  addUser ( event )   { \n   event . preventDefault (); \n   console . log ( sanity check! );  };   \u7531\u4e8e AddUser \u662f\u4e00\u4e2a\u51fd\u6570\u7ec4\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u901a\u8fc7 props \u6765\u4f20\u9012\u4e0a\u9762\u7684\u6dfb\u52a0\u65b9\u6cd5\uff0c\u66f4\u65b0 render \u65b9\u6cd5\u4e0b\u9762\u7684 AddUser \u5143\u7d20\uff0c\u5982\u4e0b\u6240\u793a\uff1a  AddUser   addUser = { this . addUser }   /   \u7136\u540e\u6211\u4eec\u9700\u8981\u66f4\u65b0 App \u7ec4\u4ef6\u7684\u6784\u9020\u51fd\u6570\uff1a  constructor ()   { \n     super (); \n     this . state   =   { \n         users :   [] \n     }; \n     this . addUser   =   this . addUser . bind ( this );  }   \u6ce8\u610f\u4e0a\u9762\u7684 bind \u65b9\u6cd5\uff0c\u6211\u4eec\u901a\u8fc7 bind \u65b9\u6cd5\u6765\u624b\u52a8\u7ed1\u5b9a this \u7684\u4e0a\u4e0b\u6587\u3002\u5982\u679c\u6ca1\u6709\u7ed1\u5b9a\u7684\u8bdd\uff0c\u65b9\u6cd5\u5185\u7684\u4e0a\u4e0b\u6587\u662f\u4e0d\u6b63\u786e\u7684\u3002   \u5173\u4e8b\u4ef6\u5904\u7406\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u53ef\u4ee5\u67e5\u770b React \u5173\u4e8e\u4e8b\u4ef6\u5904\u7406\u7684 \u5b98\u65b9\u6587\u6863 \u3002   \u6ca1\u6709\u5b83\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5185\u7684\u4e0a\u4e0b\u6587\u5c06\u4e0d\u4f1a\u6709\u6b63\u786e\u7684\u4e0a\u4e0b\u6587\u3002 \u60f3\u8981\u6d4b\u8bd5\u8fd9\u4e2a\uff1f \u53ea\u9700\u5c06console.log\uff08this\uff09\u6dfb\u52a0\u5230addUser\uff08\uff09\uff0c\u7136\u540e\u63d0\u4ea4\u8868\u5355\u5373\u53ef\u3002 \u4ec0\u4e48\u662f\u4e0a\u4e0b\u6587\uff1f \u5220\u9664\u7ed1\u5b9a\u5e76\u518d\u6b21\u6d4b\u8bd5\u3002 \u73b0\u5728\u7684\u60c5\u51b5\u662f\u4ec0\u4e48\uff1f  \u7136\u540e\u5728\u66f4\u65b0 AddUser \u7ec4\u4ef6\u4e2d\u7684 form \u5143\u7d20\uff1a  form   onSubmit = {( event )   =   props . addUser ( event )}   \u7136\u540e\u5207\u6362\u5230\u6d4f\u89c8\u5668\u4e2d\uff0c\u968f\u4fbf\u8f93\u5165\u7528\u6237\u540d\u548c\u90ae\u4ef6\uff0c\u70b9\u51fb\u63d0\u4ea4\u6309\u94ae\uff0c\u5728 JavaScript Console \u7ec8\u7aef\uff08\u8fd8\u8bb0\u5f97\u600e\u4e48\u67e5\u770b\u5417\uff1f\uff09\u4e2d\u53ef\u4ee5\u770b\u5230 sanity check! \u6253\u5370\u51fa\u6765\u3002", 
            "title": "\u5904\u7406\u8868\u5355\u63d0\u4ea4\u4e8b\u4ef6"
        }, 
        {
            "location": "/part2/form/#_2", 
            "text": "\u6211\u4eec\u5c06\u4f7f\u7528 \u53d7\u63a7\u7ec4\u4ef6 \u6765\u83b7\u53d6\u7528\u6237\u63d0\u4ea4\u7684\u6570\u636e\u3002\u5148\u589e\u52a0\u4e24\u4e2a\u65b0\u7684\u5c5e\u6027\u5728 App \u7ec4\u4ef6\u7684 state \u5bf9\u8c61\u4e0a\uff1a  this . state   =   { \n   users :   [], \n   username :   , \n   email :    };   \u7136\u540e\u901a\u8fc7\u5c5e\u6027\u4f20\u9012\u7ed9 AddUser \u7ec4\u4ef6\uff1a  AddUser \n   username = { this . state . username } \n   email = { this . state . email } \n   addUser = { this . addUser }  /   \u73b0\u5728\u6211\u4eec\u5728 AddUser \u7ec4\u4ef6\u4e2d\u5c31\u53ef\u4ee5\u901a\u8fc7 props \u6765\u8bbf\u95ee username \u548c email \u4e86\uff0c\u66f4\u65b0 AddUser \u7ec4\u4ef6\uff1a  import   React   from   react ;  const   AddUser   =   ( props )   =   { \n     return   ( \n       form   onSubmit = {( event )   =   props . addUser ( event )} \n           div   className = form-group \n             input \n               type = text   name = username \n               className = form-control input-lg \n               placeholder = Enter a username \n               required \n               value = { props . username } \n             / \n           /div \n           div   className = form-group \n             input \n               name = email \n               className = form-control input-lg \n               type = email \n               placeholder = Enter an email address \n               required \n               value = { props . email } \n             / \n           /div \n           input \n             type = submit \n             className = btn btn-primary btn-lg btn-block \n             value = Submit \n           / \n         /form \n     );  };  export   default   AddUser ;   \u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5230\u6d4f\u89c8\u5668\u4e2d\u6d4b\u8bd5\u4e0b\uff0c\u968f\u610f\u8f93\u5165\u4e00\u4e9b\u503c\uff0c\u4f60\u4f1a\u53d1\u73b0\u4ec0\u4e48\u90fd\u4e0d\u80fd\u8f93\u5165\uff0c\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f\u4ed4\u7ec6\u770b\u4e0a\u9762\u7684 input \u7ec4\u4ef6\u7684 value \u503c\uff0c\u662f\u901a\u8fc7 props \u6765\u83b7\u53d6\u7684\uff0c\u800c\u4f20\u9012\u7ed9\u8be5\u7ec4\u4ef6\u7684\u503c\u662f\u901a\u8fc7\u7236\u7ec4\u4ef6\u7684 state \u4f20\u9012\u8fc7\u6765\u7684\uff0c\u56e0\u4e3a\u7236\u7ec4\u4ef6\u7684 state \u5bf9\u8c61\u4e2d\u7684 username \u548c email \u4e00\u76f4\u90fd\u662f \u7a7a\u5b57\u7b26\u4e32 \uff0c\u6240\u4ee5\u6211\u4eec\u8fd9\u91cc\u7684\u8f93\u5165\u503c\u6ca1\u6709\u4efb\u4f55\u6548\u679c\u3002   \u5c06\u7236\u7ec4\u4ef6\u4e2d\u7684 state \u5bf9\u8c61\u4e2d\u7684 username \u9ed8\u8ba4\u503c\u66f4\u6539\u6210\u5176\u4ed6\u5b57\u7b26\u4e32\uff0c\u518d\u770b\u770b\u6548\u679c\u5462?\u662f\u4e0d\u662f\u548c\u6211\u4eec\u7684\u5206\u6790\u662f\u4e00\u81f4\u7684\u3002   \u90a3\u4e48\u6211\u4eec\u600e\u4e48\u6765\u66f4\u65b0\u7236\u7ec4\u4ef6\u4e2d\u7684\u72b6\u6001\u503c\u5462\uff0c\u8fd9\u6837\u5f53\u6211\u4eec\u5728\u8f93\u5165\u6846\u4e2d\u8f93\u5165\u6587\u672c\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u770b\u5230\u53d8\u5316\u4e86\u3002  \u9996\u5148\uff0c\u5728 App \u7ec4\u4ef6\u4e2d\u65b0\u589e\u4e00\u4e2a handleChange \u7684\u65b9\u6cd5\uff1a  handleChange ( event ){ \n   const   obj   =   {}; \n   obj [ event . target . name ]   =   event . target . value ; \n   this . setState ( obj );  }   \u7136\u540e\u540c\u6837\u7684\uff0c\u5728\u6784\u9020\u51fd\u6570\u4e2d\u6dfb\u52a0\u4e00\u4e2a bind\uff1a  this . handleChange   =   this . handleChange . bind ( this );   \u7136\u540e\u901a\u8fc7 props \u5c06\u8be5\u65b9\u6cd5\u4f20\u9012\u7ed9 AddUser \u7ec4\u4ef6\uff1a  AddUser \n   username = { this . state . username } \n   email = { this . state . email } \n   handleChange = { this . handleChange } \n   addUser = { this . addUser }  /   \u7136\u540e\uff0c\u6211\u4eec\u5c31\u9700\u8981\u66f4\u65b0 AddUser \u7ec4\u4ef6\u4e86\uff0c\u6211\u4eec\u76d1\u542c input \u5143\u7d20\u7684  onChange  \u65b9\u6cd5\uff0c\u5f53 input \u5143\u7d20\u53d1\u9001\u6539\u53d8\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u89e6\u53d1\u8be5\u8c03\u7528\uff1a  import   React   from   react ;  const   AddUser   =   ( props )   =   { \n     return   ( \n       form   onSubmit = {( event )   =   props . addUser ( event )} \n           div   className = form-group \n             input \n               type = text   name = username \n               className = form-control input-lg \n               placeholder = Enter a username \n               required \n               value = { props . username } \n               onChange = { props . handleChange } \n             / \n           /div \n           div   className = form-group \n             input \n               name = email \n               className = form-control input-lg \n               type = email \n               placeholder = Enter an email address \n               required \n               value = { props . email } \n               onChange = { props . handleChange } \n             / \n           /div \n           input \n             type = submit \n             className = btn btn-primary btn-lg btn-block \n             value = Submit \n           / \n         /form \n     );  };  export   default   AddUser ;   \u73b0\u5728\u6211\u80fd\u5728\u53bb\u6d4f\u89c8\u5668\u4e2d\u6d4b\u8bd5\u4e0b\uff0c\u5df2\u7ecf\u6b63\u5e38\u5de5\u4f5c\u4e86\u3002\u6211\u4eec\u53ef\u4ee5\u5728 addUser \u65b9\u6cd5\u4e2d\u6253\u5370\u4e0b state \u5bf9\u8c61\u7684\u503c\uff0c\u65b9\u4fbf\u6211\u4eec\u6765\u4e86\u89e3 state \u5bf9\u8c61\uff1a  addUser ( event )   { \n   event . preventDefault (); \n   console . log ( sanity check! ); \n   console . log ( this . state );  };   \u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5230\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165\u7528\u6237\u540d\u548c\u90ae\u4ef6\uff0c\u70b9\u51fb\u63d0\u4ea4\u6309\u94ae\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u7684 Console \u7ec8\u7aef\u4e2d\u770b\u5230\u5982\u4e0b\u7684\u4fe1\u606f\u4e86\uff1a  \u73b0\u5728\u6211\u4eec\u83b7\u5f97\u4e86\u8f93\u5165\u7684\u503c\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5c31\u53ef\u4ee5\u53d1\u9001\u4e00\u4e2a AJAX \u8bf7\u6c42\uff0c\u5c06\u6211\u4eec\u7684\u8f93\u5165\u6dfb\u52a0\u5230\u6570\u636e\u5e93\u4e2d\uff0c\u7136\u540e\u66f4\u65b0 DOM \u6811...", 
            "title": "\u83b7\u53d6\u7528\u6237\u8f93\u5165"
        }, 
        {
            "location": "/part2/form/#ajax", 
            "text": "\u8fd8\u8bb0\u5f97\u6211\u4eec\u524d\u9762\u7684 users-service \u670d\u52a1\u4e2d\u7684 add_user \u65b9\u6cd5\u5417\uff08 project/api/views.py \u6587\u4ef6\u4e0b\uff09\uff1f\u6211\u4eec\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u7528\u6237\u9700\u8981\u53d1\u9001 username \u548c email \u4e24\u9879\u6570\u636e\uff1a  db . session . add ( User ( username = username ,   email = email ))   \u73b0\u5728\u6211\u4eec\u5728 React \u4ee3\u7801\u4e2d\u7528 Axios \u6765\u53d1\u9001\u6dfb\u52a0\u7528\u6237\u7684 POST \u8bf7\u6c42\uff0c\u4fee\u6539 client/src/index.js \u4e2d App \u7ec4\u4ef6\u7684 addUser \u65b9\u6cd5\uff1a  addUser ( event )   { \n   event . preventDefault (); \n   console . log ( sanity check! ); \n   const   data   =   { \n     username :   this . state . username , \n     email :   this . state . email \n   }; \n   axios . post ( ` ${ process . env . REACT_APP_USERS_SERVICE_URL } /users` ,   data ). then ( res   =   { \n     console . log ( res ); \n   }). catch ( err   =   { \n     console . log ( err ); \n   });  }   \u7136\u540e\u6211\u4eec\u5207\u6362\u5230\u6d4f\u89c8\u5668\u4e2d\u6dfb\u52a0\u4e00\u6761\u6570\u636e\uff0c\u53ea\u8981\u8f93\u5165\u7684 email \u5730\u5740\u662f\u552f\u4e00\u7684\uff0c\u6d4b\u8bd5\u5e94\u8be5\u90fd\u4f1a\u901a\u8fc7\u7684\u3002\u5982\u679c\u6211\u4eec\u8fde\u7eed\u70b9\u51fb\u63d0\u4ea4\u4e24\u6b21\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u770b\u5230\u5728 Chrome \u6d4f\u89c8\u5668\u7684\u7ec8\u7aef\u4e2d\u770b\u5230\u6709\u4e00\u4e2a 400 \u7684\u9519\u8bef\u7801\u6253\u5370\u51fa\u6765\uff0c\u56e0\u4e3a\u6211\u4eec\u7b2c\u4e8c\u6b21\u63d0\u4ea4\u7684 email \u90ae\u7bb1\u5df2\u7ecf\u5b58\u5728\u4e86\uff0c\u800c\u6211\u4eec\u524d\u9762\u7684 users-service \u670d\u52a1\u5728 email \u5b58\u5728\u7684\u60c5\u51b5\u4e0b\u4f1a\u8fd4\u56de 400 \u72b6\u6001\u7801\u3002", 
            "title": "\u53d1\u9001 AJAX \u8bf7\u6c42"
        }, 
        {
            "location": "/part2/form/#_3", 
            "text": "\u6700\u540e\u5f53\u6dfb\u52a0\u7528\u6237\u7684\u8868\u5355\u63d0\u4ea4\u6210\u529f\u540e\u6211\u4eec\u6765\u66f4\u65b0\u7528\u6237\u5217\u8868\uff0c\u5e76\u4e14\u6e05\u7a7a\u8868\u5355\uff0c\u540c\u6837\u66f4\u65b0 addUser \u65b9\u6cd5\uff1a  addUser ( event )   { \n   event . preventDefault (); \n   console . log ( sanity check! ); \n   const   data   =   { \n     username :   this . state . username , \n     email :   this . state . email \n   }; \n   axios . post ( ` ${ process . env . REACT_APP_USERS_SERVICE_URL } /users` ,   data ). then ( res   =   { \n     this . getUsers (); \n     this . setState ({   username :   ,   email :     }); \n   }). catch ( err   =   { \n     console . log ( err ); \n   });  }   \u6211\u4eec\u524d\u9762\u77e5\u9053\u83b7\u53d6\u7528\u6237\u5217\u8868\u662f\u901a\u8fc7 getUsers() \u65b9\u6cd5\u7684\uff0c\u6240\u4ee5\u5f53\u6211\u4eec\u6dfb\u52a0\u7528\u6237\u7684\u8bf7\u6c42\u53d1\u9001\u6210\u529f\u540e\uff0c\u662f\u4e0d\u662f\u91cd\u65b0\u8bf7\u6c42\u4e0b getUsrs() \u65b9\u6cd5\uff0c\u662f\u4e0d\u662f\u5c31\u80fd\u591f\u628a\u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709\u7528\u6237\u83b7\u53d6\u5230\u4e86\u554a\uff1f\u8981\u6e05\u7a7a\u8868\u5355\u8be5\u600e\u4e48\u505a\u5462\uff1f\u5f53\u7136\u662f\u64cd\u4f5c\u72b6\u6001\u4e86\uff0c\u6211\u4eec\u77e5\u9053\u53ea\u9700\u8981\u66f4\u6539 state \u5bf9\u8c61\u4e0b\u7684 username \u548c email\uff0c\u5bf9\u5e94\u7684\u5143\u7d20\u5c31\u4f1a\u53d1\u9001\u53d8\u5316\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u81ea\u5df1\u624b\u52a8\u53bb\u66f4\u65b0 DOM \u5143\u7d20\uff0c\u53ea\u9700\u8981\u64cd\u4f5c state \u5c31\u884c\uff0c\u662f\u4e0d\u662f\u5f88\u65b9\u4fbf\u4e86\u554a\uff1f  \u7136\u540e\u6211\u4eec\u5207\u6362\u5230\u6d4f\u89c8\u5668\u4e2d\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u6dfb\u52a0\u4e00\u4e2a\u552f\u4e00\u7684\u90ae\u7bb1\uff0c\u662f\u4e0d\u662f\u63d0\u4ea4\u5b8c\u6210\u540e\u4e0b\u9762\u7684\u5217\u8868\u4e5f\u66f4\u65b0\u4e86\uff0c\u8868\u5355\u4e5f\u6e05\u7a7a\u4e86\u3002\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u8fd0\u884c\u4e0b\u6211\u4eec\u7684\u6d4b\u8bd5\u4ee3\u7801\uff1a  $ npm run  test   \u6211\u4eec\u4f1a\u53d1\u73b0\u6d4b\u8bd5\u662f\u6ca1\u6709\u901a\u8fc7\u7684\uff0c\u51fa\u73b0\u4e0b\u9762\u7684\u9519\u8bef\u63d0\u793a\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u7684 UI \u754c\u9762\u5df2\u7ecf\u53d1\u751f\u4e86\u6539\u53d8\uff0c\u548c\u4e4b\u524d\u6211\u4eec\u7684\u5feb\u7167\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ea\u9700\u8981\u8f93\u5165 u \u66f4\u65b0\u4e0b\u5feb\u7167\u5373\u53ef\u3002  Snapshot Summary\n \u203a  1  snapshot  test  failed in  1   test  suite. Inspect your code changes or press  ` u `  to update them.  \u5feb\u7167\u66f4\u65b0\u540e\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u6d4b\u8bd5\u4ee3\u7801\u90fd\u4f1a\u901a\u8fc7\u7684\u3002\u5982\u679c\u6709\u5176\u4ed6\u95ee\u9898\uff0c\u8bf7\u4ed4\u7ec6\u67e5\u770b\u4e0b\u9519\u8bef\u65e5\u5fd7\uff0c\u4ed4\u7ec6\u6392\u67e5\uff0c\u7136\u540e\u63d0\u4ea4\u4ee3\u7801\u5230 github \u3002", 
            "title": "\u66f4\u65b0\u9875\u9762"
        }, 
        {
            "location": "/part2/docker/", 
            "text": "\u8fd9\u8282\u8bfe\u8ba9\u6211\u4eec\u6765\u5bb9\u5668\u5316\u4e0a\u9762\u5b8c\u6210\u7684 React \u5e94\u7528\u3002\u4e0d\u8fc7\u5728\u5f00\u59cb\u524d\uff0c\u6211\u4eec\u5148\u91cd\u6784\u4e0b\u6211\u4eec\u7684\u9879\u76ee\u5427\u3002\n\n\n\u91cd\u6784\n\n\n\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u9762\u65b0\u589e\u4e00\u4e2a\u53eb\nservices\n\u7684\u6587\u4ef6\u5939\uff0c\u7136\u540e\u5c06\nnginx\n\u6587\u4ef6\u5939\u79fb\u52a8\u5230 services \u76ee\u5f55\u4e0b\u9762\uff0c\u5c06\nclient\n\u6587\u4ef6\u5939\u79fb\u52a8\u5230 services \u76ee\u5f55\u4e0b\u9762\uff0c\u7136\u540e\u5728 services \u76ee\u5f55\u4e0b\u9762\u65b0\u5efa\u4e00\u4e2a \nusers\n\u6587\u4ef6\u5939\uff0c\u5c06\u6839\u76ee\u5f55\u4e0b\u9762\u7684\nproject\n\u6587\u4ef6\u5939\u3001Dockerfile\u3001manage.py\u3001requirements.txt \u6587\u4ef6\u90fd\u79fb\u52a8\u5230\nservices/users\n\u76ee\u5f55\u4e0b\u9762\uff0c\u64cd\u4f5c\u5b8c\u6210\u540e\uff0c\u4f60\u770b\u5230\u7684\u6211\u4eec\u7684\u4ee3\u7801\u7ed3\u6784\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a\n\n\n$ flask-microservices-users \n[\nmaster\n]\n \u26a1 ls -la\ntotal \n88\n\ndrwxr-xr-x  \n12\n ych  staff    \n384\n  \n1\n \n26\n \n12\n:12 .\ndrwxr-xr-x   \n4\n ych  staff    \n128\n \n12\n \n28\n \n16\n:08 ..\ndrwxr-xr-x  \n14\n ych  staff    \n448\n  \n1\n \n26\n \n12\n:27 .git\n-rw-r--r--   \n1\n ych  staff     \n23\n  \n1\n  \n5\n \n17\n:56 .gitignore\n-rw-r--r--   \n1\n ych  staff      \n5\n \n12\n \n28\n \n15\n:19 .python-version\n-rw-r--r--   \n1\n ych  staff    \n645\n  \n1\n  \n5\n \n18\n:13 .travis.yml\n-rw-r--r--   \n1\n ych  staff  \n11357\n \n12\n \n29\n \n10\n:44 LICENSE\n-rw-r--r--   \n1\n ych  staff    \n206\n  \n1\n  \n5\n \n18\n:23 README.md\n-rw-r--r--   \n1\n ych  staff    \n922\n  \n1\n \n26\n \n12\n:11 docker-compose-prod.yml\n-rw-r--r--   \n1\n ych  staff    \n755\n  \n1\n \n26\n \n12\n:15 docker-compose.yml\ndrwxr-xr-x   \n6\n ych  staff    \n192\n  \n1\n \n26\n \n12\n:09 services\n$ flask-microservices-users \n[\nmaster\n]\n \u26a1 ls -la services\ntotal \n16\n\ndrwxr-xr-x   \n6\n ych  staff   \n192\n  \n1\n \n26\n \n12\n:09 .\ndrwxr-xr-x  \n12\n ych  staff   \n384\n  \n1\n \n26\n \n12\n:12 ..\ndrwxr-xr-x  \n10\n ych  staff   \n320\n  \n1\n \n16\n \n17\n:37 client\ndrwxr-xr-x   \n4\n ych  staff   \n128\n \n12\n \n30\n \n15\n:15 nginx\ndrwxr-xr-x   \n7\n ych  staff   \n224\n  \n1\n \n26\n \n12\n:14 users\n$ flask-microservices-users \n[\nmaster\n]\n \u26a1 ls -la services/users\ntotal \n40\n\ndrwxr-xr-x  \n7\n ych  staff   \n224\n  \n1\n \n26\n \n12\n:14 .\ndrwxr-xr-x  \n6\n ych  staff   \n192\n  \n1\n \n26\n \n12\n:09 ..\n-rw-r--r--  \n1\n ych  staff   \n329\n \n12\n \n29\n \n10\n:47 Dockerfile\n-rw-r--r--  \n1\n ych  staff  \n1366\n  \n1\n  \n5\n \n17\n:46 manage.py\ndrwxr-xr-x  \n9\n ych  staff   \n288\n \n12\n \n31\n \n10\n:56 project\n-rw-r--r--  \n1\n ych  staff   \n159\n  \n1\n \n13\n \n14\n:28 requirements.txt\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u6765\u66f4\u65b0\ndocker-compose.yml\n\u6587\u4ef6\uff1a\n\n\nversion\n:\n \n3.3\n\n\n\nservices\n:\n\n  \nusers-db\n:\n\n    \ncontainer_name\n:\n \nusers-db\n\n    \nbuild\n:\n\n      \ncontext\n:\n \n./services/users/project/db\n\n      \ndockerfile\n:\n \nDockerfile\n\n    \nports\n:\n\n      \n-\n \n3307:3306\n\n    \nenvironment\n:\n\n      \n-\n \nMYSQL_ROOT_PASSWORD=root321\n\n\n  \nusers-service\n:\n\n    \ncontainer_name\n:\n \nusers-service\n\n    \nbuild\n:\n\n      \ncontext\n:\n \n./services/users\n\n      \ndockerfile\n:\n \nDockerfile-dev\n\n    \nvolumes\n:\n\n      \n-\n \n./services/users:/usr/src/app\n\n    \nports\n:\n\n      \n-\n \n5001:5000\n \n# \u66b4\u9732\u7aef\u53e3 - \u4e3b\u673a:\u5bb9\u5668\n\n    \nenvironment\n:\n\n      \n-\n \nAPP_SETTINGS=project.config.DevelopmentConfig\n\n      \n-\n \nDATABASE_URL=mysql+pymysql://root:root321@users-db:3306/users_dev\n\n      \n-\n \nDATABASE_TEST_URL=mysql+pymysql://root:root321@users-db:3306/users_test\n\n    \ndepends_on\n:\n\n      \n-\n \nusers-db\n\n    \nlinks\n:\n\n      \n-\n \nusers-db\n\n\n\n\n\n\n\u540c\u6837\u7684\uff0c\u66f4\u65b0\ndocker-compose-prod.yml\n\u6587\u4ef6\uff1a\n\n\nversion\n:\n \n3.3\n\n\n\nservices\n:\n\n  \nusers-db\n:\n\n    \ncontainer_name\n:\n \nusers-db\n\n    \nbuild\n:\n\n      \ncontext\n:\n \n./services/users/project/db\n\n      \ndockerfile\n:\n \nDockerfile\n\n    \nports\n:\n\n      \n-\n \n3307:3306\n\n    \nenvironment\n:\n\n      \n-\n \nMYSQL_ROOT_PASSWORD=root321\n\n\n  \nusers-service\n:\n\n    \ncontainer_name\n:\n \nusers-service\n\n    \nbuild\n:\n\n      \ncontext\n:\n \n./services/users\n\n      \ndockerfile\n:\n \nDockerfile-prod\n\n    \nexpose\n:\n\n      \n-\n \n5000\n \n# \u53ea\u66b4\u9732\u5bb9\u5668\u7aef\u53e3\n\n    \nenvironment\n:\n\n      \n-\n \nAPP_SETTINGS=project.config.ProductionConfig\n\n      \n-\n \nDATABASE_URL=mysql+pymysql://root:root321@users-db:3306/users_prod\n\n      \n-\n \nDATABASE_TEST_URL=mysql+pymysql://root:root321@users-db:3306/users_test\n\n    \ncommand\n:\n \ngunicorn -b 0.0.0.0:5000 manage:app\n\n    \ndepends_on\n:\n\n      \n-\n \nusers-db\n\n    \nlinks\n:\n\n      \n-\n \nusers-db\n\n\n  \nnginx\n:\n\n    \ncontainer_name\n:\n \nnginx\n\n    \nbuild\n:\n \n./services/nginx\n\n    \nrestart\n:\n \nalways\n\n    \nports\n:\n\n      \n-\n \n8080:80\n\n    \ndepends_on\n:\n\n      \n-\n \nusers-service\n\n    \nlinks\n:\n\n      \n-\n \nusers-service\n\n\n\n\n\n\n\u6ce8\u610f\u4e0a\u9762\u7684\ndocker-compose\n\u6587\u4ef6\u6211\u4eec\u66f4\u65b0\u5230\n3.3\n\u7248\u672c\uff0c\u6ce8\u610f\u770b\u548c\u4e4b\u524d\u7684\n2.1\n\u7248\u672c\u662f\u6709\u90e8\u5206\u533a\u522b\u7684\u3002\u7136\u540e\u91cd\u65b0\u6784\u5efa\u4e0b\u6211\u4eec\u7684\u5bb9\u5668\uff1a\n\n\n$ docker-compose -f docker-compose.yml up -d --build\n\n\n\n\n\n\u786e\u4fdd\u4e0a\u9762\u7684\u6784\u5efa\u8fc7\u7a0b\u662f\u6b63\u786e\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u67e5\u770b\nusers-service\n\u670d\u52a1\u7684\u65e5\u5fd7\u6765\u786e\u8ba4\uff1a\n\n\n$ docker-compose logs -f users-service\nAttaching to users-service\nusers-service    \n|\n  * Running on http://0.0.0.0:5000/ \n(\nPress CTRL+C to quit\n)\n\nusers-service    \n|\n  * Restarting with stat\nusers-service    \n|\n  * Debugger is active!\nusers-service    \n|\n  * Debugger PIN: \n170\n-528-240\nusers-service    \n|\n \n172\n.18.0.1 - - \n[\n26\n/Jan/2018 \n04\n:22:08\n]\n \nGET /ping HTTP/1.1\n \n200\n -\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u8dd1\u4e00\u904d\u6211\u4eec\u7684\u6d4b\u8bd5\u7528\u4f8b\uff0c\u786e\u4fdd\u7684\u4e1a\u52a1\u903b\u8f91\u4e5f\u662f\u7b26\u5408\u6211\u4eec\u7684\u9884\u671f\u7684\uff1a\n\n\n$ docker-compose -f docker-compose.yml run users-service python manage.py \ntest\n\n\n\n\n\n\n\u5982\u679c\u4e00\u5207\u6b63\u5e38\uff0c\u4e0a\u9762\u7684\u6d4b\u8bd5\u4e5f\u4f1a\u6b63\u5e38\u901a\u8fc7\u7684\u3002\n\n\n\u672c\u5730\u5f00\u53d1\u73af\u5883\n\n\n\u5728\nservices/client\n\u76ee\u5f55\u4e0b\u9762\u6dfb\u52a0\nDockerfile-dev\n\u6587\u4ef6\uff1a\n\n\nFROM node:9.4\n\n\nMAINTAINER \nqikqiak@gmail.com\n\n\n\n# \u8bbe\u7f6e\u5de5\u4f5c\u76ee\u5f55\n\n\nRUN mkdir /usr/src/app\n\n\nWORKDIR /usr/src/app\n\n\n\n# \u6dfb\u52a0node_modules/.bin\u76ee\u5f55\u5230 $PATH \u73af\u5883\u4e0b\n\n\nENV PATH /usr/src/app/node_modules/.bin:$PATH\n\n\n\n# \u5b89\u88c5\u5e76\u7f13\u5b58\u4f9d\u8d56\u5305(\u7528silent\u9009\u9879\u53ef\u4ee5\u51cf\u5c11\u4e00\u4e9b\u4e0d\u5fc5\u8981\u7684\u9519\u8bef)\n\n\nADD package.json /usr/src/app/package.json\n\n\nRUN npm install --silent\n\n\nRUN npm install react-scripts@1.0.17 -g --silent\n\n\n\n# \u542f\u52a8\u5e94\u7528\n\n\nCMD [\nnpm\n, \nstart\n]\n\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u5728\ndocker-compose.yml\n\u4e2d\u65b0\u589e React \u5e94\u7528\u7684\u670d\u52a1\uff1a\n\n\nclient\n:\n\n  \ncontainer_name\n:\n \nclient\n\n  \nbuild\n:\n\n    \ncontext\n:\n \n./services/client\n\n    \ndockerfile\n:\n \nDockerfile-dev\n\n  \nvolumes\n:\n\n    \n-\n \n./services/client:/usr/src/app\n\n  \nports\n:\n\n    \n-\n \n3007:3000\n\n  \nenvironment\n:\n\n    \n-\n \nNODE_ENV=development\n\n    \n-\n \nREACT_APP_USERS_SERVICE_URL=${REACT_APP_USERS_SERVICE_URL}\n\n  \ndepends_on\n:\n\n    \n-\n \nusers-service\n\n  \nlinks\n:\n\n    \n-\n \nusers-service\n\n\n\n\n\n\n\u5728\u786e\u4fdd\nusers-service\n\u670d\u52a1\u6b63\u5e38\u542f\u52a8\u540e\uff0c\u5728\u7ec8\u7aef\u4e2d\u5bfc\u5165\u73af\u5883\u53d8\u91cf\uff1a\n\n\n$ \nexport\n \nREACT_APP_USERS_SERVICE_URL\n=\nhttp://127.0.0.1:5001\n\n\n\n\n\n\u7136\u540e\u91cd\u65b0\u6784\u5efa\u955c\u50cf\u542f\u52a8\u65b0\u7684\u5bb9\u5668\uff1a\n\n\n$ docker-compose -f docker-compose.yml up --build -d client\n\n\n\n\n\n\u65b0\u5bb9\u5668\u542f\u52a8\u5b8c\u6210\u540e\uff0c\u8fd0\u884c React \u5ba2\u6237\u7aef\u6d4b\u8bd5\u4ee3\u7801\uff1a\n\n\n$ docker-compose -f docker-compose.yml run client npm \ntest\n\n\n\n\n\n\n\u6d4b\u8bd5\u901a\u8fc7\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u672c\u5730\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\nhttp://127.0.0.1:3007\n\u8bbf\u95ee React \u5e94\u7528\u4e86\uff0c\u5f53\u7136\u5982\u679c\u6d4b\u8bd5\u6ca1\u901a\u8fc7\u7684\u8bdd\uff0c\u6211\u4eec\u5f97\u6839\u636e\u9519\u8bef\u4fe1\u606f\u53bb\u4fee\u590d\u6211\u4eec\u7684\u6d4b\u8bd5\u4ee3\u7801\uff0c\u76f4\u5230\u6d4b\u8bd5\u901a\u8fc7\u4e3a\u6b62\u3002\n\n\n\u66f4\u65b0\nservices/nginx/flask.conf\n\u914d\u7f6e\uff1a\n\n\nserver\n \n{\n\n  \nlisten\n \n80\n;\n\n\n  \nlocation\n \n/\n \n{\n\n    \nproxy_pass\n \nhttp://client:3000\n;\n\n    \nproxy_redirect\n    \ndefault\n;\n\n    \nproxy_set_header\n  \nHost\n \n$host\n;\n\n    \nproxy_set_header\n  \nX-Real-IP\n \n$remote_addr\n;\n\n    \nproxy_set_header\n  \nX-Forwarded-For\n \n$proxy_add_x_forwarded_for\n;\n\n    \nproxy_set_header\n  \nX-Forwarded-Host\n \n$server_name\n;\n\n  \n}\n\n\n  \nlocation\n \n/users\n \n{\n\n    \nproxy_pass\n        \nhttp://users-service:5000\n;\n\n    \nproxy_redirect\n    \ndefault\n;\n\n    \nproxy_set_header\n  \nHost\n \n$host\n;\n\n    \nproxy_set_header\n  \nX-Real-IP\n \n$remote_addr\n;\n\n    \nproxy_set_header\n  \nX-Forwarded-For\n \n$proxy_add_x_forwarded_for\n;\n\n    \nproxy_set_header\n  \nX-Forwarded-Host\n \n$server_name\n;\n\n  \n}\n\n\n}\n\n\n\n\n\n\n\u4e0a\u9762\u7684\nnginx\n\u914d\u7f6e\u6587\u4ef6\u505a\u4e86\u4ec0\u4e48\u5de5\u4f5c\uff1f\n\n\n\n\n\u9996\u5148\u5728\nlocation\n\u5757\u4e2d\u5b9a\u4e49\u4e86\u53cd\u5411\u4ee3\u7406\u89c4\u5219\u3002\n\n\n\u5f53\u8bf7\u6c42\u7684 URI \u4e0e\nlocation\n\u533a\u57df\u4e2d\u7684 URI \u5339\u914d\u7684\u65f6\u5019\uff0c\nNginx\n\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u4e86\u540e\u9762\u7684 React \u670d\u52a1\uff08client\uff09\u6216\u8005 Flask \u670d\u52a1\uff08users-service\uff09\u3002\n\n\n\n\n\u540c\u6837\u7684\uff0c\u6211\u4eec\u5c06\nNginx\n\u670d\u52a1\u4e5f\u5b9a\u4e49\u5230\ndocker-compose.yml\n\u6587\u4ef6\u4e2d\uff1a\n\n\nnginx\n:\n\n  \ncontainer_name\n:\n \nnginx\n\n  \nbuild\n:\n \n./services/nginx\n\n  \nrestart\n:\n \nalways\n\n  \nports\n:\n\n    \n-\n \n8080:80\n\n  \ndepends_on\n:\n\n    \n-\n \nusers-service\n\n    \n-\n \nclient\n\n  \nlinks\n:\n\n    \n-\n \nusers-service\n\n\n\n\n\n\n\u7136\u540e\u66f4\u65b0\u5bb9\u5668\uff1a\n\n\n$ docker-compose -f docker-compose.yml up -d --build\n\n\n\n\n\n\n\n\u6ce8\u610f\u6211\u4eec\u8fd9\u91cc\u7528\u7684\u4e3b\u673a\u7aef\u53e3\u4e3a8080\uff0c\u56e0\u4e3a\u6211\u4eec\n\u672c\u673a\u768480\u7aef\u53e3\u5df2\u7ecf\u88ab\u5360\u7528\n\uff0c\u5728\u5b9e\u9645\u7ebf\u4e0a\u90e8\u7f72\u7684\u65f6\u5019\u5e94\u8be5\u752880\u7aef\u53e3\uff0c\u7136\u540e\u518d\u6839\u636e\u57df\u540d\u8fdb\u884c\u5339\u914d\u8fdb\u884c\u6d4b\u8bd5\u3002\n\n\n\n\n\u5bb9\u5668\u542f\u52a8\u5b8c\u6210\u540e\uff0c\u6253\u5f00\u6d4f\u89c8\u5668\u6d4b\u8bd5\u4e0b\u6211\u4eec\u7684\u670d\u52a1\uff0c\u786e\u4fdd\u4e0b\u9762\u7684\u4e24\u4e2a\u8bf7\u6c42\u90fd\u662f\u6b63\u5e38\u7684\uff1a\n\n\n\n\nhttp://127.0.0.1:8080\n\n\nhttp://127.0.0.1:8080/users\n\n\n\n\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u547d\u4ee4\u67e5\u770b\u8fd0\u884c\u4e2d\u7684\u5bb9\u5668\u65e5\u5fd7\uff1a\n\n\n$ docker-compose -f docker-compose.yml logs -f\n\n\n\n\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u6539\u53d8\u4e0b App \u7ec4\u4ef6\u7684 state \u5bf9\u8c61\uff1a\n\n\nthis\n.\nstate\n \n=\n \n{\n\n  \nusers\n:\n \n[],\n\n  \nusername\n:\n \ntest001\n,\n\n  \nemail\n:\n \n\n\n};\n\n\n\n\n\n\n\u5f53\u6211\u4eec\u4fdd\u5b58\u7684\u65f6\u5019\u53ef\u4ee5\u770b\u5230\u65e5\u5fd7\u4e2d\u8f93\u51fa\u4e86\u7f16\u8bd1\u6210\u529f\u7684\u4fe1\u606f\uff0c\u800c\u4e14\u8fd9\u4e2a\u65f6\u5019\u6d4f\u89c8\u5668\u4e5f\u81ea\u52a8\u5237\u65b0\u4e86\uff0c\u5e76\u4e14\u5c06 test001 \u586b\u5145\u5728\u4e86\u7528\u6237\u540d\u7684\u8f93\u5165\u6846\u4e2d\u3002\n\n\n\u5f53\u7136\u6d4b\u8bd5\u8fc7\u540e\uff0c\u8981\u8bb0\u5f97\u5c06\u4e0a\u9762\u7684 state \u5bf9\u8c61\u7684\u503c\u66f4\u6539\u56de\u53bb\u54e6~\n\n\n\u751f\u4ea7\u73af\u5883\n\n\n\u5728\u5c06 React \u5e94\u7528\u4e0a\u5230\u751f\u4ea7\u73af\u5883\u4e4b\u524d\u6211\u4eec\u9700\u8981\u5c06\u5e94\u7528\u8fdb\u884c\u6253\u5305\u6784\u5efa\u7528\u4e8e\u751f\u6210\u4e00\u7cfb\u5217\u7684\u9759\u6001\u6587\u4ef6\uff0c\u6211\u4eec\u5728\nservices/client\n\u76ee\u5f55\u4e0b\u9762\u7684\npackage.json\n\u6587\u4ef6\u4e2d\u53ef\u4ee5\u770b\u5230\u6709\u4e00\u4e2a\nbuild\n\u7684\u811a\u672c\uff0c\u8be5\u811a\u672c\u5c31\u662f\u7528\u4e8e\u6211\u4eec\u5bf9 React \u5e94\u7528\u8fdb\u884c\u6253\u5305\u7684\uff0c\u5728\u8be5\u76ee\u5f55\u4e0b\u9762\u6267\u884c\u547d\u4ee4\uff1a\n\n\n$ npm run build\n\n\n client@0.1.0 build /Users/ych/devs/workspace/yidianzhishi/tdd100/flask-microservices-users/services/client\n\n react-scripts build\n\nCreating an optimized production build...\nCompiled successfully.\n\n\n\n\n\n\u6784\u5efa\u5b8c\u6210\u540e\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5728\u8be5\u76ee\u5f55\u4e0b\u9762\u591a\u4e86\u4e00\u4e2a\nbuild\n\u7684\u76ee\u5f55\uff0c\u8be5\u76ee\u5f55\u4e0b\u9762\u6253\u5305\u8fc7\u540e\u7684\u9759\u6001\u8d44\u6e90\u6587\u4ef6\u3002\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u9759\u6001\u670d\u52a1\u5668\u6765\u8bbf\u95ee\u8fd9\u4e9b\u9759\u6001\u8d44\u6e90\uff0c\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff1a\n\n\n$ npm install -g serve\n$ serve -s build\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502                                                  \u2502\n   \u2502   Serving!                                       \u2502\n   \u2502                                                  \u2502\n   \u2502   - Local:            http://localhost:5000      \u2502\n   \u2502   - On Your Network:  http://192.168.31.9:5000   \u2502\n   \u2502                                                  \u2502\n   \u2502   Copied \nlocal\n address to clipboard!             \u2502\n   \u2502                                                  \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\n\n\n\n\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u4e0a\u9762\u7684\u63d0\u793a\u8bbf\u95ee\nhttp://localhost:5000\n\uff0c\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5728\u8fdb\u884c\u4e00\u6b21\u76f8\u5173\u7684\u6d4b\u8bd5\uff0c\u786e\u4fdd\u6ca1\u6709\u4efb\u4f55\u9519\u8bef\u3002\n\n\n\u7136\u540e\u5728\nclient\n\u7684\u6839\u76ee\u5f55\u4e0b\u9762\u65b0\u589e\u4e00\u4e2a\u7528\u4e8e\u751f\u4ea7\u73af\u5883\u7684 Dockerfile \u6587\u4ef6\uff1a(\nDockerfile-prod\n)\n\n\n# build environment\n\n\nFROM\n node:9.4 as builder\n\n\nRUN\n mkdir /usr/src/app\n\nWORKDIR\n /usr/src/app\n\n\nENV\n PATH /usr/src/app/node_modules/.bin:$PATH\n\nARG REACT_APP_USERS_SERVICE_URL\nARG NODE_ENV\n\nENV\n NODE_ENV $NODE_ENV\n\n\nENV\n REACT_APP_USERS_SERVICE_URL $REACT_APP_USERS_SERVICE_URL\n\nCOPY package.json /usr/src/app/package.json\n\nRUN\n npm install --silent\n\nRUN\n npm install react-scripts@1.1.0 -g --silent\nCOPY . /usr/src/app\n\nRUN\n npm run build\n\n\n# production environment\n\n\nFROM\n nginx:1.13.5-alpine\n\nCOPY --from\n=\nbuilder /usr/src/app/build /usr/share/nginx/html\n\nEXPOSE\n 80\n\n\nCMD\n [\nnginx\n, \n-g\n, \ndaemon off;\n]\n\n\n\n\n\n\n\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e0a\u9762\u7684\nDockerfile\n\u6587\u4ef6\u548c\u4e4b\u524d\u7684\u4e0d\u592a\u4e00\u6837\uff0c\u51fa\u73b0\u4e86\u4e24\u4e2a\u57fa\u7840\u955c\u50cf\uff0c\u8fd9\u662f\nDocker\n\u63d0\u4f9b\u7684\u591a\u9636\u6bb5\u6784\u5efa\u529f\u80fd\uff0c\u8be6\u7ec6\u7684\u53ef\u4ee5\u53c2\u8003\u6211\u4e4b\u524d\u7684\u4e00\u7bc7\u535a\u6587\uff1a\nDocker \u7684\u591a\u9636\u6bb5\u6784\u5efa\n\u3002\n\n\n\u5f53\u6784\u5efa\u955c\u50cf\u7684\u65f6\u5019\uff0c\u53c2\u6570\u901a\u8fc7\nARG\n\u6307\u4ee4\u4f20\u9012\u7ed9\nDockerfile\n\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5c06\u5176\u7528\u505a\u73af\u5883\u53d8\u91cf\u3002\nnpm run build\n\u547d\u4ee4\u5c06\u751f\u6210\u9759\u6001\u6587\u4ef6\uff0c\u7136\u540e\u901a\u8fc7\nNginx\n\u66b4\u973280\u7aef\u53e3\u63d0\u4f9b\u670d\u52a1\u3002\n\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u4e0d\u4f7f\u7528\nDocker Compose\n\u6765\u8fdb\u884c\u4e00\u4e9b\u7b80\u5355\u7684\u6d4b\u8bd5\u3002\u9996\u5148\uff0c\u5728\nservices/client\n\u76ee\u5f55\u4e0b\u9762\u6784\u5efa\u955c\u50cf\uff0c\u8bb0\u5f97\u4f7f\u7528\n--build-arg\n\u6807\u8bb0\u6765\u4f20\u9012\u5408\u9002\u7684\u53c2\u6570\uff1a\n\n\n$ docker build -f Dockerfile-prod -t \ntest\n ./ --build-arg \nNODE_ENV\n=\ndevelopment --build-arg \nREACT_APP_USERS_SERVICE_URL\n=\nhttp://127.0.0.1:5001\n\n\n\n\n\n\n\n\u8bb0\u5f97\u5c06\u4e0a\u9762\u7684\nREACT_APP_USERS_SERVICE_URL\n\u66ff\u6362\u6210\u4f60\u81ea\u5df1\u7684\u5b9e\u9645\u7684 IP\u3002\n\n\n\n\n\u4e0a\u9762\u7684\u6784\u5efa\u547d\u4ee4\u662f\u7528\nservices/client\n\u4e0b\u9762\u7684\nDockerfile-prod\n\u6587\u4ef6\u6765\u6784\u5efa\u4e00\u4e2a\u53eb test \u7684\u955c\u50cf\u3002\n\n\n\u955c\u50cf\u6784\u5efa\u5b8c\u6210\u540e\u6211\u4eec\u4f7f\u7528\u4e0a\u9762\u7684 test \u955c\u50cf\u6765\u542f\u52a8\u4e00\u4e2a\u540d\u4e3a test01 \u7684\u5bb9\u5668\uff0c\u5c06\u4e3b\u673a\u76849000\u7aef\u53e3\u6620\u5c04\u5230\u5bb9\u5668\u768480\u7aef\u53e3\uff1a\n\n\n$ docker run --name test01 -d -p \n9000\n:80 \ntest\n\n\n\n\n\n\n\u5bb9\u5668\u542f\u52a8\u6210\u529f\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\u94fe\u63a5\nhttp://localhost:9000/\n\u6765\u8fdb\u884c\u76f8\u5173\u7684\u6d4b\u8bd5\u3002\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u505c\u6b62\u5bb9\u5668\uff1a\n\n\n$ docker stop test01\n$ docker rm test01\n\n\n\n\n\n\u6700\u597d\uff0c\u5220\u9664\u4e0a\u9762\u7684\u955c\u50cf\uff1a\n\n\n$ docker rmi \ntest\n\n\n\n\n\n\n\u4e0a\u9762\u6211\u4eec\u5bf9\nDockerfile-prod\n\u8fdb\u884c\u4e86\u76f8\u5173\u7684\u8bbe\u7f6e\u548c\u6d4b\u8bd5\uff0c\u73b0\u5728\u6211\u4eec\u5c06\u8be5\u670d\u52a1\u6dfb\u52a0\u5230\ndocker-compose-prod.yml\n\uff1a\n\n\nclient\n:\n\n  \ncontainer_name\n:\n \nclient\n\n  \nbuild\n:\n\n    \ncontext\n:\n \n./services/client\n\n    \ndockerfile\n:\n \nDockerfile-prod\n\n    \nargs\n:\n\n      \n-\n \nNODE_ENV=production\n\n      \n-\n \nREACT_APP_USERS_SERVICE_URL=${REACT_APP_USERS_SERVICE_URL}\n\n  \nports\n:\n\n    \n-\n \n3007:80\n\n  \ndepends_on\n:\n\n    \n-\n \nusers\n\n  \nlinks\n:\n\n    \n-\n \nusers\n\n\n\n\n\n\n\u6ce8\u610f\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u7684\u662f\nargs\n\uff0c\u800c\u4e0d\u662f\u73af\u5883\u53d8\u91cf\u4e86\u3002\u53e6\u5916\uff0c\u6211\u4eec\u7684\u8fd9\u4e2a client \u670d\u52a1\u9700\u8981\u5728 nginx \u670d\u52a1\u542f\u52a8\u4e4b\u524d\u542f\u52a8\uff0c\u6240\u4ee5\u6211\u4eec\u76f8\u5e94\u7684\u66f4\u65b0\ndocker-compose-prod.yml\n\uff1a\n\n\nnginx\n:\n\n  \ncontainer_name\n:\n \nnginx\n\n  \nbuild\n:\n \n./services/nginx\n\n  \nrestart\n:\n \nalways\n\n  \nports\n:\n\n    \n-\n \n80:80\n\n  \ndepends_on\n:\n\n    \n-\n \nusers\n\n    \n-\n \nclient\n\n\n\n\n\n\n\u626b\u63cf\u4e0b\u9762\u7684\u4e8c\u7ef4\u7801(\u6216\u5fae\u4fe1\u641c\u7d22\niEverything\n)\u6dfb\u52a0\u6211\u5fae\u4fe1\u597d\u53cb(\u6ce8\u660e\npython\n)\uff0c\u7136\u540e\u53ef\u4ee5\u52a0\u5165\u5230\u6211\u4eec\u7684\npython\n\u8ba8\u8bba\u7fa4\u91cc\u9762\u5171\u540c\u5b66\u4e60", 
            "title": "\u5bb9\u5668\u5316 React \u5e94\u7528"
        }, 
        {
            "location": "/part2/docker/#_1", 
            "text": "\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u9762\u65b0\u589e\u4e00\u4e2a\u53eb services \u7684\u6587\u4ef6\u5939\uff0c\u7136\u540e\u5c06 nginx \u6587\u4ef6\u5939\u79fb\u52a8\u5230 services \u76ee\u5f55\u4e0b\u9762\uff0c\u5c06 client \u6587\u4ef6\u5939\u79fb\u52a8\u5230 services \u76ee\u5f55\u4e0b\u9762\uff0c\u7136\u540e\u5728 services \u76ee\u5f55\u4e0b\u9762\u65b0\u5efa\u4e00\u4e2a  users \u6587\u4ef6\u5939\uff0c\u5c06\u6839\u76ee\u5f55\u4e0b\u9762\u7684 project \u6587\u4ef6\u5939\u3001Dockerfile\u3001manage.py\u3001requirements.txt \u6587\u4ef6\u90fd\u79fb\u52a8\u5230 services/users \u76ee\u5f55\u4e0b\u9762\uff0c\u64cd\u4f5c\u5b8c\u6210\u540e\uff0c\u4f60\u770b\u5230\u7684\u6211\u4eec\u7684\u4ee3\u7801\u7ed3\u6784\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a  $ flask-microservices-users  [ master ]  \u26a1 ls -la\ntotal  88 \ndrwxr-xr-x   12  ych  staff     384    1   26   12 :12 .\ndrwxr-xr-x    4  ych  staff     128   12   28   16 :08 ..\ndrwxr-xr-x   14  ych  staff     448    1   26   12 :27 .git\n-rw-r--r--    1  ych  staff      23    1    5   17 :56 .gitignore\n-rw-r--r--    1  ych  staff       5   12   28   15 :19 .python-version\n-rw-r--r--    1  ych  staff     645    1    5   18 :13 .travis.yml\n-rw-r--r--    1  ych  staff   11357   12   29   10 :44 LICENSE\n-rw-r--r--    1  ych  staff     206    1    5   18 :23 README.md\n-rw-r--r--    1  ych  staff     922    1   26   12 :11 docker-compose-prod.yml\n-rw-r--r--    1  ych  staff     755    1   26   12 :15 docker-compose.yml\ndrwxr-xr-x    6  ych  staff     192    1   26   12 :09 services\n$ flask-microservices-users  [ master ]  \u26a1 ls -la services\ntotal  16 \ndrwxr-xr-x    6  ych  staff    192    1   26   12 :09 .\ndrwxr-xr-x   12  ych  staff    384    1   26   12 :12 ..\ndrwxr-xr-x   10  ych  staff    320    1   16   17 :37 client\ndrwxr-xr-x    4  ych  staff    128   12   30   15 :15 nginx\ndrwxr-xr-x    7  ych  staff    224    1   26   12 :14 users\n$ flask-microservices-users  [ master ]  \u26a1 ls -la services/users\ntotal  40 \ndrwxr-xr-x   7  ych  staff    224    1   26   12 :14 .\ndrwxr-xr-x   6  ych  staff    192    1   26   12 :09 ..\n-rw-r--r--   1  ych  staff    329   12   29   10 :47 Dockerfile\n-rw-r--r--   1  ych  staff   1366    1    5   17 :46 manage.py\ndrwxr-xr-x   9  ych  staff    288   12   31   10 :56 project\n-rw-r--r--   1  ych  staff    159    1   13   14 :28 requirements.txt  \u7136\u540e\u6211\u4eec\u6765\u66f4\u65b0 docker-compose.yml \u6587\u4ef6\uff1a  version :   3.3  services : \n   users-db : \n     container_name :   users-db \n     build : \n       context :   ./services/users/project/db \n       dockerfile :   Dockerfile \n     ports : \n       -   3307:3306 \n     environment : \n       -   MYSQL_ROOT_PASSWORD=root321 \n\n   users-service : \n     container_name :   users-service \n     build : \n       context :   ./services/users \n       dockerfile :   Dockerfile-dev \n     volumes : \n       -   ./services/users:/usr/src/app \n     ports : \n       -   5001:5000   # \u66b4\u9732\u7aef\u53e3 - \u4e3b\u673a:\u5bb9\u5668 \n     environment : \n       -   APP_SETTINGS=project.config.DevelopmentConfig \n       -   DATABASE_URL=mysql+pymysql://root:root321@users-db:3306/users_dev \n       -   DATABASE_TEST_URL=mysql+pymysql://root:root321@users-db:3306/users_test \n     depends_on : \n       -   users-db \n     links : \n       -   users-db   \u540c\u6837\u7684\uff0c\u66f4\u65b0 docker-compose-prod.yml \u6587\u4ef6\uff1a  version :   3.3  services : \n   users-db : \n     container_name :   users-db \n     build : \n       context :   ./services/users/project/db \n       dockerfile :   Dockerfile \n     ports : \n       -   3307:3306 \n     environment : \n       -   MYSQL_ROOT_PASSWORD=root321 \n\n   users-service : \n     container_name :   users-service \n     build : \n       context :   ./services/users \n       dockerfile :   Dockerfile-prod \n     expose : \n       -   5000   # \u53ea\u66b4\u9732\u5bb9\u5668\u7aef\u53e3 \n     environment : \n       -   APP_SETTINGS=project.config.ProductionConfig \n       -   DATABASE_URL=mysql+pymysql://root:root321@users-db:3306/users_prod \n       -   DATABASE_TEST_URL=mysql+pymysql://root:root321@users-db:3306/users_test \n     command :   gunicorn -b 0.0.0.0:5000 manage:app \n     depends_on : \n       -   users-db \n     links : \n       -   users-db \n\n   nginx : \n     container_name :   nginx \n     build :   ./services/nginx \n     restart :   always \n     ports : \n       -   8080:80 \n     depends_on : \n       -   users-service \n     links : \n       -   users-service   \u6ce8\u610f\u4e0a\u9762\u7684 docker-compose \u6587\u4ef6\u6211\u4eec\u66f4\u65b0\u5230 3.3 \u7248\u672c\uff0c\u6ce8\u610f\u770b\u548c\u4e4b\u524d\u7684 2.1 \u7248\u672c\u662f\u6709\u90e8\u5206\u533a\u522b\u7684\u3002\u7136\u540e\u91cd\u65b0\u6784\u5efa\u4e0b\u6211\u4eec\u7684\u5bb9\u5668\uff1a  $ docker-compose -f docker-compose.yml up -d --build  \u786e\u4fdd\u4e0a\u9762\u7684\u6784\u5efa\u8fc7\u7a0b\u662f\u6b63\u786e\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u67e5\u770b users-service \u670d\u52a1\u7684\u65e5\u5fd7\u6765\u786e\u8ba4\uff1a  $ docker-compose logs -f users-service\nAttaching to users-service\nusers-service     |   * Running on http://0.0.0.0:5000/  ( Press CTRL+C to quit ) \nusers-service     |   * Restarting with stat\nusers-service     |   * Debugger is active!\nusers-service     |   * Debugger PIN:  170 -528-240\nusers-service     |   172 .18.0.1 - -  [ 26 /Jan/2018  04 :22:08 ]   GET /ping HTTP/1.1   200  -  \u7136\u540e\u6211\u4eec\u53ef\u4ee5\u8dd1\u4e00\u904d\u6211\u4eec\u7684\u6d4b\u8bd5\u7528\u4f8b\uff0c\u786e\u4fdd\u7684\u4e1a\u52a1\u903b\u8f91\u4e5f\u662f\u7b26\u5408\u6211\u4eec\u7684\u9884\u671f\u7684\uff1a  $ docker-compose -f docker-compose.yml run users-service python manage.py  test   \u5982\u679c\u4e00\u5207\u6b63\u5e38\uff0c\u4e0a\u9762\u7684\u6d4b\u8bd5\u4e5f\u4f1a\u6b63\u5e38\u901a\u8fc7\u7684\u3002", 
            "title": "\u91cd\u6784"
        }, 
        {
            "location": "/part2/docker/#_2", 
            "text": "\u5728 services/client \u76ee\u5f55\u4e0b\u9762\u6dfb\u52a0 Dockerfile-dev \u6587\u4ef6\uff1a  FROM node:9.4  MAINTAINER  qikqiak@gmail.com  # \u8bbe\u7f6e\u5de5\u4f5c\u76ee\u5f55  RUN mkdir /usr/src/app  WORKDIR /usr/src/app  # \u6dfb\u52a0node_modules/.bin\u76ee\u5f55\u5230 $PATH \u73af\u5883\u4e0b  ENV PATH /usr/src/app/node_modules/.bin:$PATH  # \u5b89\u88c5\u5e76\u7f13\u5b58\u4f9d\u8d56\u5305(\u7528silent\u9009\u9879\u53ef\u4ee5\u51cf\u5c11\u4e00\u4e9b\u4e0d\u5fc5\u8981\u7684\u9519\u8bef)  ADD package.json /usr/src/app/package.json  RUN npm install --silent  RUN npm install react-scripts@1.0.17 -g --silent  # \u542f\u52a8\u5e94\u7528  CMD [ npm ,  start ]   \u7136\u540e\u6211\u4eec\u5728 docker-compose.yml \u4e2d\u65b0\u589e React \u5e94\u7528\u7684\u670d\u52a1\uff1a  client : \n   container_name :   client \n   build : \n     context :   ./services/client \n     dockerfile :   Dockerfile-dev \n   volumes : \n     -   ./services/client:/usr/src/app \n   ports : \n     -   3007:3000 \n   environment : \n     -   NODE_ENV=development \n     -   REACT_APP_USERS_SERVICE_URL=${REACT_APP_USERS_SERVICE_URL} \n   depends_on : \n     -   users-service \n   links : \n     -   users-service   \u5728\u786e\u4fdd users-service \u670d\u52a1\u6b63\u5e38\u542f\u52a8\u540e\uff0c\u5728\u7ec8\u7aef\u4e2d\u5bfc\u5165\u73af\u5883\u53d8\u91cf\uff1a  $  export   REACT_APP_USERS_SERVICE_URL = http://127.0.0.1:5001  \u7136\u540e\u91cd\u65b0\u6784\u5efa\u955c\u50cf\u542f\u52a8\u65b0\u7684\u5bb9\u5668\uff1a  $ docker-compose -f docker-compose.yml up --build -d client  \u65b0\u5bb9\u5668\u542f\u52a8\u5b8c\u6210\u540e\uff0c\u8fd0\u884c React \u5ba2\u6237\u7aef\u6d4b\u8bd5\u4ee3\u7801\uff1a  $ docker-compose -f docker-compose.yml run client npm  test   \u6d4b\u8bd5\u901a\u8fc7\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u672c\u5730\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 http://127.0.0.1:3007 \u8bbf\u95ee React \u5e94\u7528\u4e86\uff0c\u5f53\u7136\u5982\u679c\u6d4b\u8bd5\u6ca1\u901a\u8fc7\u7684\u8bdd\uff0c\u6211\u4eec\u5f97\u6839\u636e\u9519\u8bef\u4fe1\u606f\u53bb\u4fee\u590d\u6211\u4eec\u7684\u6d4b\u8bd5\u4ee3\u7801\uff0c\u76f4\u5230\u6d4b\u8bd5\u901a\u8fc7\u4e3a\u6b62\u3002  \u66f4\u65b0 services/nginx/flask.conf \u914d\u7f6e\uff1a  server   { \n   listen   80 ; \n\n   location   /   { \n     proxy_pass   http://client:3000 ; \n     proxy_redirect      default ; \n     proxy_set_header    Host   $host ; \n     proxy_set_header    X-Real-IP   $remote_addr ; \n     proxy_set_header    X-Forwarded-For   $proxy_add_x_forwarded_for ; \n     proxy_set_header    X-Forwarded-Host   $server_name ; \n   } \n\n   location   /users   { \n     proxy_pass          http://users-service:5000 ; \n     proxy_redirect      default ; \n     proxy_set_header    Host   $host ; \n     proxy_set_header    X-Real-IP   $remote_addr ; \n     proxy_set_header    X-Forwarded-For   $proxy_add_x_forwarded_for ; \n     proxy_set_header    X-Forwarded-Host   $server_name ; \n   }  }   \u4e0a\u9762\u7684 nginx \u914d\u7f6e\u6587\u4ef6\u505a\u4e86\u4ec0\u4e48\u5de5\u4f5c\uff1f   \u9996\u5148\u5728 location \u5757\u4e2d\u5b9a\u4e49\u4e86\u53cd\u5411\u4ee3\u7406\u89c4\u5219\u3002  \u5f53\u8bf7\u6c42\u7684 URI \u4e0e location \u533a\u57df\u4e2d\u7684 URI \u5339\u914d\u7684\u65f6\u5019\uff0c Nginx \u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u4e86\u540e\u9762\u7684 React \u670d\u52a1\uff08client\uff09\u6216\u8005 Flask \u670d\u52a1\uff08users-service\uff09\u3002   \u540c\u6837\u7684\uff0c\u6211\u4eec\u5c06 Nginx \u670d\u52a1\u4e5f\u5b9a\u4e49\u5230 docker-compose.yml \u6587\u4ef6\u4e2d\uff1a  nginx : \n   container_name :   nginx \n   build :   ./services/nginx \n   restart :   always \n   ports : \n     -   8080:80 \n   depends_on : \n     -   users-service \n     -   client \n   links : \n     -   users-service   \u7136\u540e\u66f4\u65b0\u5bb9\u5668\uff1a  $ docker-compose -f docker-compose.yml up -d --build   \u6ce8\u610f\u6211\u4eec\u8fd9\u91cc\u7528\u7684\u4e3b\u673a\u7aef\u53e3\u4e3a8080\uff0c\u56e0\u4e3a\u6211\u4eec \u672c\u673a\u768480\u7aef\u53e3\u5df2\u7ecf\u88ab\u5360\u7528 \uff0c\u5728\u5b9e\u9645\u7ebf\u4e0a\u90e8\u7f72\u7684\u65f6\u5019\u5e94\u8be5\u752880\u7aef\u53e3\uff0c\u7136\u540e\u518d\u6839\u636e\u57df\u540d\u8fdb\u884c\u5339\u914d\u8fdb\u884c\u6d4b\u8bd5\u3002   \u5bb9\u5668\u542f\u52a8\u5b8c\u6210\u540e\uff0c\u6253\u5f00\u6d4f\u89c8\u5668\u6d4b\u8bd5\u4e0b\u6211\u4eec\u7684\u670d\u52a1\uff0c\u786e\u4fdd\u4e0b\u9762\u7684\u4e24\u4e2a\u8bf7\u6c42\u90fd\u662f\u6b63\u5e38\u7684\uff1a   http://127.0.0.1:8080  http://127.0.0.1:8080/users   \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u547d\u4ee4\u67e5\u770b\u8fd0\u884c\u4e2d\u7684\u5bb9\u5668\u65e5\u5fd7\uff1a  $ docker-compose -f docker-compose.yml logs -f  \u7136\u540e\u6211\u4eec\u53ef\u4ee5\u6539\u53d8\u4e0b App \u7ec4\u4ef6\u7684 state \u5bf9\u8c61\uff1a  this . state   =   { \n   users :   [], \n   username :   test001 , \n   email :    };   \u5f53\u6211\u4eec\u4fdd\u5b58\u7684\u65f6\u5019\u53ef\u4ee5\u770b\u5230\u65e5\u5fd7\u4e2d\u8f93\u51fa\u4e86\u7f16\u8bd1\u6210\u529f\u7684\u4fe1\u606f\uff0c\u800c\u4e14\u8fd9\u4e2a\u65f6\u5019\u6d4f\u89c8\u5668\u4e5f\u81ea\u52a8\u5237\u65b0\u4e86\uff0c\u5e76\u4e14\u5c06 test001 \u586b\u5145\u5728\u4e86\u7528\u6237\u540d\u7684\u8f93\u5165\u6846\u4e2d\u3002 \n\u5f53\u7136\u6d4b\u8bd5\u8fc7\u540e\uff0c\u8981\u8bb0\u5f97\u5c06\u4e0a\u9762\u7684 state \u5bf9\u8c61\u7684\u503c\u66f4\u6539\u56de\u53bb\u54e6~", 
            "title": "\u672c\u5730\u5f00\u53d1\u73af\u5883"
        }, 
        {
            "location": "/part2/docker/#_3", 
            "text": "\u5728\u5c06 React \u5e94\u7528\u4e0a\u5230\u751f\u4ea7\u73af\u5883\u4e4b\u524d\u6211\u4eec\u9700\u8981\u5c06\u5e94\u7528\u8fdb\u884c\u6253\u5305\u6784\u5efa\u7528\u4e8e\u751f\u6210\u4e00\u7cfb\u5217\u7684\u9759\u6001\u6587\u4ef6\uff0c\u6211\u4eec\u5728 services/client \u76ee\u5f55\u4e0b\u9762\u7684 package.json \u6587\u4ef6\u4e2d\u53ef\u4ee5\u770b\u5230\u6709\u4e00\u4e2a build \u7684\u811a\u672c\uff0c\u8be5\u811a\u672c\u5c31\u662f\u7528\u4e8e\u6211\u4eec\u5bf9 React \u5e94\u7528\u8fdb\u884c\u6253\u5305\u7684\uff0c\u5728\u8be5\u76ee\u5f55\u4e0b\u9762\u6267\u884c\u547d\u4ee4\uff1a  $ npm run build  client@0.1.0 build /Users/ych/devs/workspace/yidianzhishi/tdd100/flask-microservices-users/services/client  react-scripts build\n\nCreating an optimized production build...\nCompiled successfully.  \u6784\u5efa\u5b8c\u6210\u540e\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5728\u8be5\u76ee\u5f55\u4e0b\u9762\u591a\u4e86\u4e00\u4e2a build \u7684\u76ee\u5f55\uff0c\u8be5\u76ee\u5f55\u4e0b\u9762\u6253\u5305\u8fc7\u540e\u7684\u9759\u6001\u8d44\u6e90\u6587\u4ef6\u3002\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u9759\u6001\u670d\u52a1\u5668\u6765\u8bbf\u95ee\u8fd9\u4e9b\u9759\u6001\u8d44\u6e90\uff0c\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff1a  $ npm install -g serve\n$ serve -s build\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502                                                  \u2502\n   \u2502   Serving!                                       \u2502\n   \u2502                                                  \u2502\n   \u2502   - Local:            http://localhost:5000      \u2502\n   \u2502   - On Your Network:  http://192.168.31.9:5000   \u2502\n   \u2502                                                  \u2502\n   \u2502   Copied  local  address to clipboard!             \u2502\n   \u2502                                                  \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u6211\u4eec\u53ef\u4ee5\u6839\u636e\u4e0a\u9762\u7684\u63d0\u793a\u8bbf\u95ee http://localhost:5000 \uff0c\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5728\u8fdb\u884c\u4e00\u6b21\u76f8\u5173\u7684\u6d4b\u8bd5\uff0c\u786e\u4fdd\u6ca1\u6709\u4efb\u4f55\u9519\u8bef\u3002  \u7136\u540e\u5728 client \u7684\u6839\u76ee\u5f55\u4e0b\u9762\u65b0\u589e\u4e00\u4e2a\u7528\u4e8e\u751f\u4ea7\u73af\u5883\u7684 Dockerfile \u6587\u4ef6\uff1a( Dockerfile-prod )  # build environment  FROM  node:9.4 as builder  RUN  mkdir /usr/src/app WORKDIR  /usr/src/app  ENV  PATH /usr/src/app/node_modules/.bin:$PATH \nARG REACT_APP_USERS_SERVICE_URL\nARG NODE_ENV ENV  NODE_ENV $NODE_ENV  ENV  REACT_APP_USERS_SERVICE_URL $REACT_APP_USERS_SERVICE_URL \nCOPY package.json /usr/src/app/package.json RUN  npm install --silent RUN  npm install react-scripts@1.1.0 -g --silent\nCOPY . /usr/src/app RUN  npm run build # production environment  FROM  nginx:1.13.5-alpine \nCOPY --from = builder /usr/src/app/build /usr/share/nginx/html EXPOSE  80  CMD  [ nginx ,  -g ,  daemon off; ]   \u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e0a\u9762\u7684 Dockerfile \u6587\u4ef6\u548c\u4e4b\u524d\u7684\u4e0d\u592a\u4e00\u6837\uff0c\u51fa\u73b0\u4e86\u4e24\u4e2a\u57fa\u7840\u955c\u50cf\uff0c\u8fd9\u662f Docker \u63d0\u4f9b\u7684\u591a\u9636\u6bb5\u6784\u5efa\u529f\u80fd\uff0c\u8be6\u7ec6\u7684\u53ef\u4ee5\u53c2\u8003\u6211\u4e4b\u524d\u7684\u4e00\u7bc7\u535a\u6587\uff1a Docker \u7684\u591a\u9636\u6bb5\u6784\u5efa \u3002  \u5f53\u6784\u5efa\u955c\u50cf\u7684\u65f6\u5019\uff0c\u53c2\u6570\u901a\u8fc7 ARG \u6307\u4ee4\u4f20\u9012\u7ed9 Dockerfile \uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5c06\u5176\u7528\u505a\u73af\u5883\u53d8\u91cf\u3002 npm run build \u547d\u4ee4\u5c06\u751f\u6210\u9759\u6001\u6587\u4ef6\uff0c\u7136\u540e\u901a\u8fc7 Nginx \u66b4\u973280\u7aef\u53e3\u63d0\u4f9b\u670d\u52a1\u3002  \u63a5\u4e0b\u6765\u6211\u4eec\u4e0d\u4f7f\u7528 Docker Compose \u6765\u8fdb\u884c\u4e00\u4e9b\u7b80\u5355\u7684\u6d4b\u8bd5\u3002\u9996\u5148\uff0c\u5728 services/client \u76ee\u5f55\u4e0b\u9762\u6784\u5efa\u955c\u50cf\uff0c\u8bb0\u5f97\u4f7f\u7528 --build-arg \u6807\u8bb0\u6765\u4f20\u9012\u5408\u9002\u7684\u53c2\u6570\uff1a  $ docker build -f Dockerfile-prod -t  test  ./ --build-arg  NODE_ENV = development --build-arg  REACT_APP_USERS_SERVICE_URL = http://127.0.0.1:5001   \u8bb0\u5f97\u5c06\u4e0a\u9762\u7684 REACT_APP_USERS_SERVICE_URL \u66ff\u6362\u6210\u4f60\u81ea\u5df1\u7684\u5b9e\u9645\u7684 IP\u3002   \u4e0a\u9762\u7684\u6784\u5efa\u547d\u4ee4\u662f\u7528 services/client \u4e0b\u9762\u7684 Dockerfile-prod \u6587\u4ef6\u6765\u6784\u5efa\u4e00\u4e2a\u53eb test \u7684\u955c\u50cf\u3002  \u955c\u50cf\u6784\u5efa\u5b8c\u6210\u540e\u6211\u4eec\u4f7f\u7528\u4e0a\u9762\u7684 test \u955c\u50cf\u6765\u542f\u52a8\u4e00\u4e2a\u540d\u4e3a test01 \u7684\u5bb9\u5668\uff0c\u5c06\u4e3b\u673a\u76849000\u7aef\u53e3\u6620\u5c04\u5230\u5bb9\u5668\u768480\u7aef\u53e3\uff1a  $ docker run --name test01 -d -p  9000 :80  test   \u5bb9\u5668\u542f\u52a8\u6210\u529f\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\u94fe\u63a5 http://localhost:9000/ \u6765\u8fdb\u884c\u76f8\u5173\u7684\u6d4b\u8bd5\u3002\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u505c\u6b62\u5bb9\u5668\uff1a  $ docker stop test01\n$ docker rm test01  \u6700\u597d\uff0c\u5220\u9664\u4e0a\u9762\u7684\u955c\u50cf\uff1a  $ docker rmi  test   \u4e0a\u9762\u6211\u4eec\u5bf9 Dockerfile-prod \u8fdb\u884c\u4e86\u76f8\u5173\u7684\u8bbe\u7f6e\u548c\u6d4b\u8bd5\uff0c\u73b0\u5728\u6211\u4eec\u5c06\u8be5\u670d\u52a1\u6dfb\u52a0\u5230 docker-compose-prod.yml \uff1a  client : \n   container_name :   client \n   build : \n     context :   ./services/client \n     dockerfile :   Dockerfile-prod \n     args : \n       -   NODE_ENV=production \n       -   REACT_APP_USERS_SERVICE_URL=${REACT_APP_USERS_SERVICE_URL} \n   ports : \n     -   3007:80 \n   depends_on : \n     -   users \n   links : \n     -   users   \u6ce8\u610f\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u7684\u662f args \uff0c\u800c\u4e0d\u662f\u73af\u5883\u53d8\u91cf\u4e86\u3002\u53e6\u5916\uff0c\u6211\u4eec\u7684\u8fd9\u4e2a client \u670d\u52a1\u9700\u8981\u5728 nginx \u670d\u52a1\u542f\u52a8\u4e4b\u524d\u542f\u52a8\uff0c\u6240\u4ee5\u6211\u4eec\u76f8\u5e94\u7684\u66f4\u65b0 docker-compose-prod.yml \uff1a  nginx : \n   container_name :   nginx \n   build :   ./services/nginx \n   restart :   always \n   ports : \n     -   80:80 \n   depends_on : \n     -   users \n     -   client   \u626b\u63cf\u4e0b\u9762\u7684\u4e8c\u7ef4\u7801(\u6216\u5fae\u4fe1\u641c\u7d22 iEverything )\u6dfb\u52a0\u6211\u5fae\u4fe1\u597d\u53cb(\u6ce8\u660e python )\uff0c\u7136\u540e\u53ef\u4ee5\u52a0\u5165\u5230\u6211\u4eec\u7684 python \u8ba8\u8bba\u7fa4\u91cc\u9762\u5171\u540c\u5b66\u4e60", 
            "title": "\u751f\u4ea7\u73af\u5883"
        }, 
        {
            "location": "/part3/introduction/", 
            "text": "TODO", 
            "title": "\u4ecb\u7ecd"
        }, 
        {
            "location": "/part3/introduction/#todo", 
            "text": "", 
            "title": "TODO"
        }, 
        {
            "location": "/about/", 
            "text": "Nothing in the world can take the place of Persistence.\n Talent will not; nothing is more common than unsuccessful men with talent. Genius will not; unrewarded genius is almost a proverb. Education will not; the world is full of educated derelicts. Persistence and Determination alone are omnipotent. The slogan \u201cPress On\u201d has solved and will always solve the problems of the human race.", 
            "title": "\u5173\u4e8e"
        }
    ]
}